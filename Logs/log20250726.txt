2025-07-26 00:13:28.856 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 00:13:31.084 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:13:31.262 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:13:31.394 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 00:13:31.431 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 00:13:31.496 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 00:13:31.975 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:13:32.350 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:13:32.489 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 00:13:33.688 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 00:13:33.737 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 00:13:33.993 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 00:13:34.533 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 00:13:34.542 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 00:13:34.563 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 00:13:34.567 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 00:13:34.630 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 00:13:34.647 +03:00 [INF] Hosting environment: Development
2025-07-26 00:13:34.658 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 00:13:34.661 +03:00 [INF] Server mrrobot:9684:8c04b00f successfully announced in 23.5051 ms
2025-07-26 00:13:34.695 +03:00 [INF] Server mrrobot:9684:8c04b00f is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 00:13:34.841 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 00:13:35.213 +03:00 [INF] Server mrrobot:9684:8c04b00f all the dispatchers started
2025-07-26 00:13:36.666 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:13:37.309 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 651.3705ms
2025-07-26 00:13:37.402 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:13:37.416 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:13:37.477 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:13:37.870 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 452.5946ms
2025-07-26 00:13:37.870 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 468.5023ms
2025-07-26 00:13:38.517 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 1040.3051ms
2025-07-26 00:13:39.550 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:13:39.869 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 318.8654ms
2025-07-26 00:17:09.839 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:17:10.009 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:17:10.104 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:17:10.178 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:17:10.207 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:17:10.533 +03:00 [INF] Executing GetCart
2025-07-26 00:17:10.540 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:17:10.544 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:17:10.554 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:17:10.557 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:17:10.845 +03:00 [INF] Executed DbCommand (112ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`DiscountPercent`, `t0`.`c`, `t0`.`Name0`, `t0`.`c0`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, `d`.`DiscountPercent`, CASE
        WHEN `d`.`Id` IS NOT NULL THEN `p`.`Price` - ((`p`.`Price` * `d`.`DiscountPercent`) / 100.0)
        ELSE `p`.`Price`
    END AS `c`, `d`.`Name` AS `Name0`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:17:10.879 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:17:10.889 +03:00 [INF] Executing CreateAsync for entity Cart
2025-07-26 00:17:10.957 +03:00 [INF] Cart added successfully (pending save)
2025-07-26 00:17:10.970 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:17:11.022 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 807.8662ms
2025-07-26 00:17:11.026 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:17:11.035 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Newtonsoft.Json.JsonSerializationException: Error getting value from 'IsEmpty' on 'E_Commerce.DtoModels.CartDtos.CartDto'.
 ---> System.ArgumentNullException: Value cannot be null. (Parameter 'source')
   at System.Linq.ThrowHelper.ThrowArgumentNullException(ExceptionArgument argument)
   at System.Linq.Enumerable.Any[TSource](IEnumerable`1 source)
   at E_Commerce.DtoModels.CartDtos.CartDto.get_IsEmpty() in D:\project_fashion\E-Commerce-API-main\DtoModels\CartDtos\CartDto.cs:line 14
   at lambda_method355(Closure, Object)
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   --- End of inner exception stack trace ---
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at SecurityStampMiddleware.Invoke(HttpContext context) in D:\project_fashion\E-Commerce-API-main\MiddleWares\SecurityStampMiddleware.cs:line 75
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context) in D:\project_fashion\E-Commerce-API-main\Middleware\UserAuthenticationMiddleware.cs:line 38
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-07-26 00:17:11.080 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 null text/plain; charset=utf-8 1241.4919ms
2025-07-26 00:18:59.229 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:18:59.259 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 30.7185ms
2025-07-26 00:18:59.558 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:18:59.564 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 6.1247ms
2025-07-26 00:18:59.573 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:18:59.579 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:18:59.589 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.6179ms
2025-07-26 00:18:59.593 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.2401ms
2025-07-26 00:19:00.528 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:19:00.756 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 227.4561ms
2025-07-26 00:19:19.650 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:19:19.663 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:19:19.726 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:19:19.754 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:19:19.761 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:19:19.777 +03:00 [INF] Executing GetCart
2025-07-26 00:19:19.781 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:19:19.792 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:19:19.794 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:19:19.796 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:19:19.848 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`DiscountPercent`, `t0`.`c`, `t0`.`Name0`, `t0`.`c0`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, `d`.`DiscountPercent`, CASE
        WHEN `d`.`Id` IS NOT NULL THEN `p`.`Price` - ((`p`.`Price` * `d`.`DiscountPercent`) / 100.0)
        ELSE `p`.`Price`
    END AS `c`, `d`.`Name` AS `Name0`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:19:19.858 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:19:19.863 +03:00 [INF] Executing CreateAsync for entity Cart
2025-07-26 00:19:19.867 +03:00 [INF] Cart added successfully (pending save)
2025-07-26 00:19:19.869 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:19:19.876 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 113.0071ms
2025-07-26 00:19:19.879 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:19:19.881 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Newtonsoft.Json.JsonSerializationException: Error getting value from 'IsEmpty' on 'E_Commerce.DtoModels.CartDtos.CartDto'.
 ---> System.ArgumentNullException: Value cannot be null. (Parameter 'source')
   at System.Linq.ThrowHelper.ThrowArgumentNullException(ExceptionArgument argument)
   at System.Linq.Enumerable.Any[TSource](IEnumerable`1 source)
   at E_Commerce.DtoModels.CartDtos.CartDto.get_IsEmpty()
   at lambda_method355(Closure, Object)
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   --- End of inner exception stack trace ---
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at SecurityStampMiddleware.Invoke(HttpContext context)
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-07-26 00:19:19.900 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 null text/plain; charset=utf-8 250.1194ms
2025-07-26 00:19:52.762 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 00:19:54.996 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:19:55.012 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:19:55.044 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 00:19:55.074 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 00:19:55.114 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 00:19:55.564 +03:00 [INF] Executed DbCommand (62ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:19:55.686 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:19:55.767 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 00:20:00.520 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 00:20:00.522 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 00:20:00.656 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 00:20:00.725 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 00:20:00.732 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 00:20:00.734 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 00:20:00.737 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 00:20:00.806 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 00:20:00.809 +03:00 [INF] Hosting environment: Development
2025-07-26 00:20:00.822 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 00:20:00.843 +03:00 [INF] Server mrrobot:2420:ce15e509 successfully announced in 16.4622 ms
2025-07-26 00:20:00.855 +03:00 [INF] Server mrrobot:2420:ce15e509 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 00:20:01.350 +03:00 [INF] Server mrrobot:2420:ce15e509 all the dispatchers started
2025-07-26 00:20:02.259 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:20:02.919 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 670.8192ms
2025-07-26 00:20:02.939 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:20:02.951 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:20:02.951 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:20:02.995 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 44.4179ms
2025-07-26 00:20:03.016 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 78.0557ms
2025-07-26 00:20:03.150 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 198.1017ms
2025-07-26 00:20:03.475 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:20:03.835 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 359.5467ms
2025-07-26 00:20:08.079 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:20:08.323 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:20:08.390 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:20:08.498 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:20:08.535 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:20:12.156 +03:00 [INF] Executing GetCart
2025-07-26 00:20:21.205 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:20:21.260 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:20:21.275 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:20:21.280 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:20:21.615 +03:00 [INF] Executed DbCommand (127ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`DiscountPercent`, `t0`.`c`, `t0`.`Name0`, `t0`.`c0`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, `d`.`DiscountPercent`, CASE
        WHEN `d`.`Id` IS NOT NULL THEN `p`.`Price` - ((`p`.`Price` * `d`.`DiscountPercent`) / 100.0)
        ELSE `p`.`Price`
    END AS `c`, `d`.`Name` AS `Name0`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:20:26.911 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:20:26.921 +03:00 [INF] Executing CreateAsync for entity Cart
2025-07-26 00:20:26.996 +03:00 [INF] Cart added successfully (pending save)
2025-07-26 00:20:29.027 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:20:58.950 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 50406.9451ms
2025-07-26 00:20:58.955 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:21:03.253 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Newtonsoft.Json.JsonSerializationException: Error getting value from 'IsEmpty' on 'E_Commerce.DtoModels.CartDtos.CartDto'.
 ---> System.ArgumentNullException: Value cannot be null. (Parameter 'source')
   at System.Linq.ThrowHelper.ThrowArgumentNullException(ExceptionArgument argument)
   at System.Linq.Enumerable.Any[TSource](IEnumerable`1 source)
   at E_Commerce.DtoModels.CartDtos.CartDto.get_IsEmpty() in D:\project_fashion\E-Commerce-API-main\DtoModels\CartDtos\CartDto.cs:line 14
   at lambda_method355(Closure, Object)
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   --- End of inner exception stack trace ---
   at Newtonsoft.Json.Serialization.ExpressionValueProvider.GetValue(Object target)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.CalculatePropertyValues(JsonWriter writer, Object value, JsonContainerContract contract, JsonProperty member, JsonProperty property, JsonContract& memberContract, Object& memberValue)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject(JsonWriter writer, Object value, JsonObjectContract contract, JsonProperty member, JsonContainerContract collectionContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue(JsonWriter writer, Object value, JsonContract valueContract, JsonProperty member, JsonContainerContract containerContract, JsonProperty containerProperty)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.SerializeInternal(JsonWriter jsonWriter, Object value, Type objectType)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at SecurityStampMiddleware.Invoke(HttpContext context) in D:\project_fashion\E-Commerce-API-main\MiddleWares\SecurityStampMiddleware.cs:line 75
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context) in D:\project_fashion\E-Commerce-API-main\Middleware\UserAuthenticationMiddleware.cs:line 38
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-07-26 00:21:03.350 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 null text/plain; charset=utf-8 55271.3935ms
2025-07-26 00:21:48.551 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:21:48.617 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 66.1634ms
2025-07-26 00:21:48.668 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:21:48.669 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:21:48.670 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:21:48.784 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 116.1943ms
2025-07-26 00:21:48.798 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 128.6876ms
2025-07-26 00:21:48.862 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 192.9147ms
2025-07-26 00:21:49.335 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:21:50.096 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 761.2129ms
2025-07-26 00:21:51.687 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:21:52.287 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:21:52.307 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:21:52.329 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:21:52.337 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:21:55.554 +03:00 [INF] Executing GetCart
2025-07-26 00:21:58.519 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:21:58.524 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:21:58.528 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:21:58.531 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:21:58.609 +03:00 [INF] Executed DbCommand (71ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`DiscountPercent`, `t0`.`c`, `t0`.`Name0`, `t0`.`c0`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, `d`.`DiscountPercent`, CASE
        WHEN `d`.`Id` IS NOT NULL THEN `p`.`Price` - ((`p`.`Price` * `d`.`DiscountPercent`) / 100.0)
        ELSE `p`.`Price`
    END AS `c`, `d`.`Name` AS `Name0`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:21:58.617 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:21:58.625 +03:00 [INF] Executing CreateAsync for entity Cart
2025-07-26 00:21:58.628 +03:00 [INF] Cart added successfully (pending save)
2025-07-26 00:21:58.630 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:21:58.640 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 6298.0375ms
2025-07-26 00:21:58.644 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:21:58.646 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 201 323 application/json; charset=utf-8 6959.4357ms
2025-07-26 00:25:00.993 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 00:32:20.980 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 00:32:22.729 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:32:22.744 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:32:22.783 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 00:32:22.803 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 00:32:22.839 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 00:32:23.209 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:32:23.278 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:32:23.301 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 00:32:24.100 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 00:32:24.102 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 00:32:24.205 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 00:32:24.241 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 00:32:24.242 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 00:32:24.244 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 00:32:24.245 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 00:32:24.281 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 00:32:24.294 +03:00 [INF] Hosting environment: Development
2025-07-26 00:32:24.300 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 00:32:24.380 +03:00 [INF] Server mrrobot:4100:7cf103e0 successfully announced in 77.6684 ms
2025-07-26 00:32:24.386 +03:00 [INF] Server mrrobot:4100:7cf103e0 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 00:32:24.395 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 00:32:24.487 +03:00 [INF] Server mrrobot:4100:7cf103e0 all the dispatchers started
2025-07-26 00:32:24.830 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:32:25.085 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 255.5959ms
2025-07-26 00:32:25.125 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:32:25.125 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:32:25.159 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:32:25.160 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 35.0744ms
2025-07-26 00:32:25.176 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 47.6674ms
2025-07-26 00:32:25.254 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 94.3157ms
2025-07-26 00:32:25.518 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:32:26.012 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 493.611ms
2025-07-26 00:32:33.657 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:32:33.843 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:32:33.899 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:32:33.968 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:32:33.999 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:32:34.314 +03:00 [INF] Executing GetCart
2025-07-26 00:32:34.325 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:32:34.330 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:32:34.339 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:32:34.356 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:32:34.399 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:32:34.410 +03:00 [INF] Executing CreateAsync for entity Cart
2025-07-26 00:32:34.497 +03:00 [INF] Cart added successfully (pending save)
2025-07-26 00:32:34.510 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:32:34.563 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 555.7683ms
2025-07-26 00:32:34.567 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:32:34.573 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 201 323 application/json; charset=utf-8 915.4589ms
2025-07-26 00:32:53.172 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:32:53.251 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:32:53.260 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:32:53.268 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:32:53.272 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:32:53.289 +03:00 [INF] Executing GetCart
2025-07-26 00:32:53.290 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:32:53.292 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:32:53.294 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:32:53.298 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:32:53.305 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:32:53.311 +03:00 [INF] Executing CreateAsync for entity Cart
2025-07-26 00:32:53.315 +03:00 [INF] Cart added successfully (pending save)
2025-07-26 00:32:53.317 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:32:53.320 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 43.1872ms
2025-07-26 00:32:53.322 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:32:53.324 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 201 323 application/json; charset=utf-8 151.9756ms
2025-07-26 00:33:20.029 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:33:20.053 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 23.7323ms
2025-07-26 00:33:20.567 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:33:20.568 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:33:20.570 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:33:20.572 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 4.4166ms
2025-07-26 00:33:20.582 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.1933ms
2025-07-26 00:33:20.586 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 17.6426ms
2025-07-26 00:33:20.878 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:33:21.380 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 502.2911ms
2025-07-26 00:33:26.406 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:33:26.440 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:33:26.446 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:33:26.454 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:33:26.462 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:33:26.483 +03:00 [INF] Executing GetCart
2025-07-26 00:33:26.493 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:26.494 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:26.496 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:26.499 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:33:26.506 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:33:26.510 +03:00 [INF] Executing CreateAsync for entity Cart
2025-07-26 00:33:26.512 +03:00 [INF] Cart added successfully (pending save)
2025-07-26 00:33:26.677 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Cart` (`CreatedAt`, `CustomerId`, `DeletedAt`, `ModifiedAt`, `UserId`)
VALUES (@p0, @p1, @p2, @p3, @p4);
SELECT `Id`
FROM `Cart`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 00:33:26.721 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:33:26.724 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 259.3814ms
2025-07-26 00:33:26.731 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:33:26.733 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 201 323 application/json; charset=utf-8 351.2799ms
2025-07-26 00:33:30.083 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:33:30.134 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:33:30.144 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:33:30.153 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:33:30.155 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:33:30.163 +03:00 [INF] Executing GetCart
2025-07-26 00:33:30.169 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:30.171 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:30.173 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:30.179 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:33:30.185 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:33:30.569 +03:00 [INF] Executed DbCommand (168ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`DiscountPercent`, `t0`.`c`, `t0`.`Name0`, `t0`.`c0`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, `d`.`DiscountPercent`, CASE
        WHEN `d`.`Id` IS NOT NULL THEN `p`.`Price` - ((`p`.`Price` * `d`.`DiscountPercent`) / 100.0)
        ELSE `p`.`Price`
    END AS `c`, `d`.`Name` AS `Name0`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:33:30.650 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:30.723 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 00:33:30.734 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:33:30.740 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 582.6616ms
2025-07-26 00:33:30.917 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:33:30.919 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 318 application/json; charset=utf-8 836.0144ms
2025-07-26 00:33:38.782 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:33:38.808 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:33:38.819 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:33:38.822 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:33:38.845 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:33:38.848 +03:00 [INF] Executing GetCart
2025-07-26 00:33:38.849 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:38.850 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:38.854 +03:00 [INF] Cache hit for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:38.861 +03:00 [INF] Cache hit for cart user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:33:38.863 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:33:38.865 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 18.4108ms
2025-07-26 00:33:38.867 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:33:38.869 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 316 application/json; charset=utf-8 88.4389ms
2025-07-26 00:34:50.533 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - null null
2025-07-26 00:34:50.538 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:34:50.551 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:34:50.559 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-26 00:34:50.583 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-26 00:34:50.654 +03:00 [INF] Getting cache for key: advsearch__________False_1_10_True_
2025-07-26 00:34:50.657 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10_True_
2025-07-26 00:34:50.659 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 00:34:50.726 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`))
    ELSE `t`.`Price`
END, `t`.`fitType`, `d`.`Id`, `t0`.`Id`, `t0`.`Url`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t`.`IsActive`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE `p`.`IsActive`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-07-26 00:34:50.854 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 00:34:50.864 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 276.5959ms
2025-07-26 00:34:50.867 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-26 00:34:50.868 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - 200 1082 application/json; charset=utf-8 335.1093ms
2025-07-26 00:34:54.718 +03:00 [INF] Setting cache for key: advsearch__________False_1_10_True_
2025-07-26 00:34:54.735 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10_True_ with tags: [product_search]
2025-07-26 00:35:38.677 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/6?isActive&includeDeleted - null null
2025-07-26 00:35:38.690 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:35:38.711 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:35:38.724 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductAdmin (E-Commerce)'
2025-07-26 00:35:38.736 +03:00 [INF] Route matched with {action = "GetProductAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProductAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-26 00:35:38.749 +03:00 [INF] Executing GetProductAdmin for ID: 6
2025-07-26 00:35:38.760 +03:00 [INF] Retrieving product by id: 6, isActive: , deletedOnly: 
2025-07-26 00:35:38.764 +03:00 [INF] Getting cache for key: product_detail:6:isActive=:deletedOnly=
2025-07-26 00:35:38.767 +03:00 [WRN] Cache miss for key: product_detail:6:isActive=:deletedOnly=
2025-07-26 00:35:38.770 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 00:35:38.807 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-26 00:35:38.845 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__8__locals1_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`IsActive`, `t`.`Price`, `t`.`c`, `t`.`fitType`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`IsActive`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`DeletedAt`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`IsActive`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - (`d`.`DiscountPercent` * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`fitType`, `p`.`SubCategoryId`, ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE `p`.`Id` = @__8__locals1_id_0
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`IsActive`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE `p0`.`DeletedAt` IS NULL AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-07-26 00:35:38.871 +03:00 [INF] Product found: Cargo style one (ID: 6)
2025-07-26 00:35:38.921 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:35:38.934 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductAdmin (E-Commerce) in 194.0641ms
2025-07-26 00:35:38.937 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductAdmin (E-Commerce)'
2025-07-26 00:35:38.938 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/6?isActive&includeDeleted - 200 1471 application/json; charset=utf-8 261.2674ms
2025-07-26 00:35:44.736 +03:00 [INF] Setting cache for key: product_detail:6:isActive=:deletedOnly=
2025-07-26 00:35:44.749 +03:00 [INF] Cache set successfully for key: product_detail:6:isActive=:deletedOnly= with tags: [productwithvariantdata]
2025-07-26 00:36:35.924 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 00:36:35.932 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:36:35.936 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:36:35.941 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 00:36:35.948 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:36:35.983 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 00:36:35.995 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 00:36:36.011 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:36:36.032 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE ((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL)
2025-07-26 00:36:36.044 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 00:36:36.051 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:36:36.133 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 00:36:36.148 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 00:36:36.181 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 00:36:36.185 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 00:36:36.191 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 00:36:36.225 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 00:36:36.275 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 00:36:36.301 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:36:36.314 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:36:36.316 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 00:36:36.334 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 00:36:36.348 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 397.0249ms
2025-07-26 00:36:36.350 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 00:36:36.352 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 427.4813ms
2025-07-26 00:36:56.865 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:36:56.872 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:36:56.877 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:36:56.903 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:36:56.905 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:36:56.908 +03:00 [INF] Executing GetCart
2025-07-26 00:36:56.909 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:36:56.911 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:36:56.913 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:36:56.918 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:36:56.921 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:36:56.969 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`DiscountPercent`, `t0`.`c`, `t0`.`Name0`, `t0`.`c0`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, `d`.`DiscountPercent`, CASE
        WHEN `d`.`Id` IS NOT NULL THEN `p`.`Price` - ((`p`.`Price` * `d`.`DiscountPercent`) / 100.0)
        ELSE `p`.`Price`
    END AS `c`, `d`.`Name` AS `Name0`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:36:56.992 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:36:57.009 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 00:36:57.012 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:36:57.022 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 114.6124ms
2025-07-26 00:36:57.024 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:36:57.026 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 940 application/json; charset=utf-8 160.9157ms
2025-07-26 00:45:54.655 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:45:54.758 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 103.6028ms
2025-07-26 00:45:54.824 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:45:54.829 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:45:54.834 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 9.9611ms
2025-07-26 00:45:54.835 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:45:54.855 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 20.2749ms
2025-07-26 00:45:54.859 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.4659ms
2025-07-26 00:45:58.243 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:45:58.443 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 200.1014ms
2025-07-26 00:47:22.751 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:47:23.446 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 695.9529ms
2025-07-26 00:47:24.364 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:47:24.384 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 19.7833ms
2025-07-26 00:47:24.895 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:47:24.910 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:47:24.969 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 59.1616ms
2025-07-26 00:47:25.001 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 106.1036ms
2025-07-26 00:47:25.262 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:47:25.449 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 187.1857ms
2025-07-26 00:48:41.392 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 00:48:43.427 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:48:43.440 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:48:43.462 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 00:48:43.483 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 00:48:43.540 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 00:48:43.938 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:48:44.009 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:48:44.034 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 00:48:44.783 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 00:48:44.784 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 00:48:44.876 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 00:48:44.916 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 00:48:44.918 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 00:48:44.919 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 00:48:44.921 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 00:48:44.936 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 00:48:44.954 +03:00 [INF] Hosting environment: Development
2025-07-26 00:48:45.004 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 00:48:45.018 +03:00 [INF] Server mrrobot:21416:6b7da510 successfully announced in 12.1131 ms
2025-07-26 00:48:45.024 +03:00 [INF] Server mrrobot:21416:6b7da510 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 00:48:45.088 +03:00 [INF] Server mrrobot:21416:6b7da510 all the dispatchers started
2025-07-26 00:48:45.395 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:48:45.561 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 165.2949ms
2025-07-26 00:48:45.668 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:48:45.668 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:48:45.670 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:48:45.679 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 11.3731ms
2025-07-26 00:48:45.689 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 18.5389ms
2025-07-26 00:48:45.708 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 40.0149ms
2025-07-26 00:48:46.071 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:48:46.312 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 240.9285ms
2025-07-26 00:49:20.032 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 00:49:20.166 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:49:20.225 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:49:20.294 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:49:20.322 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:49:20.705 +03:00 [INF] Executing ClearCart
2025-07-26 00:49:20.710 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:49:20.730 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:49:20.925 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 00:49:20.990 +03:00 [INF] Clearing cart: 1
2025-07-26 00:49:21.003 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE (`c`.`CartId` = @__cartId_0) AND `c`.`DeletedAt` IS NULL
2025-07-26 00:49:21.014 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 00:49:21.018 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 00:49:21.075 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 00:49:21.222 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p8='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (DbType = Int32), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `CartItems` SET `AddedAt` = @p0, `CartId` = @p1, `CreatedAt` = @p2, `DeletedAt` = @p3, `ModifiedAt` = @p4, `ProductId` = @p5, `ProductVariantId` = @p6, `Quantity` = @p7
WHERE `Id` = @p8;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 00:49:21.275 +03:00 [INF] Removing cache by tag: cart
2025-07-26 00:49:21.299 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 00:49:21.315 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 00:49:21.352 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 1022.857ms
2025-07-26 00:49:21.356 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:49:21.361 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 1329.0175ms
2025-07-26 00:49:27.618 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:49:27.630 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:49:27.645 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:49:27.662 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:49:27.677 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:49:27.699 +03:00 [INF] Executing GetCart
2025-07-26 00:49:27.711 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:49:27.714 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:49:27.725 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:49:27.743 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:49:27.748 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:49:28.029 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `c2`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:49:28.047 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:49:28.096 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 00:49:28.100 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:49:28.121 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 438.8653ms
2025-07-26 00:49:28.126 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:49:28.128 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 935 application/json; charset=utf-8 510.4519ms
2025-07-26 00:53:09.596 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:53:09.619 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 23.2211ms
2025-07-26 00:53:09.683 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:53:09.686 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:53:09.687 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 3.9348ms
2025-07-26 00:53:09.691 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:53:09.713 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 22.3957ms
2025-07-26 00:53:09.716 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 29.9742ms
2025-07-26 00:53:10.072 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:53:18.591 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 00:53:20.836 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:53:20.852 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:53:20.878 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 00:53:20.897 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 00:53:20.925 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 00:53:21.277 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:53:21.351 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:53:21.377 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 00:53:22.072 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 00:53:22.074 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 00:53:22.161 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 00:53:22.209 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 00:53:22.216 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 00:53:22.219 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 00:53:22.224 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 00:53:22.245 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 00:53:22.249 +03:00 [INF] Hosting environment: Development
2025-07-26 00:53:22.252 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 00:53:22.328 +03:00 [INF] Server mrrobot:16580:7281a87d successfully announced in 57.4817 ms
2025-07-26 00:53:22.332 +03:00 [INF] Server mrrobot:16580:7281a87d is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 00:53:22.355 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 00:53:22.372 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:53:22.535 +03:00 [INF] Server mrrobot:16580:7281a87d all the dispatchers started
2025-07-26 00:53:22.667 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 296.7333ms
2025-07-26 00:53:22.714 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:53:22.724 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:53:22.726 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 12.6793ms
2025-07-26 00:53:22.733 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:53:22.749 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 15.4674ms
2025-07-26 00:53:22.767 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.6144ms
2025-07-26 00:53:22.952 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:53:23.264 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 312.3092ms
2025-07-26 00:53:24.605 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 00:53:24.711 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:53:24.770 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:53:24.837 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:53:24.855 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:53:25.193 +03:00 [INF] Executing ClearCart
2025-07-26 00:53:25.198 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:53:25.222 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:53:25.386 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 00:53:25.420 +03:00 [INF] Clearing cart: 1
2025-07-26 00:53:25.434 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE (`c`.`CartId` = @__cartId_0) AND `c`.`DeletedAt` IS NULL
2025-07-26 00:53:25.440 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 00:53:25.445 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 00:53:25.508 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 00:53:25.641 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 00:53:25.692 +03:00 [INF] Removing cache by tag: cart
2025-07-26 00:53:25.717 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 00:53:25.736 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 00:53:25.769 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 907.7738ms
2025-07-26 00:53:25.772 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:53:25.790 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 1185.0552ms
2025-07-26 00:53:31.597 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:53:31.604 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:53:31.616 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:53:31.651 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:53:31.657 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:53:31.668 +03:00 [INF] Executing GetCart
2025-07-26 00:53:31.673 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:53:31.679 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:53:31.684 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:53:31.692 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:53:31.699 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:53:31.886 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `c2`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:53:31.930 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:53:31.978 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 00:53:31.983 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:53:32.005 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 343.151ms
2025-07-26 00:53:32.007 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:53:32.016 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 934 application/json; charset=utf-8 418.8356ms
2025-07-26 00:54:34.338 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:54:34.348 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:54:34.355 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:54:34.370 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:54:34.374 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:54:34.397 +03:00 [INF] Executing GetCart
2025-07-26 00:54:34.401 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:54:34.405 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:54:34.407 +03:00 [INF] Cache hit for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:54:34.418 +03:00 [INF] Cache hit for cart user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:54:34.421 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:54:34.425 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 47.1413ms
2025-07-26 00:54:34.430 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:54:34.439 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 932 application/json; charset=utf-8 101.0719ms
2025-07-26 00:54:39.718 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 00:54:39.823 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:54:39.827 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:54:39.838 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:54:39.840 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:54:39.852 +03:00 [INF] Executing ClearCart
2025-07-26 00:54:39.859 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:54:39.870 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:54:39.922 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 00:54:39.927 +03:00 [INF] Clearing cart: 1
2025-07-26 00:54:39.937 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE (`c`.`CartId` = @__cartId_0) AND `c`.`DeletedAt` IS NULL
2025-07-26 00:54:39.942 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 00:54:39.945 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 00:54:39.949 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 00:54:39.955 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 00:54:39.963 +03:00 [INF] Removing cache by tag: cart
2025-07-26 00:54:39.971 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 00:54:39.974 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 00:54:39.976 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 132.1854ms
2025-07-26 00:54:39.983 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:54:39.989 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 270.9331ms
2025-07-26 00:56:49.378 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:56:49.394 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 15.4211ms
2025-07-26 00:56:49.417 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:56:49.417 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:56:49.424 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 6.7803ms
2025-07-26 00:56:49.428 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:56:49.438 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.4729ms
2025-07-26 00:56:49.442 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.2096ms
2025-07-26 00:56:49.584 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:56:49.728 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 143.9887ms
2025-07-26 00:56:56.637 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 00:56:58.147 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:56:58.164 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 00:56:58.192 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 00:56:58.212 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 00:56:58.240 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 00:56:59.496 +03:00 [INF] Executed DbCommand (211ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:57:00.466 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 00:57:00.977 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 00:57:03.683 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 00:57:03.768 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 00:57:04.884 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 00:57:05.629 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 00:57:05.676 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 00:57:05.679 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 00:57:05.690 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 00:57:05.876 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 00:57:05.940 +03:00 [INF] Hosting environment: Development
2025-07-26 00:57:05.946 +03:00 [INF] Server mrrobot:6608:a00e4013 successfully announced in 60.1184 ms
2025-07-26 00:57:05.955 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 00:57:05.973 +03:00 [INF] Server mrrobot:6608:a00e4013 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 00:57:06.458 +03:00 [INF] Server mrrobot:6608:a00e4013 all the dispatchers started
2025-07-26 00:57:07.302 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 00:57:08.039 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 738.6967ms
2025-07-26 00:57:08.542 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 00:57:08.551 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 00:57:08.554 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 00:57:08.584 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 42.1607ms
2025-07-26 00:57:08.853 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 293.8579ms
2025-07-26 00:57:08.862 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 307.2474ms
2025-07-26 00:57:10.071 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 00:57:10.679 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 607.8109ms
2025-07-26 00:57:26.608 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 00:57:26.786 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:57:26.865 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:57:26.951 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:57:26.985 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:57:27.489 +03:00 [INF] Executing ClearCart
2025-07-26 00:57:27.499 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:27.530 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:27.737 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 00:57:27.786 +03:00 [INF] Clearing cart: 1
2025-07-26 00:57:27.801 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 00:57:27.870 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 00:57:27.877 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 00:57:27.892 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 00:57:27.978 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 00:57:28.209 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 00:57:28.286 +03:00 [INF] Removing cache by tag: cart
2025-07-26 00:57:28.298 +03:00 [WRN] No cache entries found for tag: cart
2025-07-26 00:57:28.317 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 00:57:28.364 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 1362.3991ms
2025-07-26 00:57:28.368 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 00:57:28.375 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 1766.5662ms
2025-07-26 00:57:32.864 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:57:32.891 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:57:32.911 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:57:32.952 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:57:32.974 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:57:33.001 +03:00 [INF] Executing GetCart
2025-07-26 00:57:33.007 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:33.012 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:33.023 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:33.034 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:57:33.041 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:57:33.221 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `c2`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:57:33.248 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:33.300 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 00:57:33.309 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:57:33.328 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 343.8441ms
2025-07-26 00:57:33.333 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:57:33.339 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 318 application/json; charset=utf-8 475.7853ms
2025-07-26 00:57:52.501 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 00:57:52.512 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:57:52.518 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:57:52.529 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 00:57:52.547 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:57:52.654 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 00:57:52.663 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 00:57:52.703 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 00:57:52.718 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE ((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL)
2025-07-26 00:57:52.735 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 00:57:52.742 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:52.792 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 00:57:52.807 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 00:57:52.817 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 00:57:52.820 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 00:57:52.822 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 00:57:52.830 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 00:57:52.875 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 00:57:52.906 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:52.917 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:52.919 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 00:57:52.924 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 00:57:52.929 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 373.9311ms
2025-07-26 00:57:52.931 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 00:57:52.935 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 433.6238ms
2025-07-26 00:57:57.356 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 00:57:57.361 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 00:57:57.367 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 00:57:57.372 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:57:57.374 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 00:57:57.380 +03:00 [INF] Executing GetCart
2025-07-26 00:57:57.383 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:57.384 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:57.387 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:57.391 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 00:57:57.397 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 00:57:57.458 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `c2`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 00:57:57.470 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 00:57:57.482 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 00:57:57.485 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 00:57:57.500 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 121.5573ms
2025-07-26 00:57:57.503 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 00:57:57.506 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 935 application/json; charset=utf-8 149.8268ms
2025-07-26 01:02:06.021 +03:00 [INF] 2 servers were removed due to timeout
2025-07-26 01:06:20.793 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:06:20.814 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 20.3987ms
2025-07-26 01:06:20.974 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:06:20.979 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 4.6374ms
2025-07-26 01:06:21.006 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:06:21.026 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.2092ms
2025-07-26 01:06:21.040 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:06:21.045 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 4.9613ms
2025-07-26 01:06:21.462 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:06:21.707 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 244.5107ms
2025-07-26 01:14:43.292 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:14:43.322 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 30.4167ms
2025-07-26 01:14:43.535 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:14:43.540 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 4.2629ms
2025-07-26 01:14:43.540 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:14:43.549 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:14:43.558 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.1013ms
2025-07-26 01:14:43.566 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.2521ms
2025-07-26 01:14:44.589 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:14:44.788 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 198.7772ms
2025-07-26 01:15:00.501 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 01:15:01.042 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:15:01.360 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:15:01.382 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:15:01.407 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:15:01.422 +03:00 [INF] Executing ClearCart
2025-07-26 01:15:01.425 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:15:01.442 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:15:01.565 +03:00 [INF] Executed DbCommand (114ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:15:01.581 +03:00 [INF] Clearing cart: 1
2025-07-26 01:15:01.588 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 01:15:01.597 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 01:15:01.598 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:15:01.600 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:15:01.605 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:15:01.624 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:15:01.640 +03:00 [INF] Removing cache by tag: cart
2025-07-26 01:15:01.660 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 01:15:01.664 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:15:01.672 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 258.2346ms
2025-07-26 01:15:01.676 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:15:01.679 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 1178.8467ms
2025-07-26 01:16:32.804 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 01:16:32.809 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:16:32.817 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:16:32.828 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:16:32.838 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:16:32.860 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 01:16:32.881 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:16:32.902 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 01:16:32.910 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 01:16:32.975 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 01:16:33.097 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 01:16:33.106 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:16:33.170 +03:00 [INF] Executed DbCommand (62ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:16:33.185 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 01:16:33.193 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 01:16:33.196 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:16:33.198 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:16:33.200 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:16:33.260 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:16:33.274 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:16:33.280 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:16:33.284 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:16:33.288 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:16:33.294 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 450.6715ms
2025-07-26 01:16:33.313 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:16:33.317 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 512.5886ms
2025-07-26 01:16:41.316 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:16:41.324 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:16:41.333 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:16:41.340 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:16:41.354 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:16:41.358 +03:00 [INF] Executing GetCart
2025-07-26 01:16:41.362 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:16:41.367 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:16:41.372 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:16:41.375 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:16:41.391 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:16:41.456 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `c2`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:16:41.465 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:16:41.498 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 01:16:41.503 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:16:41.508 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 151.0618ms
2025-07-26 01:16:41.551 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:16:41.554 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 935 application/json; charset=utf-8 237.1962ms
2025-07-26 01:24:39.641 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:24:39.958 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 317.8573ms
2025-07-26 01:24:43.946 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:24:43.985 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 39.0507ms
2025-07-26 01:24:44.005 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:24:44.011 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:24:44.032 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 21.2487ms
2025-07-26 01:24:44.037 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.131ms
2025-07-26 01:24:46.171 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:24:46.581 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 410.1672ms
2025-07-26 01:27:46.312 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:27:46.493 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 180.2181ms
2025-07-26 01:27:52.636 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:27:52.636 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:27:52.636 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:27:52.740 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 104.0379ms
2025-07-26 01:27:52.748 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 111.0047ms
2025-07-26 01:27:52.797 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 160.1513ms
2025-07-26 01:27:53.854 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:27:54.243 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 395.7017ms
2025-07-26 01:28:11.150 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 01:28:11.178 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:28:11.233 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:28:11.251 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:28:11.281 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:28:11.295 +03:00 [INF] Executing ClearCart
2025-07-26 01:28:11.296 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:28:11.304 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:28:11.425 +03:00 [INF] Executed DbCommand (113ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:28:11.467 +03:00 [INF] Clearing cart: 1
2025-07-26 01:28:11.476 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 01:28:11.485 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 01:28:11.487 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:28:11.489 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:28:11.494 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:28:11.507 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:28:11.529 +03:00 [INF] Removing cache by tag: cart
2025-07-26 01:28:11.596 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 01:28:11.609 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:28:11.620 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 332.6153ms
2025-07-26 01:28:11.664 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:28:11.699 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 548.199ms
2025-07-26 01:28:17.538 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 01:28:17.560 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:28:17.616 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:28:17.635 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:28:17.656 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:28:17.675 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 01:28:17.679 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:28:17.692 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 01:28:17.701 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 01:28:17.713 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 01:28:17.726 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 01:28:17.731 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:28:17.782 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:28:17.790 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 01:28:17.792 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 01:28:17.794 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:28:17.796 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:28:17.799 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:28:17.809 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:28:17.818 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:28:17.822 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:28:17.824 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:28:17.826 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:28:17.830 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 171.4963ms
2025-07-26 01:28:17.851 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:28:17.871 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 333.0393ms
2025-07-26 01:28:22.338 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/6?isActive&includeDeleted - null null
2025-07-26 01:28:22.770 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:28:22.824 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:28:22.993 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductAdmin (E-Commerce)'
2025-07-26 01:28:23.028 +03:00 [INF] Route matched with {action = "GetProductAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProductAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-26 01:28:23.201 +03:00 [INF] Executing GetProductAdmin for ID: 6
2025-07-26 01:28:23.232 +03:00 [INF] Retrieving product by id: 6, isActive: , deletedOnly: 
2025-07-26 01:28:23.236 +03:00 [INF] Getting cache for key: product_detail:6:isActive=:deletedOnly=
2025-07-26 01:28:23.240 +03:00 [WRN] Cache miss for key: product_detail:6:isActive=:deletedOnly=
2025-07-26 01:28:23.243 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 01:28:23.353 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-26 01:28:23.419 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__8__locals1_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`IsActive`, `t`.`Price`, `t`.`c`, `t`.`fitType`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`IsActive`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`DeletedAt`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`IsActive`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - (`d`.`DiscountPercent` * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`fitType`, `p`.`SubCategoryId`, ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE `p`.`Id` = @__8__locals1_id_0
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`IsActive`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE `p0`.`DeletedAt` IS NULL AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-07-26 01:28:23.468 +03:00 [INF] Product found: Cargo style one (ID: 6)
2025-07-26 01:28:23.772 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:28:23.798 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductAdmin (E-Commerce) in 759.7004ms
2025-07-26 01:28:23.801 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductAdmin (E-Commerce)'
2025-07-26 01:28:23.805 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/6?isActive&includeDeleted - 200 1471 application/json; charset=utf-8 1467.1875ms
2025-07-26 01:28:29.418 +03:00 [INF] Setting cache for key: product_detail:6:isActive=:deletedOnly=
2025-07-26 01:28:29.499 +03:00 [INF] Cache set successfully for key: product_detail:6:isActive=:deletedOnly= with tags: [productwithvariantdata]
2025-07-26 01:29:04.348 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:29:04.361 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 13.2406ms
2025-07-26 01:29:04.399 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:29:04.409 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 10.1828ms
2025-07-26 01:29:04.428 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:29:04.448 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.2888ms
2025-07-26 01:29:04.459 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:29:04.464 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 4.9408ms
2025-07-26 01:29:04.746 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:29:04.913 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 167.7234ms
2025-07-26 01:29:42.169 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:29:42.202 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 33.744ms
2025-07-26 01:29:42.361 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:29:42.366 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 4.553ms
2025-07-26 01:29:42.381 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:29:42.388 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:29:42.397 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.7512ms
2025-07-26 01:29:42.407 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.5788ms
2025-07-26 01:29:42.760 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:29:42.924 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 163.8305ms
2025-07-26 01:29:59.016 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:29:59.026 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 10.1207ms
2025-07-26 01:29:59.067 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:29:59.072 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:29:59.073 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 6.838ms
2025-07-26 01:29:59.086 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 14.2353ms
2025-07-26 01:29:59.095 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:29:59.106 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 11.4836ms
2025-07-26 01:29:59.322 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:29:59.493 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 170.6533ms
2025-07-26 01:30:15.873 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 01:30:15.880 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:30:15.885 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:30:15.892 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:30:15.900 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:30:15.906 +03:00 [INF] Executing ClearCart
2025-07-26 01:30:15.908 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:15.913 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:15.995 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:30:16.003 +03:00 [INF] Clearing cart: 1
2025-07-26 01:30:16.007 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 01:30:16.011 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 01:30:16.012 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:30:16.014 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:30:16.017 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:30:16.021 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:30:16.030 +03:00 [INF] Removing cache by tag: cart
2025-07-26 01:30:16.035 +03:00 [WRN] No cache entries found for tag: cart
2025-07-26 01:30:16.038 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:30:16.042 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 136.2316ms
2025-07-26 01:30:16.059 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:30:16.102 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 229.4586ms
2025-07-26 01:30:24.575 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 01:30:24.581 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:30:24.588 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:30:24.603 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:30:24.611 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:30:24.623 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 01:30:24.627 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:30:24.632 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 01:30:24.642 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 01:30:24.647 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 01:30:24.663 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 01:30:24.671 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:24.719 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:30:24.735 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 01:30:24.738 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 01:30:24.740 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:30:24.742 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:30:24.744 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:30:24.748 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:30:24.759 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:24.761 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:24.763 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:30:24.765 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:30:24.770 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 149.5904ms
2025-07-26 01:30:24.781 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:30:24.786 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 210.7861ms
2025-07-26 01:30:30.054 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:30:30.096 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:30:30.260 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:30:30.307 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:30:30.322 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:30:30.329 +03:00 [INF] Executing GetCart
2025-07-26 01:30:30.331 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:30.333 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:30.338 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:30:30.343 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:30:30.348 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:30:30.395 +03:00 [ERR] Error getting cart for user d1f25979-3a6d-4429-8380-c159dc573444: The LINQ expression 'DbSet<CartItem>()
    .Where(c2 => EF.Property<int?>(StructuralTypeShaperExpression: 
        E_Commerce.Models.Cart
        ValueBufferExpression: 
            ProjectionBindingExpression: EmptyProjectionMember
        IsNullable: False
    , "Id") != null && object.Equals(
        objA: (object)EF.Property<int?>(StructuralTypeShaperExpression: 
            E_Commerce.Models.Cart
            ValueBufferExpression: 
                ProjectionBindingExpression: EmptyProjectionMember
            IsNullable: False
        , "Id"), 
        objB: (object)EF.Property<int?>(c2, "CartId")))
    .Sum(c2 => c2.UnitPrice * (decimal)c2.Quantity)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
2025-07-26 01:30:30.474 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:30:30.484 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 155.0272ms
2025-07-26 01:30:30.489 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:30:30.494 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 240 application/json; charset=utf-8 439.7796ms
2025-07-26 01:30:41.866 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:30:41.874 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 8.0459ms
2025-07-26 01:30:41.934 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:30:41.940 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:30:41.942 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 8.3269ms
2025-07-26 01:30:41.960 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.2521ms
2025-07-26 01:30:41.969 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:30:41.981 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 11.3334ms
2025-07-26 01:30:42.249 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:30:42.365 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 115.8881ms
2025-07-26 01:31:06.757 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 01:31:08.611 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:31:08.627 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:31:08.657 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 01:31:08.689 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 01:31:08.732 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 01:31:09.112 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:31:09.186 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:31:09.212 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 01:31:10.018 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 01:31:10.022 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 01:31:10.118 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 01:31:10.143 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 01:31:10.146 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 01:31:10.148 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 01:31:10.151 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 01:31:10.174 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 01:31:10.176 +03:00 [INF] Hosting environment: Development
2025-07-26 01:31:10.177 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 01:31:10.210 +03:00 [INF] Server mrrobot:23664:0af8779c successfully announced in 16.2299 ms
2025-07-26 01:31:10.218 +03:00 [INF] Server mrrobot:23664:0af8779c is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 01:31:10.336 +03:00 [INF] Server mrrobot:23664:0af8779c all the dispatchers started
2025-07-26 01:31:11.138 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:31:11.378 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 241.4634ms
2025-07-26 01:31:11.403 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:31:11.403 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:31:11.450 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:31:11.483 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 79.8884ms
2025-07-26 01:31:11.489 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 86.2019ms
2025-07-26 01:31:11.570 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.571ms
2025-07-26 01:31:11.710 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:31:12.718 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 1007.2944ms
2025-07-26 01:31:18.505 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:31:18.761 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:31:19.009 +03:00 [INF] Executed DbCommand (154ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:31:19.486 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:31:19.627 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:31:20.094 +03:00 [INF] Executing GetCart
2025-07-26 01:31:20.102 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:31:20.110 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:31:20.128 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:31:20.144 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:31:20.157 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:31:20.456 +03:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`TotalPrice`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN LATERAL (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, (
        SELECT COALESCE(SUM(`c2`.`UnitPrice` * CAST(`c2`.`Quantity` AS decimal(65,30))), 0.0)
        FROM `CartItems` AS `c2`
        WHERE `t`.`Id` = `c2`.`CartId`) AS `TotalPrice`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
    WHERE `t`.`Id` = `c1`.`CartId`
) AS `t0` ON TRUE
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:31:20.517 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
MySqlConnector.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '(
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, (
        SELECT...' at line 11
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
MySqlConnector.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '(
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, (
        SELECT...' at line 11
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-07-26 01:31:20.547 +03:00 [ERR] Error getting cart for user d1f25979-3a6d-4429-8380-c159dc573444: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '(
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, (
        SELECT...' at line 11
2025-07-26 01:31:20.714 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:31:20.769 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 1119.2975ms
2025-07-26 01:31:20.775 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:31:20.784 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 240 application/json; charset=utf-8 2278.0944ms
2025-07-26 01:31:32.467 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:31:32.486 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 18.9829ms
2025-07-26 01:31:32.553 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:31:32.561 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:31:32.563 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:31:32.572 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 19.1768ms
2025-07-26 01:31:32.578 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 16.6242ms
2025-07-26 01:31:32.650 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 86.5814ms
2025-07-26 01:31:32.704 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:31:33.338 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 633.7366ms
2025-07-26 01:31:41.232 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:31:41.239 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:31:41.251 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:31:41.262 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:31:41.271 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:31:41.297 +03:00 [INF] Executing GetCart
2025-07-26 01:31:41.300 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:31:41.302 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:31:41.304 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:31:41.310 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:31:41.314 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:31:41.455 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:31:41.512 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:31:41.665 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 01:31:41.668 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:31:41.732 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 454.5155ms
2025-07-26 01:31:41.837 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:31:41.841 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 933 application/json; charset=utf-8 608.2687ms
2025-07-26 01:34:05.056 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:34:05.069 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 12.6512ms
2025-07-26 01:34:05.200 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:34:05.206 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 5.1156ms
2025-07-26 01:34:05.210 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:34:05.218 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:34:05.224 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 14.4111ms
2025-07-26 01:34:05.226 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.3359ms
2025-07-26 01:34:05.456 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:34:05.778 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 322.2955ms
2025-07-26 01:34:22.753 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 01:34:22.767 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:34:22.775 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:34:22.788 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:34:22.801 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:34:22.835 +03:00 [INF] Executing ClearCart
2025-07-26 01:34:22.845 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:34:22.873 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:34:22.922 +03:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:34:22.936 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
MySqlConnector.MySqlException (0x80004005): Unknown column 'c0.UnitPrice' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
MySqlConnector.MySqlException (0x80004005): Unknown column 'c0.UnitPrice' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-07-26 01:34:22.959 +03:00 [ERR] Error retrieving cart: Unknown column 'c0.UnitPrice' in 'field list'
2025-07-26 01:34:22.980 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:34:22.990 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 180.7101ms
2025-07-26 01:34:22.996 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:34:23.000 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 404 191 application/json; charset=utf-8 247.1748ms
2025-07-26 01:34:40.113 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 01:34:41.869 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:34:41.883 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:34:41.911 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 01:34:41.930 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 01:34:41.957 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 01:34:42.336 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:34:42.412 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:34:42.448 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 01:34:43.122 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 01:34:43.127 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 01:34:43.231 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 01:34:43.253 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 01:34:43.255 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 01:34:43.256 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 01:34:43.257 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 01:34:43.311 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 01:34:43.311 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:34:43.318 +03:00 [INF] Hosting environment: Development
2025-07-26 01:34:43.322 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 01:34:43.327 +03:00 [INF] Server mrrobot:3356:c074bc76 successfully announced in 11.8903 ms
2025-07-26 01:34:43.336 +03:00 [INF] Server mrrobot:3356:c074bc76 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 01:34:43.684 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 373.7257ms
2025-07-26 01:34:43.780 +03:00 [INF] Server mrrobot:3356:c074bc76 all the dispatchers started
2025-07-26 01:34:43.887 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:34:43.889 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:34:43.890 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:34:43.898 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 10.7345ms
2025-07-26 01:34:43.915 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 24.3135ms
2025-07-26 01:34:43.950 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 60.9626ms
2025-07-26 01:34:44.272 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:34:44.502 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 230.4913ms
2025-07-26 01:37:30.880 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:37:30.909 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 29.1396ms
2025-07-26 01:37:30.939 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:37:30.945 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:37:30.948 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 7.5026ms
2025-07-26 01:37:30.954 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:37:30.973 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 18.3835ms
2025-07-26 01:37:30.976 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.6176ms
2025-07-26 01:37:31.240 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:37:31.511 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 270.8326ms
2025-07-26 01:38:09.794 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 01:38:11.574 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:38:11.587 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:38:11.610 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 01:38:11.629 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 01:38:11.656 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 01:38:12.020 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:38:12.099 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:38:12.124 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 01:38:12.740 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 01:38:12.744 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 01:38:12.851 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:38:12.861 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 01:38:12.877 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 01:38:12.878 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 01:38:12.879 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 01:38:12.880 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 01:38:12.901 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 01:38:12.907 +03:00 [INF] Hosting environment: Development
2025-07-26 01:38:12.975 +03:00 [INF] Server mrrobot:16780:4e4d1cd8 successfully announced in 67.4457 ms
2025-07-26 01:38:12.978 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 01:38:12.996 +03:00 [INF] Server mrrobot:16780:4e4d1cd8 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 01:38:13.075 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 01:38:13.144 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 292.9773ms
2025-07-26 01:38:13.161 +03:00 [INF] Server mrrobot:16780:4e4d1cd8 all the dispatchers started
2025-07-26 01:38:13.342 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:38:13.348 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 5.5403ms
2025-07-26 01:38:13.361 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:38:13.365 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:38:13.383 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 18.5093ms
2025-07-26 01:38:13.414 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.3548ms
2025-07-26 01:38:13.662 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:38:13.893 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 231.7374ms
2025-07-26 01:38:35.617 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 01:38:35.875 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:38:36.260 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:38:36.339 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:38:36.375 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:38:37.012 +03:00 [INF] Executing ClearCart
2025-07-26 01:38:37.018 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:38:37.049 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:38:37.273 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:38:37.359 +03:00 [INF] Clearing cart: 1
2025-07-26 01:38:37.380 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 01:38:37.396 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 01:38:37.398 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:38:37.405 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:38:37.494 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:38:37.744 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:38:37.817 +03:00 [INF] Removing cache by tag: cart
2025-07-26 01:38:37.850 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 01:38:37.883 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:38:37.988 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 1589.7755ms
2025-07-26 01:38:38.033 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:38:38.040 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 2422.6899ms
2025-07-26 01:38:49.098 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 01:38:49.106 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:38:49.114 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:38:49.126 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:38:49.140 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:38:49.205 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 01:38:49.214 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:38:49.249 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 01:38:49.255 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 01:38:49.290 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 01:38:49.408 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 01:38:49.413 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:38:49.459 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:38:49.466 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 01:38:49.475 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 01:38:49.477 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:38:49.479 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:38:49.486 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:38:49.584 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:38:49.602 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:38:49.607 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:38:49.610 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:38:49.613 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:38:49.619 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 474.7211ms
2025-07-26 01:38:49.623 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:38:49.636 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 537.8188ms
2025-07-26 01:38:53.919 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive=false - null null
2025-07-26 01:38:53.937 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:38:53.945 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:38:53.954 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-26 01:38:53.968 +03:00 [INF] Route matched with {action = "SearchCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] SearchCollectionsAdmin(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-26 01:38:53.997 +03:00 [INF] Executing SearchCollectionsAdmin for term: c with pagination: page 1, size 10
2025-07-26 01:38:54.002 +03:00 [INF] Searching collections with term: c
2025-07-26 01:38:54.008 +03:00 [INF] Getting collection by name: c
2025-07-26 01:38:54.120 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__name_0_contains='?' (Size = 4000), @__IsActive_Value_1='?' (DbType = Boolean), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE (`c`.`Name` LIKE @__name_0_contains) AND (`c`.`IsActive` = @__IsActive_Value_1)
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-26 01:38:54.136 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:38:54.151 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce) in 177.5541ms
2025-07-26 01:38:54.154 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-26 01:38:54.157 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive=false - 200 142 application/json; charset=utf-8 237.8567ms
2025-07-26 01:39:01.277 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:39:01.289 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:39:01.294 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:39:01.303 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:39:01.311 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:39:01.348 +03:00 [INF] Executing GetCart
2025-07-26 01:39:01.354 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:39:01.361 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:39:01.374 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:39:01.384 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:39:01.395 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:39:01.548 +03:00 [INF] Executed DbCommand (62ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`, `t`.`c`, `t`.`c0`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COALESCE(SUM(`c0`.`Quantity`), 0)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, (
        SELECT COALESCE(SUM(CASE
            WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
            ELSE `p`.`Price`
        END * CAST(`c1`.`Quantity` AS decimal(65,30))), 0.0)
        FROM `CartItems` AS `c1`
        INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
        LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
        WHERE `c`.`Id` = `c1`.`CartId`) AS `c0`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c2`.`Id`, `c2`.`ProductId`, `c2`.`Quantity`, `c2`.`AddedAt`, `p0`.`Id` AS `Id0`, `p0`.`Name`, `p0`.`Price`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p0`.`Price` - ((`d0`.`DiscountPercent` / 100.0) * `p0`.`Price`))
        ELSE `p0`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN `d0`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN `d0`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p0`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p0`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `MainImageUrl`, `p0`.`IsActive`, `p1`.`Color`, `p1`.`Size`, `p1`.`Waist`, `p1`.`Length`, `p1`.`Quantity` AS `Quantity0`, `d0`.`Id` AS `Id1`, `p1`.`Id` AS `Id2`, `c2`.`CartId`
    FROM `CartItems` AS `c2`
    INNER JOIN `Products` AS `p0` ON `c2`.`ProductId` = `p0`.`Id`
    LEFT JOIN `Discount` AS `d0` ON `p0`.`DiscountId` = `d0`.`Id`
    LEFT JOIN `ProductVariants` AS `p1` ON `c2`.`ProductVariantId` = `p1`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:39:01.565 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:39:01.621 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 01:39:01.629 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:39:01.657 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 337.4611ms
2025-07-26 01:39:01.662 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:39:01.673 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 963 application/json; charset=utf-8 396.1113ms
2025-07-26 01:40:19.854 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:40:19.880 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 26.4269ms
2025-07-26 01:40:19.967 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:40:19.970 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:40:19.982 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 14.2042ms
2025-07-26 01:40:19.985 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:40:20.014 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.5253ms
2025-07-26 01:40:20.016 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 30.4188ms
2025-07-26 01:40:20.479 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:40:20.549 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Swashbuckle.AspNetCore.SwaggerGen.SwaggerGeneratorException: Failed to generate Operation for action - E_Commerce.Controllers.CartController.GetCart (E-Commerce). See inner exception
 ---> Swashbuckle.AspNetCore.SwaggerGen.SwaggerGeneratorException: Failed to generate schema for type - E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]. See inner exception
 ---> System.TypeLoadException: Could not load type 'E_Commerce.Services.ProductServices.ProductDiscountService' from assembly 'E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' due to value type mismatch.
   at System.Signature.GetSignature(Void* pCorSig, Int32 cCorSig, RuntimeFieldHandleInternal fieldHandle, IRuntimeMethodInfo methodHandle, RuntimeType declaringType)
   at System.Reflection.RuntimeMethodInfo.<get_Signature>g__LazyCreateSignature|25_0()
   at System.Reflection.RuntimePropertyInfo.GetIndexParametersSpan()
   at System.Attribute.GetIndexParameterTypes(PropertyInfo element)
   at System.Attribute.InternalGetCustomAttributes(PropertyInfo element, Type type, Boolean inherit)
   at System.Attribute.GetCustomAttributes(MemberInfo element, Type attributeType, Boolean inherit)
   at System.Reflection.CustomAttributeExtensions.GetCustomAttribute[T](MemberInfo element)
   at Swashbuckle.AspNetCore.SwaggerGen.JsonSerializerDataContractResolver.<GetDataPropertiesFor>b__6_1(PropertyInfo property)
   at System.Linq.Enumerable.ArrayWhereIterator`1.ToArray(ReadOnlySpan`1 source, Func`2 predicate)
   at System.Linq.Enumerable.ArrayWhereIterator`1.ToArray()
   at System.Linq.Enumerable.OrderedIterator`2.MoveNext()
   at Swashbuckle.AspNetCore.SwaggerGen.JsonSerializerDataContractResolver.GetDataPropertiesFor(Type objectType, Type& extensionDataType)
   at Swashbuckle.AspNetCore.SwaggerGen.JsonSerializerDataContractResolver.GetDataContractForType(Type type)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GetDataContractFor(Type modelType)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateSchemaForType(Type modelType, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateSchema(Type modelType, SchemaRepository schemaRepository, MemberInfo memberInfo, ParameterInfo parameterInfo, ApiParameterRouteInfo routeInfo)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.CreateArraySchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.<>c__DisplayClass12_0.<GenerateConcreteSchema>b__1()
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateConcreteSchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateSchemaForMember(Type modelType, SchemaRepository schemaRepository, MemberInfo memberInfo, DataProperty dataProperty)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.CreateObjectSchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.<>c__DisplayClass12_0.<GenerateConcreteSchema>b__3()
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateReferencedSchema(DataContract dataContract, SchemaRepository schemaRepository, Func`1 definitionFactory)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateConcreteSchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateSchemaForMember(Type modelType, SchemaRepository schemaRepository, MemberInfo memberInfo, DataProperty dataProperty)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.CreateObjectSchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.<>c__DisplayClass12_0.<GenerateConcreteSchema>b__3()
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateReferencedSchema(DataContract dataContract, SchemaRepository schemaRepository, Func`1 definitionFactory)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateConcreteSchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateSchemaForMember(Type modelType, SchemaRepository schemaRepository, MemberInfo memberInfo, DataProperty dataProperty)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.CreateObjectSchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.<>c__DisplayClass12_0.<GenerateConcreteSchema>b__3()
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateReferencedSchema(DataContract dataContract, SchemaRepository schemaRepository, Func`1 definitionFactory)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateConcreteSchema(DataContract dataContract, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateSchemaForType(Type modelType, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SchemaGenerator.GenerateSchema(Type modelType, SchemaRepository schemaRepository, MemberInfo memberInfo, ParameterInfo parameterInfo, ApiParameterRouteInfo routeInfo)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateSchema(Type type, SchemaRepository schemaRepository, PropertyInfo propertyInfo, ParameterInfo parameterInfo, ApiParameterRouteInfo routeInfo)
   --- End of inner exception stack trace ---
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateSchema(Type type, SchemaRepository schemaRepository, PropertyInfo propertyInfo, ParameterInfo parameterInfo, ApiParameterRouteInfo routeInfo)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.CreateResponseMediaType(Type modelType, SchemaRepository schemaRespository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.<>c__DisplayClass42_0.<GenerateResponse>b__2(String contentType)
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateResponse(ApiDescription apiDescription, SchemaRepository schemaRepository, String statusCode, ApiResponseType apiResponseType)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateResponses(ApiDescription apiDescription, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationAsync(ApiDescription apiDescription, SchemaRepository schemaRepository, Func`3 parametersGenerator, Func`3 bodyGenerator, Func`3 applyFilters)
   --- End of inner exception stack trace ---
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationAsync(ApiDescription apiDescription, SchemaRepository schemaRepository, Func`3 parametersGenerator, Func`3 bodyGenerator, Func`3 applyFilters)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationAsync(ApiDescription apiDescription, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationsAsync(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GeneratePathsAsync(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository, Func`3 operationsGenerator)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GeneratePathsAsync(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GetSwaggerAsync(String documentName, String host, String basePath)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-07-26 01:40:20.593 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 500 null text/plain; charset=utf-8 113.8107ms
2025-07-26 01:40:29.277 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:40:29.787 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:40:29.807 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:40:29.812 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:40:29.817 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:40:29.825 +03:00 [INF] Executing GetCart
2025-07-26 01:40:29.827 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:40:29.829 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:40:29.831 +03:00 [INF] Cache hit for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:40:29.839 +03:00 [ERR] Error getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
System.TypeLoadException: Could not load type 'E_Commerce.Services.ProductServices.ProductDiscountService' from assembly 'E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' due to value type mismatch.
   at System.Signature.GetSignature(Void* pCorSig, Int32 cCorSig, RuntimeFieldHandleInternal fieldHandle, IRuntimeMethodInfo methodHandle, RuntimeType declaringType)
   at System.Reflection.RuntimeMethodInfo.<get_Signature>g__LazyCreateSignature|25_0()
   at System.Reflection.RuntimePropertyInfo.GetIndexParametersSpan()
   at System.Reflection.RuntimePropertyInfo.GetIndexParameters()
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.AddMembersDeclaredBySuperType(JsonTypeInfo typeInfo, Type currentType, NullabilityInfoContext nullabilityCtx, Boolean constructorHasSetsRequiredMembersAttribute, PropertyHierarchyResolutionState& state)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.PopulateProperties(JsonTypeInfo typeInfo, NullabilityInfoContext nullabilityCtx)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.CreateTypeInfoCore(Type type, JsonConverter converter, JsonSerializerOptions options)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.GetTypeInfo(Type type, JsonSerializerOptions options)
   at System.Text.Json.JsonSerializerOptions.GetTypeInfoNoCaching(Type type)
   at System.Text.Json.JsonSerializerOptions.CachingContext.CreateCacheEntry(Type type, CachingContext context)
--- End of stack trace from previous location ---
   at System.Text.Json.JsonSerializerOptions.GetTypeInfoInternal(Type type, Boolean ensureConfigured, Nullable`1 ensureNotNull, Boolean resolveIfMutable, Boolean fallBackToNearestAncestorType)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo.Configure()
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo.<EnsureConfigured>g__ConfigureSynchronized|172_0()
   at System.Text.Json.JsonSerializerOptions.GetTypeInfoInternal(Type type, Boolean ensureConfigured, Nullable`1 ensureNotNull, Boolean resolveIfMutable, Boolean fallBackToNearestAncestorType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo.Configure()
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo.ConfigureProperties()
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo.Configure()
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo.<EnsureConfigured>g__ConfigureSynchronized|172_0()
   at System.Text.Json.JsonSerializer.GetTypeInfo(JsonSerializerOptions options, Type inputType)
   at System.Text.Json.JsonSerializer.GetTypeInfo[T](JsonSerializerOptions options)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at E_Commerce.Services.Cache.CacheManager.GetAsync[T](String key)
2025-07-26 01:40:29.864 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:40:29.869 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:40:30.030 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`, `t`.`c`, `t`.`c0`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COALESCE(SUM(`c0`.`Quantity`), 0)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, (
        SELECT COALESCE(SUM(CASE
            WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
            ELSE `p`.`Price`
        END * CAST(`c1`.`Quantity` AS decimal(65,30))), 0.0)
        FROM `CartItems` AS `c1`
        INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
        LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
        WHERE `c`.`Id` = `c1`.`CartId`) AS `c0`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c2`.`Id`, `c2`.`AddedAt`, `c2`.`CartId`, `c2`.`CreatedAt`, `c2`.`DeletedAt`, `c2`.`ModifiedAt`, `c2`.`ProductId`, `c2`.`ProductVariantId`, `c2`.`Quantity`, `p0`.`Id` AS `Id0`, `p0`.`Name`, `p0`.`Price`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p0`.`Price` - ((`d0`.`DiscountPercent` / 100.0) * `p0`.`Price`))
        ELSE `p0`.`Price`
    END AS `c`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN `d0`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN `d0`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p0`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p0`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `c2`, `p0`.`IsActive`, `p1`.`Color`, `p1`.`Size`, `p1`.`Waist`, `p1`.`Length`, `p1`.`Quantity` AS `Quantity0`, `d0`.`Id` AS `Id1`, `p1`.`Id` AS `Id2`
    FROM `CartItems` AS `c2`
    INNER JOIN `Products` AS `p0` ON `c2`.`ProductId` = `p0`.`Id`
    LEFT JOIN `Discount` AS `d0` ON `p0`.`DiscountId` = `d0`.`Id`
    LEFT JOIN `ProductVariants` AS `p1` ON `c2`.`ProductVariantId` = `p1`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:40:30.063 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice()
   at lambda_method1173(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1174(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice()
   at lambda_method1173(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1174(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-07-26 01:40:30.068 +03:00 [ERR] Error getting cart for user d1f25979-3a6d-4429-8380-c159dc573444: Object reference not set to an instance of an object.
2025-07-26 01:40:30.278 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:40:30.287 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 463.8105ms
2025-07-26 01:40:30.336 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:40:30.352 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 240 application/json; charset=utf-8 1075.0339ms
2025-07-26 01:42:24.214 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 01:42:25.847 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:42:25.865 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:42:25.899 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 01:42:25.919 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 01:42:25.956 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 01:42:26.300 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:42:26.377 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:42:26.407 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 01:42:27.034 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 01:42:27.045 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 01:42:27.157 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 01:42:27.276 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 01:42:27.279 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 01:42:27.284 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 01:42:27.285 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 01:42:27.303 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 01:42:27.317 +03:00 [INF] Hosting environment: Development
2025-07-26 01:42:27.322 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 01:42:27.323 +03:00 [INF] Server mrrobot:8288:7c9cf47f successfully announced in 13.9809 ms
2025-07-26 01:42:27.329 +03:00 [INF] Server mrrobot:8288:7c9cf47f is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 01:42:27.335 +03:00 [INF] 2 servers were removed due to timeout
2025-07-26 01:42:27.407 +03:00 [INF] Server mrrobot:8288:7c9cf47f all the dispatchers started
2025-07-26 01:42:27.512 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:42:27.679 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 167.329ms
2025-07-26 01:42:27.699 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:42:27.699 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:42:27.700 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:42:27.708 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 9.0627ms
2025-07-26 01:42:27.722 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 21.7819ms
2025-07-26 01:42:27.746 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 46.152ms
2025-07-26 01:42:27.920 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:42:28.115 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 195.3959ms
2025-07-26 01:43:48.917 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:43:49.087 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:43:49.165 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:43:49.249 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:43:49.275 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:43:49.746 +03:00 [INF] Executing GetCart
2025-07-26 01:43:49.756 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:43:49.762 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:43:49.777 +03:00 [INF] Cache hit for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:43:49.829 +03:00 [INF] Cache hit for cart user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:43:49.846 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:43:49.916 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 626.0875ms
2025-07-26 01:43:49.944 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:43:49.957 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 944 application/json; charset=utf-8 1039.1166ms
2025-07-26 01:43:56.269 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 01:43:56.282 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:43:56.294 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:43:56.309 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:43:56.319 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:43:56.343 +03:00 [INF] Executing ClearCart
2025-07-26 01:43:56.350 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:43:56.377 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:43:56.551 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:43:56.639 +03:00 [INF] Clearing cart: 1
2025-07-26 01:43:56.664 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 01:43:56.686 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 01:43:56.694 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:43:56.702 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:43:56.771 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:43:56.988 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:43:57.059 +03:00 [INF] Removing cache by tag: cart
2025-07-26 01:43:57.092 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 01:43:57.102 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:43:57.114 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 785.9565ms
2025-07-26 01:43:57.120 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:43:57.123 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 854.2263ms
2025-07-26 01:44:01.414 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 01:44:01.422 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:44:01.428 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:44:01.438 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:44:01.450 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:44:01.535 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 01:44:01.543 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:44:01.574 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 01:44:01.582 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 01:44:01.610 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 01:44:01.700 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 01:44:01.706 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:44:01.752 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:44:01.769 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 01:44:01.780 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 01:44:01.785 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:44:01.788 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:44:01.798 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:44:01.971 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:44:01.992 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:44:02.000 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:44:02.007 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:44:02.012 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:44:02.019 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 564.5103ms
2025-07-26 01:44:02.023 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:44:02.025 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 610.8543ms
2025-07-26 01:44:06.534 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:44:06.787 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:44:06.794 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:44:06.800 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:44:06.810 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:44:06.816 +03:00 [INF] Executing GetCart
2025-07-26 01:44:06.817 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:44:06.818 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:44:06.854 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:44:06.863 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:44:06.868 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:44:07.071 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`, `t`.`c`, `t`.`c0`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COALESCE(SUM(`c0`.`Quantity`), 0)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, (
        SELECT COALESCE(SUM(CASE
            WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
            ELSE `p`.`Price`
        END * CAST(`c1`.`Quantity` AS decimal(65,30))), 0.0)
        FROM `CartItems` AS `c1`
        INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
        LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
        WHERE `c`.`Id` = `c1`.`CartId`) AS `c0`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c2`.`Id`, `c2`.`AddedAt`, `c2`.`CartId`, `c2`.`CreatedAt`, `c2`.`DeletedAt`, `c2`.`ModifiedAt`, `c2`.`ProductId`, `c2`.`ProductVariantId`, `c2`.`Quantity`, `p0`.`Id` AS `Id0`, `p0`.`Name`, `p0`.`Price`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p0`.`Price` - ((`d0`.`DiscountPercent` / 100.0) * `p0`.`Price`))
        ELSE `p0`.`Price`
    END AS `c`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN `d0`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN ((`d0`.`Id` IS NOT NULL AND `d0`.`IsActive`) AND `d0`.`DeletedAt` IS NULL) AND (`d0`.`EndDate` > UTC_TIMESTAMP()) THEN `d0`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, COALESCE((
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p0`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1), (
        SELECT `i0`.`Url`
        FROM `Images` AS `i0`
        WHERE (`p0`.`Id` = `i0`.`ProductId`) AND `i0`.`IsMain`
        LIMIT 1)) AS `c2`, `p0`.`IsActive`, `p1`.`Color`, `p1`.`Size`, `p1`.`Waist`, `p1`.`Length`, `p1`.`Quantity` AS `Quantity0`, `d0`.`Id` AS `Id1`, `p1`.`Id` AS `Id2`
    FROM `CartItems` AS `c2`
    INNER JOIN `Products` AS `p0` ON `c2`.`ProductId` = `p0`.`Id`
    LEFT JOIN `Discount` AS `d0` ON `p0`.`DiscountId` = `d0`.`Id`
    LEFT JOIN `ProductVariants` AS `p1` ON `c2`.`ProductVariantId` = `p1`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:44:07.143 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice() in D:\project_fashion\E-Commerce-API-main\Models\CartItem.cs:line 28
   at lambda_method1133(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1134(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice() in D:\project_fashion\E-Commerce-API-main\Models\CartItem.cs:line 28
   at lambda_method1133(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1134(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-07-26 01:44:07.155 +03:00 [ERR] Error getting cart for user d1f25979-3a6d-4429-8380-c159dc573444: Object reference not set to an instance of an object.
2025-07-26 01:44:07.264 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:44:07.270 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 454.1382ms
2025-07-26 01:44:07.280 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:44:07.284 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 240 application/json; charset=utf-8 750.6357ms
2025-07-26 01:47:27.359 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 01:51:49.974 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 01:51:51.916 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:51:51.934 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:51:51.969 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 01:51:51.992 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 01:51:52.031 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 01:51:52.427 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:51:52.507 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:51:52.533 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 01:51:53.317 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 01:51:53.319 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 01:51:53.422 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 01:51:53.451 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 01:51:53.452 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 01:51:53.455 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 01:51:53.458 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 01:51:53.530 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 01:51:53.551 +03:00 [INF] Hosting environment: Development
2025-07-26 01:51:53.553 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 01:51:53.563 +03:00 [INF] Server mrrobot:19324:25d5f699 successfully announced in 15.2314 ms
2025-07-26 01:51:53.574 +03:00 [INF] Server mrrobot:19324:25d5f699 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 01:51:53.656 +03:00 [INF] Server mrrobot:19324:25d5f699 all the dispatchers started
2025-07-26 01:51:53.796 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:51:53.974 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 179.4787ms
2025-07-26 01:51:54.101 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:51:54.101 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:51:54.105 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:51:54.113 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 12.4036ms
2025-07-26 01:51:54.130 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 25.1374ms
2025-07-26 01:51:54.146 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 45.1638ms
2025-07-26 01:51:55.075 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:51:55.362 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 286.4913ms
2025-07-26 01:52:44.690 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 01:52:46.413 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:52:46.444 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:52:46.476 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 01:52:46.507 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 01:52:46.538 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 01:52:46.949 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:52:47.025 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:52:47.049 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 01:52:47.667 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 01:52:47.673 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 01:52:47.765 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 01:52:47.784 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 01:52:47.786 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 01:52:47.787 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 01:52:47.789 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 01:52:47.807 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 01:52:47.808 +03:00 [INF] Hosting environment: Development
2025-07-26 01:52:47.810 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 01:52:47.827 +03:00 [INF] Server mrrobot:1912:9cdce5b6 successfully announced in 14.1422 ms
2025-07-26 01:52:47.832 +03:00 [INF] Server mrrobot:1912:9cdce5b6 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 01:52:47.942 +03:00 [INF] Server mrrobot:1912:9cdce5b6 all the dispatchers started
2025-07-26 01:52:48.183 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:52:48.379 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 196.2574ms
2025-07-26 01:52:48.404 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:52:48.404 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:52:48.413 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:52:48.417 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 13.0469ms
2025-07-26 01:52:48.432 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 19.2861ms
2025-07-26 01:52:48.451 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.1494ms
2025-07-26 01:52:48.701 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:52:48.901 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 199.319ms
2025-07-26 01:53:02.413 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:53:02.569 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:53:02.652 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:53:02.736 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:53:02.762 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:53:03.595 +03:00 [INF] Executing GetCart
2025-07-26 01:53:03.806 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:53:03.813 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:53:03.885 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:53:04.306 +03:00 [INF] Executed DbCommand (250ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:53:04.313 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:53:04.693 +03:00 [INF] Executed DbCommand (160ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:53:04.719 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:53:04.796 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 01:53:04.814 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:53:04.873 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 2103.0084ms
2025-07-26 01:53:04.877 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:53:04.892 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 935 application/json; charset=utf-8 2478.4917ms
2025-07-26 01:54:12.071 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 01:54:14.072 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:54:14.087 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 01:54:14.111 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 01:54:14.137 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 01:54:14.166 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 01:54:14.622 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:54:14.701 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 01:54:14.724 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 01:54:16.659 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 01:54:16.663 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 01:54:16.753 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 01:54:16.778 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 01:54:16.780 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 01:54:16.784 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 01:54:16.785 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 01:54:16.810 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 01:54:16.813 +03:00 [INF] Hosting environment: Development
2025-07-26 01:54:16.815 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 01:54:16.838 +03:00 [INF] Server mrrobot:7184:136a13ab successfully announced in 22.1591 ms
2025-07-26 01:54:16.845 +03:00 [INF] Server mrrobot:7184:136a13ab is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 01:54:16.857 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 01:54:17.011 +03:00 [INF] Server mrrobot:7184:136a13ab all the dispatchers started
2025-07-26 01:54:17.146 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 01:54:17.336 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 189.114ms
2025-07-26 01:54:17.383 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 01:54:17.388 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 01:54:17.390 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 6.7899ms
2025-07-26 01:54:17.406 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 01:54:17.419 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 13.3028ms
2025-07-26 01:54:17.429 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 40.9091ms
2025-07-26 01:54:17.765 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 01:54:17.980 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 214.7832ms
2025-07-26 01:54:39.980 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:54:40.161 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:54:40.252 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:54:40.342 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:54:40.371 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:54:40.863 +03:00 [INF] Executing GetCart
2025-07-26 01:54:40.876 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:40.881 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:40.894 +03:00 [INF] Cache hit for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:40.958 +03:00 [INF] Cache hit for cart user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:40.977 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:54:41.050 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 662.7292ms
2025-07-26 01:54:41.053 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:54:41.064 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 933 application/json; charset=utf-8 1084.0099ms
2025-07-26 01:54:47.076 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 01:54:47.087 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:54:47.097 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:54:47.111 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:54:47.123 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:54:47.136 +03:00 [INF] Executing ClearCart
2025-07-26 01:54:47.144 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:47.177 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:47.376 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:54:47.459 +03:00 [INF] Clearing cart: 1
2025-07-26 01:54:47.481 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 01:54:47.502 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 01:54:47.509 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:54:47.517 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:54:47.588 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:54:47.806 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:54:47.879 +03:00 [INF] Removing cache by tag: cart
2025-07-26 01:54:47.900 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 01:54:47.910 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:54:47.919 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 789.8846ms
2025-07-26 01:54:47.921 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 01:54:47.924 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 847.5238ms
2025-07-26 01:54:51.776 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 01:54:51.852 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:54:51.884 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:54:52.502 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:54:52.707 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:54:54.632 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 01:54:54.707 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:54:54.830 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 01:54:54.843 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 01:54:55.073 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 01:54:55.972 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 01:54:56.419 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:56.700 +03:00 [INF] Executed DbCommand (83ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 01:54:56.937 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 01:54:56.949 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 01:54:56.950 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 01:54:56.957 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 01:54:56.965 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 01:54:57.174 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 01:54:57.195 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:57.342 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:54:57.379 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 01:54:57.396 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 01:54:57.413 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 4685.8847ms
2025-07-26 01:54:57.427 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 01:54:57.430 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 5656.6522ms
2025-07-26 01:55:03.330 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 01:55:03.336 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 01:55:03.341 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 01:55:03.350 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:55:03.358 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 01:55:03.364 +03:00 [INF] Executing GetCart
2025-07-26 01:55:03.366 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:55:03.368 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:55:03.371 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 01:55:03.382 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 01:55:03.387 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 01:55:03.594 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `c`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c2`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 01:55:03.665 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice() in D:\project_fashion\E-Commerce-API-main\Models\CartItem.cs:line 28
   at lambda_method1133(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1134(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice() in D:\project_fashion\E-Commerce-API-main\Models\CartItem.cs:line 28
   at lambda_method1133(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1134(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-07-26 01:55:03.679 +03:00 [ERR] Error getting cart for user d1f25979-3a6d-4429-8380-c159dc573444: Object reference not set to an instance of an object.
2025-07-26 01:55:03.836 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 01:55:03.845 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 482.5409ms
2025-07-26 01:55:03.860 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 01:55:03.867 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 240 application/json; charset=utf-8 537.2408ms
2025-07-26 01:59:16.936 +03:00 [INF] 2 servers were removed due to timeout
2025-07-26 13:17:29.698 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 13:17:33.459 +03:00 [INF] Executed DbCommand (71ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:17:33.474 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:17:33.555 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 13:17:33.581 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 13:17:33.661 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 13:17:34.207 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:17:34.323 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:17:34.396 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 13:17:35.734 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 13:17:35.736 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 13:17:35.905 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 13:17:36.063 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 13:17:36.125 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 13:17:36.146 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 13:17:36.162 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 13:17:36.251 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 13:17:36.263 +03:00 [INF] Hosting environment: Development
2025-07-26 13:17:36.274 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 13:17:36.294 +03:00 [INF] Server mrrobot:5972:cedf868b successfully announced in 39.2836 ms
2025-07-26 13:17:36.413 +03:00 [INF] Server mrrobot:5972:cedf868b is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 13:17:36.448 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 13:17:38.346 +03:00 [INF] Server mrrobot:5972:cedf868b all the dispatchers started
2025-07-26 13:17:38.464 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:17:38.920 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 476.1584ms
2025-07-26 13:17:39.009 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:17:39.009 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:17:39.163 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:17:39.218 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 208.9338ms
2025-07-26 13:17:39.233 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 224.9862ms
2025-07-26 13:17:39.450 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 287.5893ms
2025-07-26 13:17:39.630 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:17:40.026 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 395.2172ms
2025-07-26 13:17:41.544 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`ImageId`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Categories` AS `c`
WHERE `c`.`DeletedAt` IS NOT NULL
2025-07-26 13:17:45.600 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:17:45.980 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:17:46.158 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:17:46.282 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:17:46.356 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:17:46.913 +03:00 [INF] Executing GetCart
2025-07-26 13:17:46.918 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:17:46.923 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:17:46.933 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:17:46.953 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 13:17:46.959 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 13:17:47.343 +03:00 [INF] Executed DbCommand (89ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 13:17:47.369 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:17:47.458 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 13:17:47.476 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:17:47.565 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 1159.3764ms
2025-07-26 13:17:47.567 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:17:47.584 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 934 application/json; charset=utf-8 1984.4493ms
2025-07-26 13:18:48.886 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:18:48.901 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 15.121ms
2025-07-26 13:18:49.345 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:18:49.352 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.6994ms
2025-07-26 13:18:49.427 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:18:49.452 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 24.7465ms
2025-07-26 13:18:49.471 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:18:49.516 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.9431ms
2025-07-26 13:18:50.298 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:18:50.491 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 193.2252ms
2025-07-26 13:19:02.461 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 13:19:02.482 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:19:02.490 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:19:02.497 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:19:02.504 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:19:02.515 +03:00 [INF] Executing ClearCart
2025-07-26 13:19:02.519 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:02.552 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:02.683 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:19:02.763 +03:00 [INF] Clearing cart: 1
2025-07-26 13:19:02.775 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 13:19:02.792 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 13:19:02.795 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:19:02.809 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:19:02.879 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:19:03.084 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:19:03.157 +03:00 [INF] Removing cache by tag: cart
2025-07-26 13:19:03.177 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 13:19:03.183 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:19:03.190 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 680.9888ms
2025-07-26 13:19:03.193 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:19:03.195 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 733.911ms
2025-07-26 13:19:07.766 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 13:19:07.778 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:19:07.782 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:19:07.792 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:19:07.806 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:19:07.877 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 13:19:07.884 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:19:07.922 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 13:19:07.927 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 13:19:07.941 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 13:19:08.048 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 13:19:08.052 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:08.103 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:19:08.120 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 13:19:08.128 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 13:19:08.131 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:19:08.133 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:19:08.138 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:19:08.225 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:19:08.246 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:08.249 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:08.251 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:19:08.253 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:19:08.256 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 441.779ms
2025-07-26 13:19:08.262 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:19:08.272 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 505.966ms
2025-07-26 13:19:11.201 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:19:11.214 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:19:11.219 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:19:11.222 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:19:11.229 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:19:11.234 +03:00 [INF] Executing GetCart
2025-07-26 13:19:11.235 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:11.237 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:11.240 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:19:11.244 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 13:19:11.250 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 13:19:11.344 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`c`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductVariantId`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `c`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c0`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c1`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c2`, `p`.`IsActive`, `c1`.`CartId`, `c1`.`CreatedAt`, `c1`.`DeletedAt`, `c1`.`ModifiedAt`, `c1`.`ProductVariantId`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 13:19:32.600 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice()
   at lambda_method1156(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1157(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.NullReferenceException: Object reference not set to an instance of an object.
   at E_Commerce.Models.CartItem.get_UnitPrice()
   at lambda_method1156(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateCollection>g__ProcessCurrentElementRow|28_1[TCollection,TElement,TRelatedEntity](<>c__DisplayClass28_0`3&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateCollection[TCollection,TElement,TRelatedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper)
   at lambda_method1157(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-07-26 13:19:33.902 +03:00 [ERR] Error getting cart for user d1f25979-3a6d-4429-8380-c159dc573444: Object reference not set to an instance of an object.
2025-07-26 13:19:33.929 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:19:33.933 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 22700.2779ms
2025-07-26 13:19:33.936 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:19:33.939 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 500 240 application/json; charset=utf-8 22737.7385ms
2025-07-26 13:30:01.428 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:30:01.447 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 19.7461ms
2025-07-26 13:30:01.509 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:30:01.512 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:30:01.513 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 4.4061ms
2025-07-26 13:30:01.518 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:30:01.526 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.7625ms
2025-07-26 13:30:01.533 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 21.465ms
2025-07-26 13:30:02.152 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:30:02.338 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 186.0162ms
2025-07-26 13:34:39.758 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:34:39.778 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 20.2319ms
2025-07-26 13:34:39.809 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:34:39.820 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 11.0914ms
2025-07-26 13:34:39.841 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:34:39.847 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:34:39.857 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.4454ms
2025-07-26 13:34:39.915 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 73.2489ms
2025-07-26 13:34:40.111 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:34:40.243 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 131.6037ms
2025-07-26 13:35:58.848 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:35:58.954 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:35:58.978 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 13:35:58.994 +03:00 [INF] Applying migration '20250726103537_updatecartmodel'.
2025-07-26 13:35:59.300 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `CartItems` ADD `UnitPrice` decimal(18,2) NOT NULL DEFAULT 0.0;
2025-07-26 13:35:59.303 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `__EFMigrationsHistory` (`MigrationId`, `ProductVersion`)
VALUES ('20250726103537_updatecartmodel', '8.0.13');
2025-07-26 13:36:08.051 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 13:36:10.125 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:36:10.138 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:36:10.160 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 13:36:10.177 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 13:36:10.219 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 13:36:10.565 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:36:10.639 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:36:10.664 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 13:36:11.793 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 13:36:11.795 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 13:36:11.889 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 13:36:12.164 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 13:36:12.176 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 13:36:12.182 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 13:36:12.193 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 13:36:12.257 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 13:36:12.263 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:36:12.495 +03:00 [INF] Server mrrobot:4792:f554f3eb successfully announced in 164.0502 ms
2025-07-26 13:36:12.578 +03:00 [INF] Hosting environment: Development
2025-07-26 13:36:12.614 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 13:36:12.617 +03:00 [INF] Server mrrobot:4792:f554f3eb is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 13:36:12.840 +03:00 [INF] Server mrrobot:4792:f554f3eb all the dispatchers started
2025-07-26 13:36:12.992 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:36:12.993 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:36:12.998 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 733.3951ms
2025-07-26 13:36:13.013 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:36:13.044 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 51.7747ms
2025-07-26 13:36:13.046 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 53.1656ms
2025-07-26 13:36:13.114 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 101.6906ms
2025-07-26 13:36:13.181 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:36:13.503 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 322.0355ms
2025-07-26 13:38:40.905 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 13:38:42.697 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:38:42.747 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:38:42.820 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:38:42.843 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:38:43.170 +03:00 [INF] Executing ClearCart
2025-07-26 13:38:43.175 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:43.196 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:43.342 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:38:43.405 +03:00 [INF] Clearing cart: 1
2025-07-26 13:38:43.419 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 13:38:43.433 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 13:38:43.438 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:38:43.443 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:38:43.495 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:38:43.645 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:38:43.692 +03:00 [INF] Removing cache by tag: cart
2025-07-26 13:38:43.699 +03:00 [WRN] No cache entries found for tag: cart
2025-07-26 13:38:43.712 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:38:43.749 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 898.6739ms
2025-07-26 13:38:43.754 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:38:43.760 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 2855.0644ms
2025-07-26 13:38:46.665 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 13:38:46.672 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:38:46.678 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:38:46.688 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:38:46.697 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:38:46.747 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 13:38:46.754 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:38:46.782 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 13:38:46.788 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 13:38:46.819 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 13:38:46.911 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 13:38:46.915 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:46.950 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:38:46.960 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 13:38:46.968 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 13:38:46.969 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:38:46.973 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:38:46.979 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:38:47.051 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (DbType = Int32), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `UnitPrice`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:38:47.064 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:47.078 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:47.080 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:38:47.082 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:38:47.085 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 382.7576ms
2025-07-26 13:38:47.090 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:38:47.092 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 426.5355ms
2025-07-26 13:38:49.577 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:38:49.670 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:38:49.674 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:38:49.679 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:38:49.691 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:38:49.737 +03:00 [INF] Executing GetCart
2025-07-26 13:38:49.742 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:49.745 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:49.752 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:49.761 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 13:38:49.765 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 13:38:49.947 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 13:38:49.968 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:38:50.016 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 13:38:50.023 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:38:50.044 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 349.2256ms
2025-07-26 13:38:50.046 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:38:50.055 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 940 application/json; charset=utf-8 478.0761ms
2025-07-26 13:41:12.748 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 13:41:25.216 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:41:25.233 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 16.9991ms
2025-07-26 13:41:25.283 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:41:25.290 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 7.1348ms
2025-07-26 13:41:25.298 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:41:25.301 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:41:25.306 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.1514ms
2025-07-26 13:41:25.319 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.5463ms
2025-07-26 13:41:25.567 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:41:25.720 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 153.5837ms
2025-07-26 13:41:47.448 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 13:41:48.752 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:41:48.798 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:41:48.855 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 13:41:48.878 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 13:41:48.933 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 13:41:49.451 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:41:49.525 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:41:49.563 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 13:41:50.175 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 13:41:50.177 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 13:41:50.260 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 13:41:50.288 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 13:41:50.290 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 13:41:50.291 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 13:41:50.293 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 13:41:50.306 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 13:41:50.308 +03:00 [INF] Hosting environment: Development
2025-07-26 13:41:50.309 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 13:41:50.359 +03:00 [INF] Server mrrobot:2732:4b791488 successfully announced in 47.7101 ms
2025-07-26 13:41:50.363 +03:00 [INF] Server mrrobot:2732:4b791488 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 13:41:50.404 +03:00 [INF] Server mrrobot:2732:4b791488 all the dispatchers started
2025-07-26 13:41:50.652 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:41:50.801 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 148.9531ms
2025-07-26 13:41:50.823 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:41:50.828 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 5.4156ms
2025-07-26 13:41:50.839 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:41:50.839 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:41:50.860 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 20.2674ms
2025-07-26 13:41:50.885 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.9981ms
2025-07-26 13:41:50.990 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:41:51.172 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 182.1671ms
2025-07-26 13:42:25.562 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 13:42:25.654 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:42:25.703 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:42:25.756 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:42:25.774 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:42:26.071 +03:00 [INF] Executing ClearCart
2025-07-26 13:42:26.076 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:26.096 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:26.245 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:42:26.321 +03:00 [INF] Clearing cart: 1
2025-07-26 13:42:26.334 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 13:42:26.349 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 13:42:26.352 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:42:26.359 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:42:26.408 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:42:26.535 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:42:26.588 +03:00 [INF] Removing cache by tag: cart
2025-07-26 13:42:26.609 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 13:42:26.626 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:42:26.659 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 875.5297ms
2025-07-26 13:42:26.669 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:42:26.676 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 1113.4036ms
2025-07-26 13:42:30.156 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 13:42:30.164 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:42:30.173 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:42:30.182 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:42:30.195 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:42:30.244 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 13:42:30.251 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:42:30.284 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 13:42:30.291 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 13:42:30.320 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 13:42:30.427 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 13:42:30.433 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:30.486 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:42:30.494 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 13:42:30.505 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 13:42:30.507 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:42:30.509 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:42:30.514 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:42:30.608 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (DbType = Int32), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `UnitPrice`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:42:30.621 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:30.624 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:30.625 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:42:30.627 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:42:30.631 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 430.2055ms
2025-07-26 13:42:30.688 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:42:30.691 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 534.3053ms
2025-07-26 13:42:34.159 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:42:34.245 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:42:34.257 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:42:34.262 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:42:34.271 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:42:34.294 +03:00 [INF] Executing GetCart
2025-07-26 13:42:34.299 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:34.304 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:34.308 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:34.315 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 13:42:34.323 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 13:42:34.512 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 13:42:34.526 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:42:34.572 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 13:42:34.576 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:42:34.596 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 321.7418ms
2025-07-26 13:42:34.605 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:42:34.608 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 935 application/json; charset=utf-8 454.2726ms
2025-07-26 13:44:11.755 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:44:11.774 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 19.0392ms
2025-07-26 13:44:11.809 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:44:11.822 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 13.822ms
2025-07-26 13:44:11.841 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:44:11.871 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 29.3174ms
2025-07-26 13:44:11.882 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:44:11.891 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.4794ms
2025-07-26 13:44:12.405 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:44:12.575 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 170.526ms
2025-07-26 13:45:07.596 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Discount - null null
2025-07-26 13:45:07.601 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:45:07.607 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:45:07.612 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.GetAllAsync (E-Commerce)'
2025-07-26 13:45:07.626 +03:00 [INF] Route matched with {action = "GetAllAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.DiscoutDtos.DiscountDto]]]] GetAllAsync() on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:45:07.633 +03:00 [INF] Executing GetAllAsync
2025-07-26 13:45:07.640 +03:00 [INF] Execute GetAll for entity Discount
2025-07-26 13:45:07.650 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`Name`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`StartDate`, `d`.`EndDate`, `d`.`DeletedAt`, `d`.`IsActive`, `d`.`CreatedAt`, `d`.`ModifiedAt`
FROM `Discount` AS `d`
WHERE `d`.`DeletedAt` IS NULL
2025-07-26 13:45:07.658 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.DiscoutDtos.DiscountDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:45:07.666 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.GetAllAsync (E-Commerce) in 37.4731ms
2025-07-26 13:45:07.675 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.GetAllAsync (E-Commerce)'
2025-07-26 13:45:07.677 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Discount - 200 686 application/json; charset=utf-8 81.2536ms
2025-07-26 13:45:38.423 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Discount/1 - null null
2025-07-26 13:45:38.440 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:45:38.444 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:45:38.457 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:45:38.473 +03:00 [INF] Route matched with {action = "DeleteAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeleteAsync(Int32) on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:45:38.479 +03:00 [INF] Executing DeleteAsync for ID: 1
2025-07-26 13:45:38.488 +03:00 [INF] Deleting discount: 1
2025-07-26 13:45:38.491 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 1
2025-07-26 13:45:38.499 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:45:38.515 +03:00 [INF] Execute SoftDeleteAsync for entity Discount with ID: 1
2025-07-26 13:45:38.523 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE (`d`.`Id` = @__id_0) AND `d`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:45:38.527 +03:00 [INF] Discount with ID: 1 soft deleted.
2025-07-26 13:45:38.529 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:45:38.530 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:45:38.532 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:45:38.543 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 50), @p4='?' (DbType = Decimal), @p5='?' (DbType = DateTime), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?' (Size = 20), @p9='?' (DbType = DateTime), @p11='?' (Size = 255), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Discount` SET `CategoryId` = @p0, `CreatedAt` = @p1, `DeletedAt` = @p2, `Description` = @p3, `DiscountPercent` = @p4, `EndDate` = @p5, `IsActive` = @p6, `ModifiedAt` = @p7, `Name` = @p8, `StartDate` = @p9
WHERE `Id` = @p10;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:45:38.558 +03:00 [ERR] Error in DeleteDiscountAsync for id: 1
System.InvalidOperationException: Expression object should be not null.
   at Hangfire.Common.Job.FromExpression(LambdaExpression methodCall, Type explicitType, String queue) in C:\projects\hangfire-525\src\Hangfire.Core\Common\Job.cs:line 444
   at Hangfire.Common.Job.FromExpression(Expression`1 methodCall, String queue) in C:\projects\hangfire-525\src\Hangfire.Core\Common\Job.cs:line 357
   at Hangfire.Common.Job.FromExpression(Expression`1 methodCall) in C:\projects\hangfire-525\src\Hangfire.Core\Common\Job.cs:line 352
   at Hangfire.BackgroundJobClientExtensions.Create(IBackgroundJobClient client, Expression`1 methodCall, IState state) in C:\projects\hangfire-525\src\Hangfire.Core\BackgroundJobClientExtensions.cs:line 541
   at Hangfire.BackgroundJobClientExtensions.Enqueue(IBackgroundJobClient client, Expression`1 methodCall) in C:\projects\hangfire-525\src\Hangfire.Core\BackgroundJobClientExtensions.cs:line 86
   at Hangfire.BackgroundJob.Enqueue(Expression`1 methodCall) in C:\projects\hangfire-525\src\Hangfire.Core\BackgroundJob.cs:line 124
   at E_Commerce.Services.Discount.DiscountService.RemoveProductCaches()
   at E_Commerce.Services.Discount.DiscountService.DeleteDiscountAsync(Int32 id, String userId)
2025-07-26 13:45:38.662 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:45:38.665 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce) in 189.0283ms
2025-07-26 13:45:38.668 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:45:38.673 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Discount/1 - 500 209 application/json; charset=utf-8 250.4948ms
2025-07-26 13:46:50.425 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 13:46:57.732 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:46:57.750 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 17.7697ms
2025-07-26 13:46:58.053 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:46:58.061 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 7.6192ms
2025-07-26 13:46:58.068 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:46:58.084 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 15.783ms
2025-07-26 13:46:58.101 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:46:58.118 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 17.0263ms
2025-07-26 13:46:58.668 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:46:58.846 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 177.6641ms
2025-07-26 13:47:37.715 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 13:47:39.079 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:47:39.093 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 13:47:39.117 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 13:47:39.135 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 13:47:39.161 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 13:47:39.921 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:47:39.992 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 13:47:40.018 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 13:47:40.656 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 13:47:40.660 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 13:47:40.747 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 13:47:40.798 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 13:47:40.799 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 13:47:40.801 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 13:47:40.802 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 13:47:40.876 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 13:47:40.900 +03:00 [INF] Server mrrobot:18444:dde62a7d successfully announced in 23.2931 ms
2025-07-26 13:47:41.026 +03:00 [INF] Hosting environment: Development
2025-07-26 13:47:41.032 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 13:47:41.033 +03:00 [INF] Server mrrobot:18444:dde62a7d is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 13:47:41.104 +03:00 [INF] Server mrrobot:18444:dde62a7d all the dispatchers started
2025-07-26 13:47:41.233 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:47:41.387 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 153.9071ms
2025-07-26 13:47:41.412 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:47:41.412 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:47:41.420 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 8.1843ms
2025-07-26 13:47:41.432 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:47:41.447 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 14.7046ms
2025-07-26 13:47:41.454 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 41.8917ms
2025-07-26 13:47:41.617 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:47:41.798 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 181.0927ms
2025-07-26 13:48:08.781 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Discount/1 - null null
2025-07-26 13:48:08.881 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:48:08.944 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:48:09.015 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:48:09.043 +03:00 [INF] Route matched with {action = "DeleteAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeleteAsync(Int32) on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:48:09.150 +03:00 [INF] Executing DeleteAsync for ID: 1
2025-07-26 13:48:09.155 +03:00 [INF] Deleting discount: 1
2025-07-26 13:48:09.160 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 1
2025-07-26 13:48:09.175 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:48:09.243 +03:00 [INF] Execute SoftDeleteAsync for entity Discount with ID: 1
2025-07-26 13:48:09.253 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE (`d`.`Id` = @__id_0) AND `d`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:48:09.258 +03:00 [WRN] Discount with ID: 1 not found or already deleted.
2025-07-26 13:48:09.288 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:48:09.322 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce) in 271.1231ms
2025-07-26 13:48:09.329 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:48:09.338 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Discount/1 - 400 213 application/json; charset=utf-8 557.03ms
2025-07-26 13:48:24.494 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Discount - null null
2025-07-26 13:48:24.505 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:48:24.538 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:48:24.549 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.GetAllAsync (E-Commerce)'
2025-07-26 13:48:24.556 +03:00 [INF] Route matched with {action = "GetAllAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.DiscoutDtos.DiscountDto]]]] GetAllAsync() on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:48:24.566 +03:00 [INF] Executing GetAllAsync
2025-07-26 13:48:24.570 +03:00 [INF] Execute GetAll for entity Discount
2025-07-26 13:48:24.603 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`Name`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`StartDate`, `d`.`EndDate`, `d`.`DeletedAt`, `d`.`IsActive`, `d`.`CreatedAt`, `d`.`ModifiedAt`
FROM `Discount` AS `d`
WHERE `d`.`DeletedAt` IS NULL
2025-07-26 13:48:24.611 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.DiscoutDtos.DiscountDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:48:24.628 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.GetAllAsync (E-Commerce) in 69.5485ms
2025-07-26 13:48:24.632 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.GetAllAsync (E-Commerce)'
2025-07-26 13:48:24.634 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Discount - 200 399 application/json; charset=utf-8 140.1943ms
2025-07-26 13:48:36.743 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - null null
2025-07-26 13:48:36.753 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:48:36.761 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:48:36.767 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:48:36.769 +03:00 [INF] Route matched with {action = "DeleteAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeleteAsync(Int32) on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:48:36.788 +03:00 [INF] Executing DeleteAsync for ID: 2
2025-07-26 13:48:36.790 +03:00 [INF] Deleting discount: 2
2025-07-26 13:48:36.796 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 2
2025-07-26 13:48:36.799 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:48:36.814 +03:00 [INF] Execute SoftDeleteAsync for entity Discount with ID: 2
2025-07-26 13:48:36.817 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE (`d`.`Id` = @__id_0) AND `d`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:48:36.832 +03:00 [INF] Discount with ID: 2 soft deleted.
2025-07-26 13:48:36.834 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:48:36.838 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:48:36.899 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:48:37.031 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 50), @p4='?' (DbType = Decimal), @p5='?' (DbType = DateTime), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?' (Size = 20), @p9='?' (DbType = DateTime), @p11='?' (Size = 255), @p12='?' (DbType = DateTime), @p13='?' (DbType = DateTime), @p14='?' (Size = 4000), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime), @p17='?' (DbType = Int32), @p18='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Discount` SET `CategoryId` = @p0, `CreatedAt` = @p1, `DeletedAt` = @p2, `Description` = @p3, `DiscountPercent` = @p4, `EndDate` = @p5, `IsActive` = @p6, `ModifiedAt` = @p7, `Name` = @p8, `StartDate` = @p9
WHERE `Id` = @p10;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:48:37.137 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:48:37.140 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce) in 367.8826ms
2025-07-26 13:48:37.144 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:48:37.146 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - 200 119 application/json; charset=utf-8 402.2366ms
2025-07-26 13:48:41.206 +03:00 [INF] Removing cache by tags: [product_search, categorywithdata, productwithvariantdata]
2025-07-26 13:48:41.230 +03:00 [INF] Removed 3 cache entries for tags: [product_search, categorywithdata, productwithvariantdata]
2025-07-26 13:49:30.016 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Discount - application/json 174
2025-07-26 13:49:30.022 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:49:30.029 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:49:30.036 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.CreateAsync (E-Commerce)'
2025-07-26 13:49:30.054 +03:00 [INF] Route matched with {action = "CreateAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.DiscoutDtos.DiscountDto]]] CreateAsync(E_Commerce.DtoModels.DiscoutDtos.CreateDiscountDto) on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:49:30.096 +03:00 [INF] Executing CreateAsync
2025-07-26 13:49:30.101 +03:00 [INF] Creating new discount: string
2025-07-26 13:49:30.102 +03:00 [INF] Execute GetAll for entity Discount
2025-07-26 13:49:30.109 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__dto_Name_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE (`d`.`Name` = @__dto_Name_0) AND `d`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:49:30.120 +03:00 [INF] Executing CreateAsync for entity Discount
2025-07-26 13:49:30.124 +03:00 [INF] Discount added successfully (pending save)
2025-07-26 13:49:30.130 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:49:30.132 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:49:30.134 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:49:30.148 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 50), @p4='?' (DbType = Decimal), @p5='?' (DbType = DateTime), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?' (Size = 20), @p9='?' (DbType = DateTime), @p10='?' (Size = 255), @p11='?' (DbType = DateTime), @p12='?' (DbType = DateTime), @p13='?' (Size = 4000), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime), @p16='?' (DbType = Int32), @p17='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `Discount` (`CategoryId`, `CreatedAt`, `DeletedAt`, `Description`, `DiscountPercent`, `EndDate`, `IsActive`, `ModifiedAt`, `Name`, `StartDate`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `Discount`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:49:30.202 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.DiscoutDtos.DiscountDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:49:30.227 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.CreateAsync (E-Commerce) in 168.6786ms
2025-07-26 13:49:30.236 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.CreateAsync (E-Commerce)'
2025-07-26 13:49:30.238 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Discount - 201 395 application/json; charset=utf-8 222.0957ms
2025-07-26 13:49:41.328 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 3
2025-07-26 13:49:41.332 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:49:41.339 +03:00 [INF] Discount with ID 3 is now valid. Activating it.
2025-07-26 13:49:41.341 +03:00 [INF] Execute Update for entity Discount
2025-07-26 13:49:41.344 +03:00 [INF] Discount marked for update (pending save)
2025-07-26 13:49:41.375 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 50), @p4='?' (DbType = Decimal), @p5='?' (DbType = DateTime), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?' (Size = 20), @p9='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Discount` SET `CategoryId` = @p0, `CreatedAt` = @p1, `DeletedAt` = @p2, `Description` = @p3, `DiscountPercent` = @p4, `EndDate` = @p5, `IsActive` = @p6, `ModifiedAt` = @p7, `Name` = @p8, `StartDate` = @p9
WHERE `Id` = @p10;
SELECT ROW_COUNT();
2025-07-26 13:49:41.396 +03:00 [INF] Removing cache by tags: [product_search, categorywithdata, productwithvariantdata]
2025-07-26 13:49:41.401 +03:00 [WRN] No cache entries found for tags: [product_search, categorywithdata, productwithvariantdata]
2025-07-26 13:49:50.465 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Discount/active?id=3 - null null
2025-07-26 13:49:50.471 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:49:50.475 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:49:50.479 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.GetActiveAsync (E-Commerce)'
2025-07-26 13:49:50.485 +03:00 [INF] Route matched with {action = "GetActiveAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.DiscoutDtos.DiscountDto]]]] GetActiveAsync() on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:49:50.489 +03:00 [INF] Executing GetActiveAsync
2025-07-26 13:49:50.493 +03:00 [INF] Execute GetAll for entity Discount
2025-07-26 13:49:50.502 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`Name`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`StartDate`, `d`.`EndDate`, `d`.`IsActive`, `d`.`CreatedAt`
FROM `Discount` AS `d`
WHERE ((`d`.`DeletedAt` IS NULL AND `d`.`IsActive`) AND (`d`.`StartDate` <= @__now_0)) AND (`d`.`EndDate` >= @__now_0)
2025-07-26 13:49:50.506 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.DiscoutDtos.DiscountDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:49:50.509 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.GetActiveAsync (E-Commerce) in 21.2478ms
2025-07-26 13:49:50.520 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.GetActiveAsync (E-Commerce)'
2025-07-26 13:49:50.525 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Discount/active?id=3 - 200 403 application/json; charset=utf-8 58.0909ms
2025-07-26 13:50:47.787 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Product/6/discount - application/json 1
2025-07-26 13:50:47.793 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:50:47.832 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:50:47.837 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.AddDiscountToProduct (E-Commerce)'
2025-07-26 13:50:47.852 +03:00 [INF] Route matched with {action = "AddDiscountToProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] AddDiscountToProduct(Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-26 13:50:48.146 +03:00 [INF] Adding discount to product: 6 with discount: 3
2025-07-26 13:50:48.150 +03:00 [INF] Executing GetByIdAsync for entity Product with ID: 6
2025-07-26 13:50:48.160 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:50:48.218 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 3
2025-07-26 13:50:48.220 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:50:48.226 +03:00 [INF] Execute Update for entity Product
2025-07-26 13:50:48.231 +03:00 [INF] Product marked for update (pending save)
2025-07-26 13:50:48.233 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:50:48.235 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:50:48.237 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:50:48.293 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?' (Size = 20), @p9='?' (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p14='?' (Size = 255), @p15='?' (DbType = DateTime), @p16='?' (DbType = DateTime), @p17='?' (Size = 4000), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime), @p20='?' (DbType = Int32), @p21='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `CreatedAt` = @p0, `DeletedAt` = @p1, `Description` = @p2, `DiscountId` = @p3, `Gender` = @p4, `ImageId` = @p5, `IsActive` = @p6, `ModifiedAt` = @p7, `Name` = @p8, `Price` = @p9, `Quantity` = @p10, `SubCategoryId` = @p11, `fitType` = @p12
WHERE `Id` = @p13;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:50:48.335 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 13:50:48.466 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-26 13:50:48.515 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`fitType`, `t`.`IsActive`, `t`.`c`, `t`.`Price`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`fitType`, `p`.`IsActive`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`Price`, `p`.`SubCategoryId`, (`d`.`Id` IS NOT NULL AND (`d`.`DeletedAt` IS NULL)) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE `p`.`Id` = @__productId_0
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE `p0`.`DeletedAt` IS NULL AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-07-26 13:50:48.525 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:50:48.542 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.AddDiscountToProduct (E-Commerce) in 686.3653ms
2025-07-26 13:50:48.555 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.AddDiscountToProduct (E-Commerce)'
2025-07-26 13:50:48.556 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Product/6/discount - 201 1445 application/json; charset=utf-8 787.1025ms
2025-07-26 13:50:51.299 +03:00 [INF] Removing cache by tags: [product_search, subcategory, productwithvariantdata]
2025-07-26 13:50:51.307 +03:00 [WRN] No cache entries found for tags: [product_search, subcategory, productwithvariantdata]
2025-07-26 13:51:23.712 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - null null
2025-07-26 13:51:23.717 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:51:23.721 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:51:23.725 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:51:23.727 +03:00 [INF] Route matched with {action = "DeleteAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeleteAsync(Int32) on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:51:23.734 +03:00 [INF] Executing DeleteAsync for ID: 2
2025-07-26 13:51:23.735 +03:00 [INF] Deleting discount: 2
2025-07-26 13:51:23.736 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 2
2025-07-26 13:51:23.738 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:51:23.743 +03:00 [INF] Execute SoftDeleteAsync for entity Discount with ID: 2
2025-07-26 13:51:23.745 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE (`d`.`Id` = @__id_0) AND `d`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:51:23.751 +03:00 [WRN] Discount with ID: 2 not found or already deleted.
2025-07-26 13:51:23.753 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:51:23.755 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce) in 22.2295ms
2025-07-26 13:51:23.758 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:51:23.760 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - 400 213 application/json; charset=utf-8 47.4679ms
2025-07-26 13:52:00.268 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - null null
2025-07-26 13:52:00.284 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:52:00.359 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:52:00.364 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:52:00.369 +03:00 [INF] Route matched with {action = "DeleteAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeleteAsync(Int32) on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:52:00.372 +03:00 [INF] Executing DeleteAsync for ID: 2
2025-07-26 13:52:00.374 +03:00 [INF] Deleting discount: 2
2025-07-26 13:52:00.375 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 2
2025-07-26 13:52:00.377 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:52:00.398 +03:00 [INF] Execute SoftDeleteAsync for entity Discount with ID: 2
2025-07-26 13:52:00.400 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE (`d`.`Id` = @__id_0) AND `d`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:52:00.405 +03:00 [WRN] Discount with ID: 2 not found or already deleted.
2025-07-26 13:52:00.408 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:52:00.410 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce) in 39.8982ms
2025-07-26 13:52:00.414 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:52:00.421 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - 400 213 application/json; charset=utf-8 149.9542ms
2025-07-26 13:52:29.298 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 13:52:29.318 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 20.1965ms
2025-07-26 13:52:29.360 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 13:52:29.361 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 13:52:29.361 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 13:52:29.387 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 25.852ms
2025-07-26 13:52:29.411 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 50.023ms
2025-07-26 13:52:29.711 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 350.3767ms
2025-07-26 13:52:29.822 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 13:52:30.282 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 460.2241ms
2025-07-26 13:52:35.006 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - null null
2025-07-26 13:52:35.012 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:52:35.017 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:52:35.023 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:52:35.029 +03:00 [INF] Route matched with {action = "DeleteAsync", controller = "Discount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeleteAsync(Int32) on controller E_Commerce.Controllers.DiscountController (E-Commerce).
2025-07-26 13:52:35.035 +03:00 [INF] Executing DeleteAsync for ID: 2
2025-07-26 13:52:35.047 +03:00 [INF] Deleting discount: 2
2025-07-26 13:52:35.049 +03:00 [INF] Executing GetByIdAsync for entity Discount with ID: 2
2025-07-26 13:52:35.057 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Discount` AS `d`
WHERE `d`.`Id` = @__id_0
LIMIT 1
2025-07-26 13:52:35.061 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:52:35.064 +03:00 [INF] Executed action E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce) in 30.0402ms
2025-07-26 13:52:35.066 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.DiscountController.DeleteAsync (E-Commerce)'
2025-07-26 13:52:35.077 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Discount/2 - 404 199 application/json; charset=utf-8 70.788ms
2025-07-26 13:52:41.065 +03:00 [INF] 1 servers were removed due to timeout
2025-07-26 13:52:53.411 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 13:52:53.417 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:52:53.421 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:52:53.427 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:52:53.434 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:52:53.445 +03:00 [INF] Executing ClearCart
2025-07-26 13:52:53.450 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:52:53.456 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:52:53.527 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:52:53.572 +03:00 [INF] Clearing cart: 1
2025-07-26 13:52:53.579 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 13:52:53.587 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 13:52:53.589 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:52:53.590 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:52:53.592 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:52:53.616 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:52:53.630 +03:00 [INF] Removing cache by tag: cart
2025-07-26 13:52:53.637 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 13:52:53.641 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:52:53.643 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 203.2687ms
2025-07-26 13:52:53.645 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 13:52:53.655 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 241.7343ms
2025-07-26 13:52:56.730 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 68
2025-07-26 13:52:56.735 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:52:56.739 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:52:56.743 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:52:56.748 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:52:56.759 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 13:52:56.768 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:52:56.785 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 13:52:56.790 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 13:52:56.802 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 13:52:56.811 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 13:52:56.814 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:52:56.862 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:52:56.876 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 13:52:56.882 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 13:52:56.883 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:52:56.885 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:52:56.890 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:52:56.916 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (DbType = Int32), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `UnitPrice`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:52:56.930 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:52:56.933 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:52:56.935 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:52:56.937 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:52:56.940 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 187.0926ms
2025-07-26 13:52:56.942 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 13:52:56.960 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 230.5822ms
2025-07-26 13:53:02.436 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:53:02.441 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:53:02.444 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:53:02.448 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:53:02.487 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:53:02.508 +03:00 [INF] Executing GetCart
2025-07-26 13:53:02.512 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:53:02.515 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:53:02.522 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:53:02.528 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 13:53:02.533 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 13:53:02.657 +03:00 [INF] Executed DbCommand (71ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 13:53:02.672 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:53:02.719 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 13:53:02.722 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:53:02.737 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 246.2387ms
2025-07-26 13:53:02.740 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:53:02.742 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 919 application/json; charset=utf-8 306.663ms
2025-07-26 13:55:07.618 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:55:07.625 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:55:07.638 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:55:07.643 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:55:07.646 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:55:07.653 +03:00 [INF] Executing GetCart
2025-07-26 13:55:07.655 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:55:07.657 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:55:07.659 +03:00 [INF] Cache hit for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:55:07.673 +03:00 [INF] Cache hit for cart user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:55:07.675 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:55:07.680 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 27.9247ms
2025-07-26 13:55:07.708 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:55:07.719 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 917 application/json; charset=utf-8 100.6898ms
2025-07-26 13:57:04.701 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - application/json 2
2025-07-26 13:57:04.707 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:57:04.711 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:57:04.715 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 13:57:04.721 +03:00 [INF] Route matched with {action = "UpdateCartItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCartItem(Int32, E_Commerce.DtoModels.CartDtos.UpdateCartItemDto, System.Nullable`1[System.Int32]) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:57:04.746 +03:00 [WRN] ModelState errors: Error converting value 20 to type 'E_Commerce.DtoModels.CartDtos.UpdateCartItemDto'. Path '', line 1, position 2., The itemDto field is required.
2025-07-26 13:57:04.749 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:57:04.751 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce) in 26.4687ms
2025-07-26 13:57:04.753 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 13:57:04.755 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - 400 328 application/json; charset=utf-8 54.183ms
2025-07-26 13:57:22.042 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - application/json 22
2025-07-26 13:57:22.098 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:57:22.129 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:57:22.132 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 13:57:22.134 +03:00 [INF] Route matched with {action = "UpdateCartItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCartItem(Int32, E_Commerce.DtoModels.CartDtos.UpdateCartItemDto, System.Nullable`1[System.Int32]) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:57:22.145 +03:00 [INF] Executing UpdateCartItem for product ID: 6, variant ID: 3
2025-07-26 13:57:22.170 +03:00 [INF] Updating cart item for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6, variant: 3
2025-07-26 13:57:22.184 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:57:22.235 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:57:22.242 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 13:57:22.249 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 13:57:22.254 +03:00 [INF] Execute GetAll for entity ProductVariant
2025-07-26 13:57:22.265 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productVariantId_0='?' (DbType = Int32), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE (((`p`.`Id` = @__productVariantId_0) AND (`p`.`ProductId` = @__productId_1)) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 13:57:22.299 +03:00 [INF] Execute Update for entity CartItem
2025-07-26 13:57:22.300 +03:00 [INF] CartItem marked for update (pending save)
2025-07-26 13:57:22.302 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:57:22.303 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:57:22.305 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:57:22.322 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p10='?' (Size = 255), @p11='?' (DbType = DateTime), @p12='?' (DbType = DateTime), @p13='?' (Size = 4000), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime), @p16='?' (DbType = Int32), @p17='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `CartItems` SET `AddedAt` = @p0, `CartId` = @p1, `CreatedAt` = @p2, `DeletedAt` = @p3, `ModifiedAt` = @p4, `ProductId` = @p5, `ProductVariantId` = @p6, `Quantity` = @p7, `UnitPrice` = @p8
WHERE `Id` = @p9;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:57:22.333 +03:00 [INF] Removing cache by tag: cart
2025-07-26 13:57:22.337 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 13:57:22.339 +03:00 [INF] Cart item updated successfully for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6, variant: 3
2025-07-26 13:57:22.341 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:57:22.345 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce) in 208.1457ms
2025-07-26 13:57:22.348 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 13:57:22.349 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - 200 133 application/json; charset=utf-8 306.9521ms
2025-07-26 13:57:27.151 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:57:27.157 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:57:27.163 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:57:27.168 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:57:27.170 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:57:27.174 +03:00 [INF] Executing GetCart
2025-07-26 13:57:27.177 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:57:27.180 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:57:27.182 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:57:27.185 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 13:57:27.189 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 13:57:27.237 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 13:57:27.245 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:57:27.248 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 13:57:27.250 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:57:27.252 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 79.1399ms
2025-07-26 13:57:27.255 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:57:27.262 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 918 application/json; charset=utf-8 110.6999ms
2025-07-26 13:58:02.198 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/remove-item - application/json 48
2025-07-26 13:58:02.203 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:58:02.207 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:58:02.210 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce)'
2025-07-26 13:58:02.217 +03:00 [INF] Route matched with {action = "RemoveItemFromCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] RemoveItemFromCart(E_Commerce.DtoModels.CartDtos.RemoveCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:58:02.225 +03:00 [INF] Executing RemoveItemFromCart for product ID: 6
2025-07-26 13:58:02.230 +03:00 [INF] Removing item from cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:58:02.234 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:58:02.274 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:58:02.286 +03:00 [INF] Removing item from cart: 1, product: 6, variant: 3
2025-07-26 13:58:02.294 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__cartId_0='?' (DbType = Int32), @__productId_1='?' (DbType = Int32), @__productVariantId_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE (((`c`.`CartId` = @__cartId_0) AND (`c`.`ProductId` = @__productId_1)) AND (`c`.`ProductVariantId` = @__productVariantId_2)) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:58:02.298 +03:00 [INF] Cart item removed successfully
2025-07-26 13:58:02.300 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 13:58:02.301 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 13:58:02.304 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 13:58:02.309 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p10='?' (Size = 255), @p11='?' (DbType = DateTime), @p12='?' (DbType = DateTime), @p13='?' (Size = 4000), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime), @p16='?' (DbType = Int32), @p17='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `CartItems` SET `AddedAt` = @p0, `CartId` = @p1, `CreatedAt` = @p2, `DeletedAt` = @p3, `ModifiedAt` = @p4, `ProductId` = @p5, `ProductVariantId` = @p6, `Quantity` = @p7, `UnitPrice` = @p8
WHERE `Id` = @p9;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 13:58:02.317 +03:00 [INF] Removing cache by tag: cart
2025-07-26 13:58:02.324 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 13:58:02.327 +03:00 [INF] Item removed from cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:58:02.329 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:58:02.332 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce) in 111.635ms
2025-07-26 13:58:02.334 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce)'
2025-07-26 13:58:02.336 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/remove-item - 200 138 application/json; charset=utf-8 138.5461ms
2025-07-26 13:58:11.176 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 13:58:11.180 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:58:11.184 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:58:11.190 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:58:11.192 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:58:11.195 +03:00 [INF] Executing GetCart
2025-07-26 13:58:11.197 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:58:11.199 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:58:11.201 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:58:11.204 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 13:58:11.208 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 13:58:11.269 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 13:58:11.274 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:58:11.277 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 13:58:11.279 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 13:58:11.281 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 86.1469ms
2025-07-26 13:58:11.284 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 13:58:11.286 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 918 application/json; charset=utf-8 109.2377ms
2025-07-26 13:58:29.161 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/remove-item - application/json 48
2025-07-26 13:58:29.268 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 13:58:29.272 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 13:58:29.281 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce)'
2025-07-26 13:58:29.284 +03:00 [INF] Route matched with {action = "RemoveItemFromCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] RemoveItemFromCart(E_Commerce.DtoModels.CartDtos.RemoveCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 13:58:29.287 +03:00 [INF] Executing RemoveItemFromCart for product ID: 6
2025-07-26 13:58:29.289 +03:00 [INF] Removing item from cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 13:58:29.291 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 13:58:29.373 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 13:58:29.381 +03:00 [INF] Removing item from cart: 1, product: 6, variant: 3
2025-07-26 13:58:29.383 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32), @__productId_1='?' (DbType = Int32), @__productVariantId_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE (((`c`.`CartId` = @__cartId_0) AND (`c`.`ProductId` = @__productId_1)) AND (`c`.`ProductVariantId` = @__productVariantId_2)) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-26 13:58:29.386 +03:00 [WRN] Cart item not found for removal
2025-07-26 13:58:29.388 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 13:58:29.391 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce) in 104.2912ms
2025-07-26 13:58:29.401 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce)'
2025-07-26 13:58:29.403 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/remove-item - 404 201 application/json; charset=utf-8 241.992ms
2025-07-26 14:03:31.907 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 14:03:31.927 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 19.5927ms
2025-07-26 14:03:31.972 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 14:03:31.972 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 14:03:31.972 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 14:03:31.978 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.7725ms
2025-07-26 14:03:31.988 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 15.9644ms
2025-07-26 14:03:32.020 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.3601ms
2025-07-26 14:03:32.097 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 14:03:32.369 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 272.7505ms
2025-07-26 14:03:42.518 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/remove-item - application/json 48
2025-07-26 14:03:42.525 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 14:03:42.532 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 14:03:42.542 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce)'
2025-07-26 14:03:42.549 +03:00 [INF] Route matched with {action = "RemoveItemFromCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] RemoveItemFromCart(E_Commerce.DtoModels.CartDtos.RemoveCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 14:03:42.561 +03:00 [INF] Executing RemoveItemFromCart for product ID: 6
2025-07-26 14:03:42.562 +03:00 [INF] Removing item from cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 14:03:42.565 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 14:03:42.635 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 14:03:42.643 +03:00 [INF] Removing item from cart: 1, product: 6, variant: 3
2025-07-26 14:03:42.655 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32), @__productId_1='?' (DbType = Int32), @__productVariantId_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE ((`c`.`CartId` = @__cartId_0) AND (`c`.`ProductId` = @__productId_1)) AND (`c`.`ProductVariantId` = @__productVariantId_2)
LIMIT 1
2025-07-26 14:03:42.661 +03:00 [INF] Cart item removed successfully
2025-07-26 14:03:42.663 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 14:03:42.664 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 14:03:42.666 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 14:03:42.672 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 14:03:42.679 +03:00 [INF] Removing cache by tag: cart
2025-07-26 14:03:42.685 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 14:03:42.687 +03:00 [INF] Item removed from cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 14:03:42.689 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 14:03:42.691 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce) in 133.2899ms
2025-07-26 14:03:42.693 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.RemoveItemFromCart (E-Commerce)'
2025-07-26 14:03:42.695 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/remove-item - 200 138 application/json; charset=utf-8 177.0915ms
2025-07-26 14:03:48.598 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 14:03:48.693 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 14:03:48.696 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 14:03:48.704 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 14:03:48.711 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 14:03:48.716 +03:00 [INF] Executing GetCart
2025-07-26 14:03:48.724 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 14:03:48.725 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 14:03:48.727 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 14:03:48.739 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 14:03:48.744 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 14:03:48.824 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 14:03:48.844 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 14:03:48.852 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 14:03:48.854 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 14:03:48.857 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 142.1683ms
2025-07-26 14:03:48.860 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 14:03:48.940 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 318 application/json; charset=utf-8 342.3875ms
2025-07-26 16:24:02.737 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - application/json 23
2025-07-26 16:24:02.877 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:24:03.026 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:24:03.070 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 16:24:03.166 +03:00 [INF] Route matched with {action = "UpdateCartItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCartItem(Int32, E_Commerce.DtoModels.CartDtos.UpdateCartItemDto, System.Nullable`1[System.Int32]) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:24:03.268 +03:00 [WRN] ModelState errors: Quantity must be between 1 and 100
2025-07-26 16:24:03.276 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:24:03.303 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce) in 129.0962ms
2025-07-26 16:24:03.308 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 16:24:03.315 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - 400 216 application/json; charset=utf-8 579.434ms
2025-07-26 16:25:08.809 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - application/json 23
2025-07-26 16:25:08.825 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:25:08.834 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:25:08.844 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 16:25:08.856 +03:00 [INF] Route matched with {action = "UpdateCartItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCartItem(Int32, E_Commerce.DtoModels.CartDtos.UpdateCartItemDto, System.Nullable`1[System.Int32]) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:25:08.872 +03:00 [INF] Executing UpdateCartItem for product ID: 6, variant ID: 3
2025-07-26 16:25:08.878 +03:00 [INF] Updating cart item for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6, variant: 3
2025-07-26 16:25:08.887 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:08.976 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 16:25:08.994 +03:00 [WRN] Cart item not found for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6, variant: 3
2025-07-26 16:25:08.997 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:25:09.007 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce) in 140.8288ms
2025-07-26 16:25:09.013 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-07-26 16:25:09.024 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7288/api/Cart/update-item/6?productVariantId=3 - 404 201 application/json; charset=utf-8 214.4257ms
2025-07-26 16:25:16.806 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 16:25:16.822 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:25:16.828 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:25:16.837 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 16:25:16.848 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:25:16.855 +03:00 [INF] Executing GetCart
2025-07-26 16:25:16.860 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:16.864 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:16.871 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:16.877 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 16:25:16.885 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 16:25:16.960 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 16:25:16.974 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:17.009 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 16:25:17.014 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 16:25:17.019 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 165.7958ms
2025-07-26 16:25:17.097 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 16:25:17.299 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 318 application/json; charset=utf-8 492.5346ms
2025-07-26 16:25:30.255 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 69
2025-07-26 16:25:30.264 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:25:30.273 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:25:30.282 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:25:30.290 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:25:30.301 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 16:25:30.303 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 16:25:30.328 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 16:25:30.340 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 16:25:30.351 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 16:25:30.367 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (((`p`.`Id` = @__id_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL) AND (`p`.`Quantity` > 0))
2025-07-26 16:25:30.377 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:30.431 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 16:25:30.445 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-07-26 16:25:30.450 +03:00 [INF] CartItem added successfully (pending save)
2025-07-26 16:25:30.452 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 16:25:30.454 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 16:25:30.457 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 16:25:30.477 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (DbType = Int32), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `UnitPrice`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 16:25:30.487 +03:00 [INF] Removing cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:30.491 +03:00 [INF] Cache removed successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:30.493 +03:00 [INF] Item added to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 16:25:30.495 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:25:30.498 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 199.9457ms
2025-07-26 16:25:30.503 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:25:30.505 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 200 134 application/json; charset=utf-8 249.4251ms
2025-07-26 16:25:40.250 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Cart - null null
2025-07-26 16:25:40.397 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:25:40.478 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:25:40.483 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 16:25:40.485 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:25:40.490 +03:00 [INF] Executing GetCart
2025-07-26 16:25:40.491 +03:00 [INF] Getting cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:40.492 +03:00 [INF] Getting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:40.494 +03:00 [WRN] Cache miss for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:40.498 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-07-26 16:25:40.502 +03:00 [INF] Execute GetAll for entity Cart
2025-07-26 16:25:40.572 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`UnitPrice`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `c1`.`UnitPrice`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-07-26 16:25:40.577 +03:00 [INF] Setting cache for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:25:40.584 +03:00 [INF] Cache set successfully for key: cart_user_d1f25979-3a6d-4429-8380-c159dc573444 with tags: [cart]
2025-07-26 16:25:40.587 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-26 16:25:40.592 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 102.9719ms
2025-07-26 16:25:40.595 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-07-26 16:25:40.599 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Cart - 200 920 application/json; charset=utf-8 348.3678ms
2025-07-26 16:41:41.745 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 16:41:44.252 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 16:41:44.321 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 16:41:44.479 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 16:41:44.506 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 16:41:44.568 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 16:41:45.020 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 16:41:45.106 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 16:41:45.163 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 16:41:47.004 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 16:41:47.182 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 16:41:47.429 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 16:41:47.477 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 16:41:47.480 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 16:41:47.482 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 16:41:47.489 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 16:41:47.528 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 16:41:47.538 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 16:41:47.549 +03:00 [INF] Hosting environment: Development
2025-07-26 16:41:47.554 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 16:41:47.646 +03:00 [INF] Server mrrobot:1412:8d5f01ad successfully announced in 66.6605 ms
2025-07-26 16:41:47.654 +03:00 [INF] Server mrrobot:1412:8d5f01ad is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 16:41:47.764 +03:00 [INF] Server mrrobot:1412:8d5f01ad all the dispatchers started
2025-07-26 16:41:47.928 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 398.5102ms
2025-07-26 16:41:47.971 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 16:41:47.971 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 16:41:48.007 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 16:41:48.011 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 39.7236ms
2025-07-26 16:41:48.048 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 76.8483ms
2025-07-26 16:41:48.133 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 126.3833ms
2025-07-26 16:41:48.246 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 16:41:49.216 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 970.5034ms
2025-07-26 16:42:32.496 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - null null
2025-07-26 16:42:34.601 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:42:34.666 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:42:34.750 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 16:42:34.778 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:42:35.148 +03:00 [INF] Executing ClearCart
2025-07-26 16:42:35.154 +03:00 [INF] Clearing cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:42:35.182 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:42:35.362 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 16:42:35.438 +03:00 [INF] Clearing cart: 1
2025-07-26 16:42:35.497 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-07-26 16:42:35.519 +03:00 [INF] Cart 1 cleared successfully
2025-07-26 16:42:35.524 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-26 16:42:35.533 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-26 16:42:35.680 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-26 16:42:36.010 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-26 16:42:36.097 +03:00 [INF] Removing cache by tag: cart
2025-07-26 16:42:36.145 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-07-26 16:42:36.175 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:42:36.253 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 1466.3271ms
2025-07-26 16:42:36.263 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-07-26 16:42:36.283 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/Cart/clear - 200 128 application/json; charset=utf-8 3786.5679ms
2025-07-26 16:42:42.021 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 69
2025-07-26 16:42:42.034 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:42:42.043 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:42:42.058 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:42:42.076 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:42:42.167 +03:00 [WRN] ModelState errors: Quantity must be between 1 and 100
2025-07-26 16:42:42.174 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:42:42.181 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 99.7703ms
2025-07-26 16:42:42.184 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:42:42.186 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 400 216 application/json; charset=utf-8 164.8268ms
2025-07-26 16:43:55.192 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 16:43:55.223 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 30.2942ms
2025-07-26 16:43:55.256 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 16:43:55.265 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 9.387ms
2025-07-26 16:43:55.276 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 16:43:55.287 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 16:43:55.296 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.0987ms
2025-07-26 16:43:55.310 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 34.2938ms
2025-07-26 16:43:55.575 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 16:43:55.818 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 243.459ms
2025-07-26 16:43:59.871 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 69
2025-07-26 16:43:59.881 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:43:59.889 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:43:59.900 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:43:59.910 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:43:59.949 +03:00 [WRN] ModelState errors: Quantity must be between 1 and 100
2025-07-26 16:43:59.952 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:43:59.956 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 38.4806ms
2025-07-26 16:43:59.961 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:43:59.966 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 400 216 application/json; charset=utf-8 94.8865ms
2025-07-26 16:44:05.824 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 69
2025-07-26 16:44:05.835 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:44:05.843 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:44:05.863 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:44:05.868 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:44:05.875 +03:00 [WRN] ModelState errors: Quantity must be between 1 and 100
2025-07-26 16:44:05.877 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:44:05.881 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 7.7613ms
2025-07-26 16:44:05.884 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:44:05.886 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 400 216 application/json; charset=utf-8 62.4717ms
2025-07-26 16:44:15.084 +03:00 [INF] DB tables already exist. Exit install
2025-07-26 16:44:16.958 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 16:44:16.978 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-26 16:44:17.002 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-26 16:44:17.024 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-26 16:44:17.055 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-26 16:44:17.406 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 16:44:17.471 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-26 16:44:17.496 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-26 16:44:18.132 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-26 16:44:18.137 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-26 16:44:18.226 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-26 16:44:18.252 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-26 16:44:18.254 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-26 16:44:18.256 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-26 16:44:18.257 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-26 16:44:18.272 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-26 16:44:18.275 +03:00 [INF] Hosting environment: Development
2025-07-26 16:44:18.276 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-26 16:44:18.292 +03:00 [INF] Server mrrobot:13808:5dcad6b8 successfully announced in 15.5879 ms
2025-07-26 16:44:18.301 +03:00 [INF] Server mrrobot:13808:5dcad6b8 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-26 16:44:18.414 +03:00 [INF] Server mrrobot:13808:5dcad6b8 all the dispatchers started
2025-07-26 16:44:18.729 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-26 16:44:18.900 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 169.9516ms
2025-07-26 16:44:18.918 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-26 16:44:18.918 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-26 16:44:18.918 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-26 16:44:18.930 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 12.2256ms
2025-07-26 16:44:18.954 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 36.0987ms
2025-07-26 16:44:18.970 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.6238ms
2025-07-26 16:44:19.240 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-26 16:44:19.473 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 233.6218ms
2025-07-26 16:44:28.768 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - application/json 69
2025-07-26 16:44:28.885 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-26 16:44:28.954 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-26 16:44:29.025 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:44:29.056 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-07-26 16:44:29.520 +03:00 [INF] Executing AddItemToCart for product ID: 6
2025-07-26 16:44:29.531 +03:00 [INF] Adding item to cart for user: d1f25979-3a6d-4429-8380-c159dc573444, product: 6
2025-07-26 16:44:29.599 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-07-26 16:44:29.611 +03:00 [INF] Execute GetAll for entity Product
2025-07-26 16:44:29.731 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-07-26 16:44:29.873 +03:00 [INF] Executing GetByIdAsync for entity ProductVariant with ID: 3
2025-07-26 16:44:29.895 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-07-26 16:44:29.949 +03:00 [INF] Retrieving cart for user: d1f25979-3a6d-4429-8380-c159dc573444
2025-07-26 16:44:30.061 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-07-26 16:44:30.124 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-26 16:44:30.157 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 1087.2807ms
2025-07-26 16:44:30.160 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-07-26 16:44:30.182 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Cart/add-item - 400 253 application/json; charset=utf-8 1413.2077ms
2025-07-26 16:49:18.364 +03:00 [INF] 2 servers were removed due to timeout
