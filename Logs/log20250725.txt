2025-07-25 00:02:12.192 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive&isDeleted&page&pageSize - null null
2025-07-25 00:02:12.255 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:02:12.272 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:02:12.279 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:02:12.287 +03:00 [INF] Route matched with {action = "SearchCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] SearchCollectionsAdmin(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:02:12.300 +03:00 [INF] Executing SearchCollectionsAdmin for term: c with pagination: page 1, size 10
2025-07-25 00:02:12.302 +03:00 [INF] Searching collections with term: c
2025-07-25 00:02:12.304 +03:00 [INF] Getting collection by name: c
2025-07-25 00:02:12.348 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__name_0_contains='?' (Size = 4000), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`Name` LIKE @__name_0_contains
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_1 OFFSET @__p_1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:02:12.353 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:02:12.357 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce) in 64.4574ms
2025-07-25 00:02:12.359 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:02:12.404 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive&isDeleted&page&pageSize - 200 142 application/json; charset=utf-8 212.6287ms
2025-07-25 00:02:18.860 +03:00 [INF] 1 servers were removed due to timeout
2025-07-25 00:04:11.667 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c - null null
2025-07-25 00:04:11.678 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:04:11.694 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:04:11.699 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:04:11.702 +03:00 [INF] Route matched with {action = "SearchCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] SearchCollectionsAdmin(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:04:11.717 +03:00 [INF] Executing SearchCollectionsAdmin for term: c with pagination: page 1, size 10
2025-07-25 00:04:11.719 +03:00 [INF] Searching collections with term: c
2025-07-25 00:04:11.725 +03:00 [INF] Getting collection by name: c
2025-07-25 00:04:11.750 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__name_0_contains='?' (Size = 4000), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`Name` LIKE @__name_0_contains
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_1 OFFSET @__p_1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:04:11.760 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:04:11.765 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce) in 56.4187ms
2025-07-25 00:04:11.767 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:04:11.769 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c - 200 142 application/json; charset=utf-8 102.7014ms
2025-07-25 00:05:43.934 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive=false - null null
2025-07-25 00:05:43.942 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:05:43.952 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:05:43.959 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:05:43.964 +03:00 [INF] Route matched with {action = "SearchCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] SearchCollectionsAdmin(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:05:43.991 +03:00 [INF] Executing SearchCollectionsAdmin for term: c with pagination: page 1, size 10
2025-07-25 00:05:43.994 +03:00 [INF] Searching collections with term: c
2025-07-25 00:05:44.001 +03:00 [INF] Getting collection by name: c
2025-07-25 00:05:44.076 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__name_0_contains='?' (Size = 4000), @__IsActive_Value_1='?' (DbType = Boolean), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE (`c`.`Name` LIKE @__name_0_contains) AND (`c`.`IsActive` = @__IsActive_Value_1)
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_2 OFFSET @__p_2
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:05:44.083 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:05:44.087 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce) in 116.071ms
2025-07-25 00:05:44.089 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:05:44.092 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive=false - 200 142 application/json; charset=utf-8 157.0722ms
2025-07-25 00:07:40.659 +03:00 [INF] DB tables already exist. Exit install
2025-07-25 00:07:42.448 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 00:07:42.471 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 00:07:42.505 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-25 00:07:42.533 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-25 00:07:42.580 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-25 00:07:42.951 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 00:07:43.029 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 00:07:43.061 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-25 00:07:44.198 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-25 00:07:44.203 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-25 00:07:44.320 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-25 00:07:44.357 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-25 00:07:44.360 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-25 00:07:44.362 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-25 00:07:44.364 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-25 00:07:44.383 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-25 00:07:44.385 +03:00 [INF] Hosting environment: Development
2025-07-25 00:07:44.387 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-25 00:07:44.420 +03:00 [INF] Server mrrobot:17348:8b621e84 successfully announced in 14.5083 ms
2025-07-25 00:07:44.469 +03:00 [INF] Server mrrobot:17348:8b621e84 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-25 00:07:44.892 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 00:07:44.906 +03:00 [INF] Server mrrobot:17348:8b621e84 all the dispatchers started
2025-07-25 00:07:45.197 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 306.6149ms
2025-07-25 00:07:45.247 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 00:07:45.247 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 00:07:45.263 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 15.2921ms
2025-07-25 00:07:45.277 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 29.9708ms
2025-07-25 00:07:45.286 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 00:07:45.417 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 131.0068ms
2025-07-25 00:07:45.683 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 00:07:46.386 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 703.4625ms
2025-07-25 00:12:44.560 +03:00 [INF] 1 servers were removed due to timeout
2025-07-25 00:21:09.898 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:21:10.077 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:21:10.139 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:21:10.224 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:21:10.265 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:21:10.834 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:21:10.844 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:21:10.852 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:21:10.865 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:21:10.871 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:21:11.089 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-25 00:21:11.140 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:21:11.150 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:21:11.166 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:21:11.210 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 929.6321ms
2025-07-25 00:21:11.214 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:21:11.223 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 404 202 application/json; charset=utf-8 1325.0964ms
2025-07-25 00:21:25.388 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - null null
2025-07-25 00:21:25.454 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:21:25.532 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:21:25.662 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:21:25.718 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:21:25.745 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:21:25.772 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:21:25.774 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:21:25.778 +03:00 [INF] Cache hit for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:21:25.817 +03:00 [INF] Cache hit for collection 7
2025-07-25 00:21:25.820 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:21:25.836 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 113.0073ms
2025-07-25 00:21:25.838 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:21:25.841 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - 200 581 application/json; charset=utf-8 453.9401ms
2025-07-25 00:23:22.871 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 00:23:22.893 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 21.8938ms
2025-07-25 00:23:22.946 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 00:23:22.957 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 10.5617ms
2025-07-25 00:23:22.958 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 00:23:22.976 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 00:23:22.977 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 18.4412ms
2025-07-25 00:23:22.996 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 19.4446ms
2025-07-25 00:23:23.177 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 00:23:23.371 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 194.0361ms
2025-07-25 00:24:03.099 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive=false - null null
2025-07-25 00:24:03.114 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:24:03.120 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:24:03.138 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:24:03.151 +03:00 [INF] Route matched with {action = "SearchCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] SearchCollectionsAdmin(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:24:03.185 +03:00 [INF] Executing SearchCollectionsAdmin for term: c with pagination: page 1, size 10
2025-07-25 00:24:03.197 +03:00 [INF] Searching collections with term: c
2025-07-25 00:24:03.203 +03:00 [INF] Getting collection by name: c
2025-07-25 00:24:03.298 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__name_0_contains='?' (Size = 4000), @__IsActive_Value_1='?' (DbType = Boolean), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE (`c`.`Name` LIKE @__name_0_contains) AND (`c`.`IsActive` = @__IsActive_Value_1)
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:24:03.313 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:24:03.329 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce) in 167.4866ms
2025-07-25 00:24:03.336 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.SearchCollectionsAdmin (E-Commerce)'
2025-07-25 00:24:03.343 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/search?searchTerm=c&isActive=false - 200 579 application/json; charset=utf-8 243.8855ms
2025-07-25 00:25:08.840 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive&includeDeleted&page&pageSize - null null
2025-07-25 00:25:08.852 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:25:08.858 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:25:08.868 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:25:08.877 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:25:08.920 +03:00 [INF] Getting cache for key: advsearch__________False_1_10__
2025-07-25 00:25:08.925 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10__
2025-07-25 00:25:08.930 +03:00 [INF] Execute GetAll for entity Product
2025-07-25 00:25:08.995 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`))
    ELSE `t`.`Price`
END, `t`.`fitType`, `d`.`Id`, `t0`.`Id`, `t0`.`Url`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t`.`IsActive`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-07-25 00:25:09.159 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:25:09.173 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 288.2667ms
2025-07-25 00:25:09.176 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:25:09.178 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive&includeDeleted&page&pageSize - 200 2810 application/json; charset=utf-8 337.4228ms
2025-07-25 00:25:15.938 +03:00 [INF] Setting cache for key: advsearch__________False_1_10__
2025-07-25 00:25:16.000 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10__ with tags: [product_search]
2025-07-25 00:27:05.629 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Collection/7/products - application/json 31
2025-07-25 00:27:05.694 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:27:05.711 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:27:05.717 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce)'
2025-07-25 00:27:05.751 +03:00 [INF] Route matched with {action = "AddProductsToCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddProductsToCollection(Int32, E_Commerce.DtoModels.CollectionDtos.AddProductsToCollectionDto) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:27:05.775 +03:00 [WRN] ModelState errors: Error converting value "productIds" to type 'E_Commerce.DtoModels.CollectionDtos.AddProductsToCollectionDto'. Path '', line 1, position 12., The productsDto field is required.
2025-07-25 00:27:05.779 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:27:05.786 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce) in 31.7065ms
2025-07-25 00:27:05.795 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce)'
2025-07-25 00:27:05.797 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Collection/7/products - 400 360 application/json; charset=utf-8 170.8909ms
2025-07-25 00:27:31.374 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 00:27:31.406 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 30.5241ms
2025-07-25 00:27:31.440 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 00:27:31.449 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 00:27:31.449 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 00:27:31.465 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 16.3017ms
2025-07-25 00:27:31.465 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 25.1702ms
2025-07-25 00:27:31.494 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.6125ms
2025-07-25 00:27:31.761 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 00:27:32.064 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 302.7665ms
2025-07-25 00:28:15.239 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Collection/7/products - multipart/form-data; boundary=--------------------------040729678143875557548479 386
2025-07-25 00:28:15.250 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:28:15.255 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:28:15.263 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce)'
2025-07-25 00:28:15.281 +03:00 [INF] Route matched with {action = "AddProductsToCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddProductsToCollection(Int32, E_Commerce.DtoModels.CollectionDtos.AddProductsToCollectionDto) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:28:15.323 +03:00 [INF] Executing AddProductsToCollection for collection ID: 7
2025-07-25 00:28:15.333 +03:00 [INF] Adding 3 products to collection 7
2025-07-25 00:28:15.366 +03:00 [INF] Executing GetByIdAsync for entity Collection with ID: 7
2025-07-25 00:28:15.381 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-07-25 00:28:15.431 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-07-25 00:28:15.443 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-07-25 00:28:15.452 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-07-25 00:28:15.463 +03:00 [INF] Adding 2 products to collection 7
2025-07-25 00:28:15.495 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`ProductId`, `p`.`CollectionId`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Id`, `p`.`ModifiedAt`
FROM `ProductCollections` AS `p`
WHERE (`p`.`CollectionId` = @__collectionId_0) AND `p`.`ProductId` IN (1, 5)
2025-07-25 00:28:15.580 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 00:28:15.588 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 00:28:15.631 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 00:28:15.819 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime), @p9='?' (DbType = DateTime), @p10='?' (DbType = Int32), @p11='?' (DbType = DateTime), @p12='?' (Size = 255), @p13='?' (DbType = DateTime), @p14='?' (DbType = DateTime), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (DbType = DateTime), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `ProductCollections` (`CollectionId`, `ProductId`, `CreatedAt`, `DeletedAt`, `Id`, `ModifiedAt`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5),
(@p6, @p7, @p8, @p9, @p10, @p11);
INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-25 00:28:15.872 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-07-25 00:28:15.885 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:28:15.889 +03:00 [INF] Removed 1 cache entries for tags: [collection, CollectionWithProduct]
2025-07-25 00:28:15.891 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce) in 601.2203ms
2025-07-25 00:28:15.902 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce)'
2025-07-25 00:28:15.906 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Collection/7/products - 200 171 application/json; charset=utf-8 666.8145ms
2025-07-25 00:28:27.965 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - null null
2025-07-25 00:28:27.976 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:28:27.983 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:28:27.998 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:28:28.009 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:28:28.024 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:28:28.028 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:28:28.032 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:28:28.038 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:28:28.043 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:28:28.076 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-25 00:28:28.138 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`Id` = @__collectionId_0
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:28:28.148 +03:00 [INF] Setting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:28:28.163 +03:00 [INF] Cache set successfully for key: CollectionWithProduct_id_7_IsActive__IsDeleted_ with tags: [collection]
2025-07-25 00:28:28.170 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:28:28.177 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 157.6012ms
2025-07-25 00:28:28.180 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:28:28.186 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - 200 1328 application/json; charset=utf-8 218.3906ms
2025-07-25 00:30:28.856 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - null 0
2025-07-25 00:30:28.924 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:30:29.076 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:30:29.085 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:30:29.094 +03:00 [INF] Route matched with {action = "ActivateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActivateCollection(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:30:29.116 +03:00 [INF] Activating collection 7 by user d1f25979-3a6d-4429-8380-c159dc573444
2025-07-25 00:30:29.118 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:30:29.139 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE `c`.`Id` = `i`.`CollectionId`) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p`
    INNER JOIN `Products` AS `p0` ON `p`.`ProductId` = `p0`.`Id`
    WHERE (`c`.`Id` = `p`.`CollectionId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasProducts`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 00:30:29.145 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:30:29.148 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce) in 49.9165ms
2025-07-25 00:30:29.153 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:30:29.156 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - 400 281 application/json; charset=utf-8 299.9472ms
2025-07-25 00:30:43.058 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isActive&isDeleted&page&pageSize - null null
2025-07-25 00:30:43.065 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:30:43.070 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:30:43.077 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:30:43.090 +03:00 [INF] Route matched with {action = "GetCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] GetCollectionsAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:30:43.099 +03:00 [INF] Executing GetCollectionsAdmin (admin endpoint) with pagination: page 1, size 10
2025-07-25 00:30:43.103 +03:00 [INF] Searching collections with term: 
2025-07-25 00:30:43.105 +03:00 [INF] Getting collection by name: 
2025-07-25 00:30:43.156 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:30:43.162 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:30:43.166 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce) in 69.2935ms
2025-07-25 00:30:43.182 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:30:43.184 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isActive&isDeleted&page&pageSize - 200 579 application/json; charset=utf-8 125.443ms
2025-07-25 00:31:22.559 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isActive=true&isDeleted&page&pageSize - null null
2025-07-25 00:31:22.567 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:31:22.573 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:31:22.580 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:31:22.584 +03:00 [INF] Route matched with {action = "GetCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] GetCollectionsAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:31:22.593 +03:00 [INF] Executing GetCollectionsAdmin (admin endpoint) with pagination: page 1, size 10
2025-07-25 00:31:22.597 +03:00 [INF] Searching collections with term: 
2025-07-25 00:31:22.599 +03:00 [INF] Getting collection by name: 
2025-07-25 00:31:22.645 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__IsActive_Value_0='?' (DbType = Boolean), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`IsActive` = @__IsActive_Value_0
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_2 OFFSET @__p_1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:31:22.652 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:31:22.657 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce) in 66.6561ms
2025-07-25 00:31:22.659 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:31:22.661 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isActive=true&isDeleted&page&pageSize - 200 142 application/json; charset=utf-8 102.195ms
2025-07-25 00:33:06.704 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive&includeDeleted&page&pageSize - null null
2025-07-25 00:33:06.712 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:33:06.719 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:33:06.729 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:33:06.740 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:33:06.747 +03:00 [INF] Getting cache for key: advsearch__________False_1_10__
2025-07-25 00:33:06.753 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10__
2025-07-25 00:33:06.757 +03:00 [INF] Execute GetAll for entity Product
2025-07-25 00:33:06.799 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`))
    ELSE `t`.`Price`
END, `t`.`fitType`, `d`.`Id`, `t0`.`Id`, `t0`.`Url`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t`.`IsActive`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-07-25 00:33:06.840 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:33:06.845 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 101.1751ms
2025-07-25 00:33:06.849 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:33:06.850 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive&includeDeleted&page&pageSize - 200 2810 application/json; charset=utf-8 146.0495ms
2025-07-25 00:33:13.122 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - null null
2025-07-25 00:33:13.129 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:33:13.142 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:33:13.152 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:33:13.155 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:33:13.172 +03:00 [INF] Getting cache for key: advsearch__________False_1_10_True_
2025-07-25 00:33:13.175 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10_True_
2025-07-25 00:33:13.177 +03:00 [INF] Execute GetAll for entity Product
2025-07-25 00:33:13.233 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`))
    ELSE `t`.`Price`
END, `t`.`fitType`, `d`.`Id`, `t0`.`Id`, `t0`.`Url`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t`.`IsActive`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE `p`.`IsActive`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-07-25 00:33:13.272 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:33:13.276 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 116.3091ms
2025-07-25 00:33:13.278 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:33:13.281 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - 404 254 application/json; charset=utf-8 158.6938ms
2025-07-25 00:33:16.441 +03:00 [INF] Setting cache for key: advsearch__________False_1_10__
2025-07-25 00:33:16.442 +03:00 [INF] Setting cache for key: advsearch__________False_1_10_True_
2025-07-25 00:33:16.451 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10_True_ with tags: [product_search]
2025-07-25 00:33:16.451 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10__ with tags: [product_search]
2025-07-25 00:33:20.524 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?includeDeleted&page&pageSize - null null
2025-07-25 00:33:20.534 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:33:20.539 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:33:20.551 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:33:20.556 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:33:20.562 +03:00 [INF] Getting cache for key: advsearch__________False_1_10__
2025-07-25 00:33:20.568 +03:00 [INF] Cache hit for key: advsearch__________False_1_10__
2025-07-25 00:33:20.580 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:33:20.586 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 24.9941ms
2025-07-25 00:33:20.591 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:33:20.595 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?includeDeleted&page&pageSize - 200 2810 application/json; charset=utf-8 70.5398ms
2025-07-25 00:33:59.521 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Product/6/activate - null 0
2025-07-25 00:33:59.534 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:33:59.539 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:33:59.549 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-07-25 00:33:59.561 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:33:59.633 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productId_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-07-25 00:33:59.746 +03:00 [INF] Execute Update for entity Product
2025-07-25 00:33:59.751 +03:00 [INF] Product marked for update (pending save)
2025-07-25 00:33:59.756 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 00:33:59.760 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 00:33:59.765 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 00:33:59.846 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime), @p8='?' (Size = 20), @p9='?' (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p14='?' (Size = 255), @p15='?' (DbType = DateTime), @p16='?' (DbType = DateTime), @p17='?' (Size = 4000), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime), @p20='?' (DbType = Int32), @p21='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `CreatedAt` = @p0, `DeletedAt` = @p1, `Description` = @p2, `DiscountId` = @p3, `Gender` = @p4, `ImageId` = @p5, `IsActive` = @p6, `ModifiedAt` = @p7, `Name` = @p8, `Price` = @p9, `Quantity` = @p10, `SubCategoryId` = @p11, `fitType` = @p12
WHERE `Id` = @p13;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-25 00:33:59.901 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:33:59.909 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 338.7301ms
2025-07-25 00:33:59.917 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-07-25 00:33:59.919 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Product/6/activate - 200 133 application/json; charset=utf-8 397.9783ms
2025-07-25 00:34:06.467 +03:00 [INF] Removing cache by tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct]
2025-07-25 00:34:06.491 +03:00 [INF] Removed 6 cache entries for tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct]
2025-07-25 00:34:14.716 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - null 0
2025-07-25 00:34:14.725 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:34:14.731 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:34:14.735 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:34:14.739 +03:00 [INF] Route matched with {action = "ActivateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActivateCollection(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:34:14.748 +03:00 [INF] Activating collection 7 by user d1f25979-3a6d-4429-8380-c159dc573444
2025-07-25 00:34:14.750 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:34:14.755 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE `c`.`Id` = `i`.`CollectionId`) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p`
    INNER JOIN `Products` AS `p0` ON `p`.`ProductId` = `p0`.`Id`
    WHERE (`c`.`Id` = `p`.`CollectionId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasProducts`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 00:34:14.764 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:34:14.768 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce) in 22.2421ms
2025-07-25 00:34:14.771 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:34:14.774 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - 400 281 application/json; charset=utf-8 58.1357ms
2025-07-25 00:34:28.742 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isDeleted&page&pageSize - null null
2025-07-25 00:34:28.751 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:34:28.755 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:34:28.760 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:34:28.762 +03:00 [INF] Route matched with {action = "GetCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] GetCollectionsAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:34:28.769 +03:00 [INF] Executing GetCollectionsAdmin (admin endpoint) with pagination: page 1, size 10
2025-07-25 00:34:28.770 +03:00 [INF] Searching collections with term: 
2025-07-25 00:34:28.772 +03:00 [INF] Getting collection by name: 
2025-07-25 00:34:28.799 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:34:28.807 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:34:28.810 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce) in 42.3881ms
2025-07-25 00:34:28.850 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:34:28.861 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isDeleted&page&pageSize - 200 579 application/json; charset=utf-8 118.6718ms
2025-07-25 00:34:45.578 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?includeDeleted&page&pageSize - null null
2025-07-25 00:34:45.773 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:34:45.780 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:34:45.860 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:34:45.864 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:34:45.880 +03:00 [INF] Getting cache for key: advsearch__________False_1_10__
2025-07-25 00:34:45.883 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10__
2025-07-25 00:34:45.898 +03:00 [INF] Execute GetAll for entity Product
2025-07-25 00:34:45.941 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`))
    ELSE `t`.`Price`
END, `t`.`fitType`, `d`.`Id`, `t0`.`Id`, `t0`.`Url`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t`.`IsActive`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-07-25 00:34:45.977 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:34:45.980 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 101.7341ms
2025-07-25 00:34:45.982 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:34:46.009 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?includeDeleted&page&pageSize - 200 2809 application/json; charset=utf-8 431.3239ms
2025-07-25 00:34:46.528 +03:00 [INF] Setting cache for key: advsearch__________False_1_10__
2025-07-25 00:34:46.533 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10__ with tags: [product_search]
2025-07-25 00:34:53.462 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - null null
2025-07-25 00:34:53.472 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:34:53.477 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:34:53.485 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:34:53.489 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:34:53.494 +03:00 [INF] Getting cache for key: advsearch__________False_1_10_True_
2025-07-25 00:34:53.498 +03:00 [WRN] Cache miss for key: advsearch__________False_1_10_True_
2025-07-25 00:34:53.503 +03:00 [INF] Execute GetAll for entity Product
2025-07-25 00:34:53.531 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`))
    ELSE `t`.`Price`
END, `t`.`fitType`, `d`.`Id`, `t0`.`Id`, `t0`.`Url`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t`.`IsActive`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE `p`.`IsActive`
    ORDER BY `p`.`Name`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
ORDER BY `t`.`Name`, `t`.`Id`, `d`.`Id`
2025-07-25 00:34:53.555 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:34:53.557 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 64.0056ms
2025-07-25 00:34:53.578 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:34:53.598 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - 200 1082 application/json; charset=utf-8 136.4332ms
2025-07-25 00:34:56.591 +03:00 [INF] Setting cache for key: advsearch__________False_1_10_True_
2025-07-25 00:34:56.595 +03:00 [INF] Cache set successfully for key: advsearch__________False_1_10_True_ with tags: [product_search]
2025-07-25 00:35:11.217 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - null null
2025-07-25 00:35:11.225 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:35:11.233 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:35:11.243 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:35:11.244 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:35:11.249 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:35:11.250 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:35:11.252 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:35:11.257 +03:00 [INF] Cache hit for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:35:11.261 +03:00 [INF] Cache hit for collection 7
2025-07-25 00:35:11.265 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:35:11.269 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 21.8827ms
2025-07-25 00:35:11.271 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:35:11.274 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - 200 1326 application/json; charset=utf-8 55.877ms
2025-07-25 00:35:48.156 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/Collection/7/products - multipart/form-data; boundary=--------------------------434102250554606907919470 386
2025-07-25 00:35:48.164 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:35:48.171 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:35:48.179 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce)'
2025-07-25 00:35:48.185 +03:00 [INF] Route matched with {action = "AddProductsToCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddProductsToCollection(Int32, E_Commerce.DtoModels.CollectionDtos.AddProductsToCollectionDto) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:35:48.194 +03:00 [INF] Executing AddProductsToCollection for collection ID: 7
2025-07-25 00:35:48.198 +03:00 [INF] Adding 3 products to collection 7
2025-07-25 00:35:48.211 +03:00 [INF] Executing GetByIdAsync for entity Collection with ID: 7
2025-07-25 00:35:48.217 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-07-25 00:35:48.225 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-07-25 00:35:48.234 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-07-25 00:35:48.240 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-07-25 00:35:48.246 +03:00 [INF] Adding 3 products to collection 7
2025-07-25 00:35:48.258 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`ProductId`, `p`.`CollectionId`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Id`, `p`.`ModifiedAt`
FROM `ProductCollections` AS `p`
WHERE (`p`.`CollectionId` = @__collectionId_0) AND `p`.`ProductId` IN (1, 5, 6)
2025-07-25 00:35:48.273 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 00:35:48.277 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 00:35:48.280 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 00:35:48.288 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (Size = 255), @p7='?' (DbType = DateTime), @p8='?' (DbType = DateTime), @p9='?' (Size = 4000), @p10='?' (DbType = Int32), @p11='?' (DbType = DateTime), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `ProductCollections` (`CollectionId`, `ProductId`, `CreatedAt`, `DeletedAt`, `Id`, `ModifiedAt`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-25 00:35:48.300 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-07-25 00:35:48.305 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:35:48.306 +03:00 [INF] Removed 1 cache entries for tags: [collection, CollectionWithProduct]
2025-07-25 00:35:48.308 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce) in 118.2405ms
2025-07-25 00:35:48.316 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.AddProductsToCollection (E-Commerce)'
2025-07-25 00:35:48.330 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/Collection/7/products - 200 142 application/json; charset=utf-8 174.2881ms
2025-07-25 00:35:59.019 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - null 0
2025-07-25 00:35:59.025 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:35:59.032 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:35:59.037 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:35:59.047 +03:00 [INF] Route matched with {action = "ActivateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActivateCollection(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:35:59.053 +03:00 [INF] Activating collection 7 by user d1f25979-3a6d-4429-8380-c159dc573444
2025-07-25 00:35:59.056 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:35:59.066 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE `c`.`Id` = `i`.`CollectionId`) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p`
    INNER JOIN `Products` AS `p0` ON `p`.`ProductId` = `p0`.`Id`
    WHERE (`c`.`Id` = `p`.`CollectionId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasProducts`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 00:35:59.073 +03:00 [INF] Updating collection 7 status to True
2025-07-25 00:35:59.081 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 00:35:59.087 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 00:35:59.089 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 00:35:59.090 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 00:35:59.092 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-07-25 00:35:59.094 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:35:59.095 +03:00 [WRN] No cache entries found for tags: [collection, CollectionWithProduct]
2025-07-25 00:35:59.097 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce) in 45.8312ms
2025-07-25 00:35:59.102 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:35:59.105 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - 200 136 application/json; charset=utf-8 85.7768ms
2025-07-25 00:36:05.122 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:36:05.288 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:36:05.559 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:36:05.576 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:36:05.597 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:36:05.608 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:36:05.610 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:36:05.617 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:36:05.620 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:36:05.622 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:36:05.652 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:36:05.660 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:36:05.661 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:36:05.664 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 58.6311ms
2025-07-25 00:36:05.669 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:36:05.671 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 404 202 application/json; charset=utf-8 549.1209ms
2025-07-25 00:36:19.178 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - null null
2025-07-25 00:36:19.187 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:36:19.191 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:36:19.200 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:36:19.203 +03:00 [INF] Route matched with {action = "GetProductsForAdmin", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetProductsForAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:36:19.209 +03:00 [INF] Getting cache for key: advsearch__________False_1_10_True_
2025-07-25 00:36:19.211 +03:00 [INF] Cache hit for key: advsearch__________False_1_10_True_
2025-07-25 00:36:19.213 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:36:19.217 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce) in 9.5928ms
2025-07-25 00:36:19.220 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProductsForAdmin (E-Commerce)'
2025-07-25 00:36:19.222 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Product/admin/list?isActive=true&includeDeleted&page&pageSize - 200 1082 application/json; charset=utf-8 43.3927ms
2025-07-25 00:36:25.070 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isDeleted&page&pageSize - null null
2025-07-25 00:36:25.081 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:36:25.089 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:36:25.095 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:36:25.098 +03:00 [INF] Route matched with {action = "GetCollectionsAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]]] GetCollectionsAdmin(System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:36:25.106 +03:00 [INF] Executing GetCollectionsAdmin (admin endpoint) with pagination: page 1, size 10
2025-07-25 00:36:25.109 +03:00 [INF] Searching collections with term: 
2025-07-25 00:36:25.112 +03:00 [INF] Getting collection by name: 
2025-07-25 00:36:25.344 +03:00 [INF] Executed DbCommand (229ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    ORDER BY `c`.`DisplayOrder`, `c`.`CreatedAt`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
ORDER BY `t`.`DisplayOrder`, `t`.`CreatedAt`, `t`.`Id`
2025-07-25 00:36:25.350 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:36:25.354 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce) in 248.4224ms
2025-07-25 00:36:25.357 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionsAdmin (E-Commerce)'
2025-07-25 00:36:25.372 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/GetAll?isDeleted&page&pageSize - 200 579 application/json; charset=utf-8 302.6929ms
2025-07-25 00:36:33.103 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:36:33.111 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:36:33.115 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:36:33.126 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:36:33.128 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:36:33.133 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:36:33.135 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:36:33.137 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:36:33.140 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:36:33.143 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:36:33.172 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:36:33.178 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:36:33.182 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:36:33.185 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 53.8245ms
2025-07-25 00:36:33.191 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:36:33.194 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 404 202 application/json; charset=utf-8 91.0069ms
2025-07-25 00:36:44.839 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - null null
2025-07-25 00:36:44.850 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:36:44.855 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:36:44.864 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:36:44.870 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:36:44.882 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:36:44.886 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:36:44.891 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:36:44.896 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:36:44.899 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:36:44.955 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`Id` = @__collectionId_0
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:36:44.965 +03:00 [INF] Setting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:36:44.970 +03:00 [INF] Cache set successfully for key: CollectionWithProduct_id_7_IsActive__IsDeleted_ with tags: [collection]
2025-07-25 00:36:44.976 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:36:44.984 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 103.8151ms
2025-07-25 00:36:44.995 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:36:45.000 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - 200 2245 application/json; charset=utf-8 160.6492ms
2025-07-25 00:37:22.993 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - null 0
2025-07-25 00:37:23.074 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:37:23.283 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:37:23.286 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:37:23.289 +03:00 [INF] Route matched with {action = "ActivateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActivateCollection(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:37:23.293 +03:00 [INF] Activating collection 7 by user d1f25979-3a6d-4429-8380-c159dc573444
2025-07-25 00:37:23.294 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:37:23.310 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE `c`.`Id` = `i`.`CollectionId`) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p`
    INNER JOIN `Products` AS `p0` ON `p`.`ProductId` = `p0`.`Id`
    WHERE (`c`.`Id` = `p`.`CollectionId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasProducts`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 00:37:23.330 +03:00 [INF] Updating collection 7 status to True
2025-07-25 00:37:23.360 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 00:37:23.367 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 00:37:23.370 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 00:37:23.372 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 00:37:23.373 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-07-25 00:37:23.375 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:37:23.376 +03:00 [INF] Removed 1 cache entries for tags: [collection, CollectionWithProduct]
2025-07-25 00:37:23.378 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce) in 86.7156ms
2025-07-25 00:37:23.381 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:37:23.383 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - 200 136 application/json; charset=utf-8 389.9893ms
2025-07-25 00:37:44.972 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - null null
2025-07-25 00:37:44.978 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:37:44.983 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:37:44.988 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:37:44.989 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:37:44.996 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:37:44.999 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:37:45.000 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:37:45.002 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:37:45.004 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:37:45.055 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`Id` = @__collectionId_0
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:37:45.068 +03:00 [INF] Setting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:37:45.070 +03:00 [INF] Cache set successfully for key: CollectionWithProduct_id_7_IsActive__IsDeleted_ with tags: [collection]
2025-07-25 00:37:45.072 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:37:45.077 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 83.9115ms
2025-07-25 00:37:45.123 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:37:45.125 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - 200 2245 application/json; charset=utf-8 153.5891ms
2025-07-25 00:41:09.803 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 00:41:09.901 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 97.709ms
2025-07-25 00:41:10.281 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 00:41:10.297 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 16.1809ms
2025-07-25 00:41:10.454 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 00:41:10.492 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.0254ms
2025-07-25 00:41:10.516 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 00:41:10.548 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 32.3692ms
2025-07-25 00:41:18.887 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 00:41:19.840 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 952.7875ms
2025-07-25 00:41:51.556 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 00:41:52.083 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 527.0535ms
2025-07-25 00:41:52.531 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 00:41:52.536 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 4.9596ms
2025-07-25 00:41:52.545 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 00:41:52.563 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 17.6433ms
2025-07-25 00:41:52.702 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 00:41:52.708 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.7235ms
2025-07-25 00:41:53.150 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 00:41:53.311 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 160.2088ms
2025-07-25 00:42:16.129 +03:00 [INF] DB tables already exist. Exit install
2025-07-25 00:42:17.863 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 00:42:17.881 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 00:42:17.908 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-25 00:42:17.930 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-25 00:42:17.970 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-25 00:42:18.338 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 00:42:18.421 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 00:42:18.449 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-25 00:42:19.283 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-25 00:42:19.285 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-25 00:42:19.379 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-25 00:42:19.412 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-25 00:42:19.414 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-25 00:42:19.416 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-25 00:42:19.419 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-25 00:42:19.437 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-25 00:42:19.441 +03:00 [INF] Hosting environment: Development
2025-07-25 00:42:19.460 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-25 00:42:19.520 +03:00 [INF] Server mrrobot:18320:45bee59f successfully announced in 54.0318 ms
2025-07-25 00:42:19.526 +03:00 [INF] Server mrrobot:18320:45bee59f is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-25 00:42:19.982 +03:00 [INF] Server mrrobot:18320:45bee59f all the dispatchers started
2025-07-25 00:42:20.103 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 00:42:20.279 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 177.1495ms
2025-07-25 00:42:20.353 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 00:42:20.360 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 00:42:20.361 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 7.2818ms
2025-07-25 00:42:20.370 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 00:42:20.382 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.3913ms
2025-07-25 00:42:20.400 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 40.025ms
2025-07-25 00:42:20.749 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 00:42:20.990 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 241.8018ms
2025-07-25 00:42:50.605 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Product/6/activate - null 0
2025-07-25 00:42:50.751 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:42:50.811 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:42:50.883 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-07-25 00:42:50.914 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:42:51.447 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productId_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-07-25 00:42:51.618 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:42:51.660 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 736.5619ms
2025-07-25 00:42:51.666 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-07-25 00:42:51.690 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Product/6/activate - 200 125 application/json; charset=utf-8 1085.016ms
2025-07-25 00:43:15.892 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:43:15.902 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:43:15.911 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:43:15.926 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:43:15.940 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:43:15.972 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:43:15.982 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:43:15.991 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:43:16.000 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:43:16.006 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:43:16.147 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-25 00:43:16.196 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:43:16.210 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:43:16.218 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:43:16.236 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 287.1531ms
2025-07-25 00:43:16.240 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:43:16.247 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 404 202 application/json; charset=utf-8 354.8383ms
2025-07-25 00:43:26.506 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - null null
2025-07-25 00:43:26.515 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:43:26.520 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:43:26.538 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:43:26.549 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:43:26.572 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:43:26.574 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:43:26.576 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:43:26.580 +03:00 [INF] Cache hit for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:43:26.618 +03:00 [INF] Cache hit for collection 7
2025-07-25 00:43:26.620 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:43:26.640 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 87.6636ms
2025-07-25 00:43:26.643 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:43:26.646 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive&isDeleted - 200 2243 application/json; charset=utf-8 139.4058ms
2025-07-25 00:43:42.481 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - null 0
2025-07-25 00:43:42.497 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:43:42.507 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:43:42.523 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:43:42.537 +03:00 [INF] Route matched with {action = "ActivateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActivateCollection(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:43:42.589 +03:00 [INF] Activating collection 7 by user d1f25979-3a6d-4429-8380-c159dc573444
2025-07-25 00:43:42.632 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:43:42.655 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE `c`.`Id` = `i`.`CollectionId`) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p`
    INNER JOIN `Products` AS `p0` ON `p`.`ProductId` = `p0`.`Id`
    WHERE (`c`.`Id` = `p`.`CollectionId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasProducts`
FROM `Collections` AS `c`
WHERE ((`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL) AND `c`.`IsActive`
LIMIT 1
2025-07-25 00:43:42.668 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:43:42.672 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce) in 120.7928ms
2025-07-25 00:43:42.689 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:43:42.709 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - 404 203 application/json; charset=utf-8 228.167ms
2025-07-25 00:43:53.188 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:43:53.536 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:43:53.545 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:43:53.555 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:43:53.557 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:43:53.561 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:43:53.564 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:43:53.568 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:43:53.572 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:43:53.581 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:43:53.666 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:43:53.676 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:43:53.679 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:43:53.683 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 122.1878ms
2025-07-25 00:43:53.686 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:43:53.687 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 404 202 application/json; charset=utf-8 499.2492ms
2025-07-25 00:45:53.503 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:45:53.515 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:45:53.521 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:45:53.528 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:45:53.532 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:45:53.538 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:45:53.542 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:45:53.544 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:45:53.548 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:45:53.552 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:45:53.613 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:45:53.622 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:45:53.626 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:45:53.629 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 92.3803ms
2025-07-25 00:45:53.637 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:45:53.646 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 404 202 application/json; charset=utf-8 143.0147ms
2025-07-25 00:46:03.848 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:46:03.852 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:46:03.863 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:46:03.868 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:46:03.871 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:46:03.878 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:46:03.879 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:46:03.882 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:46:03.884 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:46:03.886 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:46:04.585 +03:00 [INF] Executed DbCommand (689ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:46:04.604 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:46:04.610 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:46:04.619 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 742.6163ms
2025-07-25 00:46:04.624 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:46:04.629 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 404 202 application/json; charset=utf-8 780.7045ms
2025-07-25 00:46:56.841 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive=true&isDeleted - null null
2025-07-25 00:46:56.850 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:46:56.856 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:46:56.867 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:46:56.873 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:46:56.886 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:46:56.890 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:46:56.895 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_
2025-07-25 00:46:56.899 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_
2025-07-25 00:46:56.904 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:46:56.955 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-25 00:46:57.004 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE (`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:46:57.014 +03:00 [INF] Collection with ID 7 not found
2025-07-25 00:46:57.019 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:46:57.026 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 144.62ms
2025-07-25 00:46:57.030 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:46:57.032 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive=true&isDeleted - 404 202 application/json; charset=utf-8 191.164ms
2025-07-25 00:47:03.811 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isDeleted - null null
2025-07-25 00:47:03.816 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:47:03.821 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:47:03.826 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:47:03.828 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:47:03.835 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 00:47:03.839 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:47:03.842 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:47:03.845 +03:00 [INF] Cache hit for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 00:47:03.848 +03:00 [INF] Cache hit for collection 7
2025-07-25 00:47:03.850 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:47:03.863 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 30.3659ms
2025-07-25 00:47:03.866 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 00:47:03.869 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isDeleted - 200 2243 application/json; charset=utf-8 57.1954ms
2025-07-25 00:47:19.566 +03:00 [INF] 1 servers were removed due to timeout
2025-07-25 00:48:39.445 +03:00 [INF] DB tables already exist. Exit install
2025-07-25 00:48:41.242 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 00:48:41.257 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 00:48:41.283 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-25 00:48:41.302 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-25 00:48:41.332 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-25 00:48:41.701 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 00:48:41.772 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 00:48:41.802 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-25 00:48:42.558 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-25 00:48:42.560 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-25 00:48:42.687 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-25 00:48:42.717 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-25 00:48:42.719 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-25 00:48:42.722 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-25 00:48:42.723 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-25 00:48:42.739 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-25 00:48:42.743 +03:00 [INF] Hosting environment: Development
2025-07-25 00:48:42.755 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-25 00:48:42.809 +03:00 [INF] Server mrrobot:900:8e0b8fa3 successfully announced in 58.3834 ms
2025-07-25 00:48:42.814 +03:00 [INF] Server mrrobot:900:8e0b8fa3 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-25 00:48:42.885 +03:00 [INF] Server mrrobot:900:8e0b8fa3 all the dispatchers started
2025-07-25 00:48:43.003 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 00:48:43.173 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 169.7702ms
2025-07-25 00:48:43.284 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 00:48:43.284 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 00:48:43.284 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 00:48:43.290 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 6.911ms
2025-07-25 00:48:43.301 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 17.4707ms
2025-07-25 00:48:43.330 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 46.3818ms
2025-07-25 00:48:43.690 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 00:48:43.927 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 237.0127ms
2025-07-25 00:48:49.890 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Product/6/activate - null 0
2025-07-25 00:48:50.023 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:48:50.100 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:48:50.324 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-07-25 00:48:50.371 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-07-25 00:48:51.183 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productId_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-07-25 00:48:51.337 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:48:51.373 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 987.9365ms
2025-07-25 00:48:51.377 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-07-25 00:48:51.390 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Product/6/activate - 200 125 application/json; charset=utf-8 1499.3247ms
2025-07-25 00:49:10.515 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - null 0
2025-07-25 00:49:10.828 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:49:10.846 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:49:10.871 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:49:10.890 +03:00 [INF] Route matched with {action = "ActivateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActivateCollection(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:49:10.924 +03:00 [INF] Activating collection 7 by user d1f25979-3a6d-4429-8380-c159dc573444
2025-07-25 00:49:10.949 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:49:11.016 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE `c`.`Id` = `i`.`CollectionId`) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p`
    INNER JOIN `Products` AS `p0` ON `p`.`ProductId` = `p0`.`Id`
    WHERE (`c`.`Id` = `p`.`CollectionId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasProducts`
FROM `Collections` AS `c`
WHERE ((`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL) AND NOT (`c`.`IsActive`)
LIMIT 1
2025-07-25 00:49:11.025 +03:00 [INF] Updating collection 7 status to True
2025-07-25 00:49:11.038 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 00:49:11.085 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 00:49:11.090 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 00:49:11.158 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 00:49:11.474 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTime), @p6='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Collections` SET `CreatedAt` = @p0, `DeletedAt` = @p1, `Description` = @p2, `DisplayOrder` = @p3, `IsActive` = @p4, `ModifiedAt` = @p5, `Name` = @p6
WHERE `Id` = @p7;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-25 00:49:11.660 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-07-25 00:49:11.800 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 00:49:11.822 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce) in 924.9602ms
2025-07-25 00:49:11.843 +03:00 [INF] Removed 1 cache entries for tags: [collection, CollectionWithProduct]
2025-07-25 00:49:11.848 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.ActivateCollection (E-Commerce)'
2025-07-25 00:49:11.852 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/activate - 200 136 application/json; charset=utf-8 1336.7408ms
2025-07-25 00:49:33.233 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - null null
2025-07-25 00:49:33.242 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 00:49:33.247 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 00:49:33.257 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:49:33.269 +03:00 [INF] Route matched with {action = "GetCollectionByIdPublic", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdPublic(Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 00:49:33.277 +03:00 [INF] Executing GetCollectionByIdPublic for ID: 7
2025-07-25 00:49:33.290 +03:00 [INF] Getting collection by ID: 7
2025-07-25 00:49:33.294 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:49:33.300 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:49:33.303 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 00:49:33.382 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-25 00:49:33.457 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE ((`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 00:49:33.475 +03:00 [INF] Setting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False
2025-07-25 00:49:33.533 +03:00 [INF] Cache set successfully for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_False with tags: [collection]
2025-07-25 00:49:33.541 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 00:49:33.570 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce) in 296.1713ms
2025-07-25 00:49:33.573 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdPublic (E-Commerce)'
2025-07-25 00:49:33.575 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/public/7 - 200 2268 application/json; charset=utf-8 342.4041ms
2025-07-25 00:53:42.855 +03:00 [INF] 1 servers were removed due to timeout
2025-07-25 01:05:00.901 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 01:05:00.921 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 20.5217ms
2025-07-25 01:05:00.966 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 01:05:00.967 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 01:05:00.969 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 01:05:00.974 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 7.4414ms
2025-07-25 01:05:01.001 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 31.9724ms
2025-07-25 01:05:01.006 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 39.5295ms
2025-07-25 01:05:01.334 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 01:05:01.594 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 259.3984ms
2025-07-25 01:08:39.209 +03:00 [INF] DB tables already exist. Exit install
2025-07-25 01:08:41.650 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 01:08:41.669 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-07-25 01:08:41.703 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-07-25 01:08:41.725 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-07-25 01:08:41.781 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-25 01:08:42.286 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 01:08:42.364 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-07-25 01:08:42.408 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-07-25 01:08:43.356 +03:00 [INF] Now listening on: https://localhost:7288
2025-07-25 01:08:43.362 +03:00 [INF] Now listening on: http://localhost:5069
2025-07-25 01:08:43.501 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-07-25 01:08:43.566 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-07-25 01:08:43.567 +03:00 [INF] Using the following options for SQL Server job storage:
2025-07-25 01:08:43.569 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-07-25 01:08:43.579 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-25 01:08:43.578 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 01:08:43.614 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-25 01:08:43.619 +03:00 [INF] Hosting environment: Development
2025-07-25 01:08:43.674 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-07-25 01:08:43.698 +03:00 [INF] Server mrrobot:20244:48a4c7d1 successfully announced in 15.7531 ms
2025-07-25 01:08:43.712 +03:00 [INF] Server mrrobot:20244:48a4c7d1 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-25 01:08:43.865 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 287.9883ms
2025-07-25 01:08:43.918 +03:00 [INF] Server mrrobot:20244:48a4c7d1 all the dispatchers started
2025-07-25 01:08:43.960 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 01:08:43.962 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 01:08:43.967 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 6.1217ms
2025-07-25 01:08:43.991 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 01:08:44.030 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 68.0429ms
2025-07-25 01:08:44.051 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 59.5965ms
2025-07-25 01:08:44.285 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 01:08:44.553 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 268.331ms
2025-07-25 01:09:31.583 +03:00 [INF] Request starting HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/display-order - application/json 1
2025-07-25 01:09:31.761 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 01:09:31.841 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 01:09:31.928 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.UpdateCollectionDisplayOrder (E-Commerce)'
2025-07-25 01:09:31.966 +03:00 [INF] Route matched with {action = "UpdateCollectionDisplayOrder", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCollectionDisplayOrder(Int32, Int32) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 01:09:32.490 +03:00 [INF] Executing UpdateCollectionDisplayOrder for ID: 7, order: 4
2025-07-25 01:09:32.496 +03:00 [INF] Updating display order of collection 7 to 4
2025-07-25 01:09:32.525 +03:00 [INF] Executing GetByIdAsync for entity Collection with ID: 7
2025-07-25 01:09:32.544 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-07-25 01:09:32.595 +03:00 [INF] Updating collection 7 display order to 4
2025-07-25 01:09:32.612 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE (`c`.`Id` = @__collectionId_0) AND `c`.`DeletedAt` IS NULL
LIMIT 1
2025-07-25 01:09:32.633 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 01:09:32.639 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 01:09:32.715 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 01:09:32.890 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTime), @p6='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Collections` SET `CreatedAt` = @p0, `DeletedAt` = @p1, `Description` = @p2, `DisplayOrder` = @p3, `IsActive` = @p4, `ModifiedAt` = @p5, `Name` = @p6
WHERE `Id` = @p7;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-25 01:09:32.958 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-07-25 01:09:32.988 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-25 01:09:32.996 +03:00 [INF] Removed 1 cache entries for tags: [collection, CollectionWithProduct]
2025-07-25 01:09:33.038 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.UpdateCollectionDisplayOrder (E-Commerce) in 1057.8257ms
2025-07-25 01:09:33.068 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.UpdateCollectionDisplayOrder (E-Commerce)'
2025-07-25 01:09:33.098 +03:00 [INF] Request finished HTTP/1.1 PATCH https://localhost:7288/api/Collection/7/display-order - 200 148 application/json; charset=utf-8 1514.8312ms
2025-07-25 01:09:43.676 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isDeleted - null null
2025-07-25 01:09:43.687 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 01:09:43.705 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 01:09:43.723 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 01:09:43.734 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 01:09:43.754 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 01:09:43.760 +03:00 [INF] Getting collection by ID: 7
2025-07-25 01:09:43.764 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 01:09:43.772 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 01:09:43.775 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 01:09:43.994 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-25 01:09:44.066 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`Id` = @__collectionId_0
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
    WHERE `p1`.`IsActive` AND (`p0`.`DeletedAt` IS NULL)
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 01:09:44.088 +03:00 [INF] Setting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 01:09:44.140 +03:00 [INF] Cache set successfully for key: CollectionWithProduct_id_7_IsActive__IsDeleted_ with tags: [collection]
2025-07-25 01:09:44.147 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 01:09:44.176 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 437.3929ms
2025-07-25 01:09:44.180 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 01:09:44.183 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isDeleted - 200 1522 application/json; charset=utf-8 506.8874ms
2025-07-25 01:10:23.261 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7288/api/Collection/95454299 - application/json 111
2025-07-25 01:10:23.271 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 01:10:23.278 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 01:10:23.285 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.UpdateCollection (E-Commerce)'
2025-07-25 01:10:23.297 +03:00 [INF] Route matched with {action = "UpdateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]] UpdateCollection(Int32, E_Commerce.DtoModels.CollectionDtos.UpdateCollectionDto) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 01:10:23.347 +03:00 [INF] Executing UpdateCollection for ID: 95454299
2025-07-25 01:10:23.353 +03:00 [INF] Updating collection 95454299
2025-07-25 01:10:23.363 +03:00 [INF] Executing GetByIdAsync for entity Collection with ID: 95454299
2025-07-25 01:10:23.366 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-07-25 01:10:23.370 +03:00 [WRN] Collection with ID 95454299 not found or deleted
2025-07-25 01:10:23.383 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 01:10:23.390 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.UpdateCollection (E-Commerce) in 89.2002ms
2025-07-25 01:10:23.452 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.UpdateCollection (E-Commerce)'
2025-07-25 01:10:23.489 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7288/api/Collection/95454299 - 404 202 application/json; charset=utf-8 227.9037ms
2025-07-25 01:10:31.740 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7288/api/Collection/7 - application/json 111
2025-07-25 01:10:31.748 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 01:10:31.752 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 01:10:31.761 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.UpdateCollection (E-Commerce)'
2025-07-25 01:10:31.765 +03:00 [INF] Route matched with {action = "UpdateCollection", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto]]] UpdateCollection(Int32, E_Commerce.DtoModels.CollectionDtos.UpdateCollectionDto) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 01:10:31.777 +03:00 [INF] Executing UpdateCollection for ID: 7
2025-07-25 01:10:31.780 +03:00 [INF] Updating collection 7
2025-07-25 01:10:31.792 +03:00 [INF] Executing GetByIdAsync for entity Collection with ID: 7
2025-07-25 01:10:31.796 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-07-25 01:10:31.808 +03:00 [INF] Method System.Func`2[System.Int32,System.Threading.Tasks.Task`1[System.Boolean]] :Name aute veniam magna anim ut
2025-07-25 01:10:31.826 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Collections` AS `c`
    WHERE LOWER(`c`.`Name`) = @__ToLower_0)
2025-07-25 01:10:31.836 +03:00 [INF] Execute Update for entity Collection
2025-07-25 01:10:31.841 +03:00 [INF] Collection marked for update (pending save)
2025-07-25 01:10:31.848 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTime), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
UPDATE `Collections` SET `CreatedAt` = @p0, `DeletedAt` = @p1, `Description` = @p2, `DisplayOrder` = @p3, `IsActive` = @p4, `ModifiedAt` = @p5, `Name` = @p6
WHERE `Id` = @p7;
SELECT ROW_COUNT();
2025-07-25 01:10:31.860 +03:00 [INF] Execute AddAdminOpreationAsync
2025-07-25 01:10:31.864 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-07-25 01:10:31.870 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-07-25 01:10:31.880 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-07-25 01:10:31.894 +03:00 [INF] Removing cache by tags: [collection, CollectionWithProduct]
2025-07-25 01:10:31.901 +03:00 [INF] Executing GetByIdAsync for entity Collection with ID: 7
2025-07-25 01:10:31.903 +03:00 [INF] Removed 1 cache entries for tags: [collection, CollectionWithProduct]
2025-07-25 01:10:31.904 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Collections` AS `c`
WHERE `c`.`Id` = @__id_0
LIMIT 1
2025-07-25 01:10:31.918 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionSummaryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 01:10:31.927 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.UpdateCollection (E-Commerce) in 151.8851ms
2025-07-25 01:10:31.932 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.UpdateCollection (E-Commerce)'
2025-07-25 01:10:31.934 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7288/api/Collection/7 - 200 382 application/json; charset=utf-8 193.7989ms
2025-07-25 01:10:57.771 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isDeleted - null null
2025-07-25 01:10:57.791 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 01:10:57.798 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 01:10:57.808 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 01:10:57.814 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 01:10:57.820 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 01:10:57.822 +03:00 [INF] Getting collection by ID: 7
2025-07-25 01:10:57.823 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 01:10:57.830 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 01:10:57.832 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 01:10:57.909 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[@__collectionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Id2`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE `c`.`Id` = @__collectionId_0
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`ProductId`, `p0`.`CollectionId`, `p1`.`Id` AS `Id0`, `d`.`Id` AS `Id1`, `t1`.`Id` AS `Id2`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
    WHERE `p1`.`IsActive` AND (`p0`.`DeletedAt` IS NULL)
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id0`, `t0`.`Id1`
2025-07-25 01:10:57.927 +03:00 [INF] Setting cache for key: CollectionWithProduct_id_7_IsActive__IsDeleted_
2025-07-25 01:10:57.932 +03:00 [INF] Cache set successfully for key: CollectionWithProduct_id_7_IsActive__IsDeleted_ with tags: [collection]
2025-07-25 01:10:57.935 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 01:10:57.940 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 120.2311ms
2025-07-25 01:10:57.943 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 01:10:57.958 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isDeleted - 200 1541 application/json; charset=utf-8 186.8559ms
2025-07-25 01:11:51.649 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2025-07-25 01:11:51.672 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 22.4485ms
2025-07-25 01:11:51.743 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.js - null null
2025-07-25 01:11:51.750 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2025-07-25 01:11:51.751 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.js - 200 null application/javascript;charset=utf-8 8.7082ms
2025-07-25 01:11:51.802 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 51.5434ms
2025-07-25 01:11:51.867 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2025-07-25 01:11:51.876 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.5498ms
2025-07-25 01:11:52.786 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2025-07-25 01:11:53.139 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 353.3641ms
2025-07-25 01:12:01.364 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive=true&isDeleted - null null
2025-07-25 01:12:01.371 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-07-25 01:12:01.377 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-07-25 01:12:01.383 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 01:12:01.391 +03:00 [INF] Route matched with {action = "GetCollectionByIdAdmin", controller = "Collection"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CollectionDtos.CollectionDto]]] GetCollectionByIdAdmin(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.CollectionController (E-Commerce).
2025-07-25 01:12:01.407 +03:00 [INF] Executing GetCollectionByIdAdmin for ID: 7
2025-07-25 01:12:01.409 +03:00 [INF] Getting collection by ID: 7
2025-07-25 01:12:01.412 +03:00 [INF] Getting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_
2025-07-25 01:12:01.417 +03:00 [WRN] Cache miss for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_
2025-07-25 01:12:01.420 +03:00 [INF] Execute GetAll for entity Collection
2025-07-25 01:12:01.481 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-25 01:12:01.571 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__collectionId_0='?' (DbType = Int32), @__IsActive_Value_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`Description`, `t`.`DisplayOrder`, `t`.`Id`, `t`.`IsActive`, `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `t`.`Name`, `t`.`c`, `t0`.`ProductId`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`c`, `t0`.`fitType`, `t0`.`CollectionId`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`, `t0`.`Url`, `t0`.`c0`, `t0`.`c1`, `t0`.`c2`, `t0`.`IsActive`
FROM (
    SELECT `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`Id`, `c`.`IsActive`, `c`.`Name`, (
        SELECT COUNT(*)
        FROM `ProductCollections` AS `p`
        WHERE `c`.`Id` = `p`.`CollectionId`) AS `c`
    FROM `Collections` AS `c`
    WHERE (`c`.`Id` = @__collectionId_0) AND (`c`.`IsActive` = @__IsActive_Value_1)
    LIMIT 1
) AS `t`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`CollectionId`
LEFT JOIN (
    SELECT `p0`.`ProductId`, `p1`.`Name`, `p1`.`Description`, `p1`.`Quantity`, `p1`.`Gender`, `p1`.`SubCategoryId`, `p1`.`Price`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p1`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p1`.`Price`))
        ELSE `p1`.`Price`
    END AS `c`, `p1`.`fitType`, `p0`.`CollectionId`, `p1`.`Id`, `d`.`Id` AS `Id0`, `t1`.`Id` AS `Id1`, `t1`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p1`.`IsActive`
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p1`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t1` ON `p1`.`Id` = `t1`.`ProductId`
    WHERE `p1`.`IsActive` AND (`p0`.`DeletedAt` IS NULL)
) AS `t0` ON `t`.`Id` = `t0`.`CollectionId`
ORDER BY `t`.`Id`, `i`.`Id`, `t0`.`ProductId`, `t0`.`CollectionId`, `t0`.`Id`, `t0`.`Id0`
2025-07-25 01:12:01.584 +03:00 [INF] Setting cache for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_
2025-07-25 01:12:01.620 +03:00 [INF] Cache set successfully for key: CollectionWithProduct_id_7_IsActive_True_IsDeleted_ with tags: [collection]
2025-07-25 01:12:01.624 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CollectionDtos.CollectionDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-25 01:12:01.626 +03:00 [INF] Executed action E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce) in 229.4851ms
2025-07-25 01:12:01.629 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CollectionController.GetCollectionByIdAdmin (E-Commerce)'
2025-07-25 01:12:01.667 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/Collection/admin/7?isActive=true&isDeleted - 200 1541 application/json; charset=utf-8 302.9208ms
2025-07-25 01:13:43.735 +03:00 [INF] 1 servers were removed due to timeout
2025-07-25 03:00:16.869 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`ImageId`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Categories` AS `c`
WHERE `c`.`DeletedAt` IS NOT NULL
