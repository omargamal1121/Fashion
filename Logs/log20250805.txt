2025-08-05 04:22:27.098 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 04:22:29.051 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 04:22:29.065 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 04:22:29.139 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 04:22:29.161 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 04:22:29.206 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 04:22:29.554 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 04:22:29.622 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 04:22:29.690 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 04:24:14.574 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 04:24:15.998 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 04:24:16.012 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 04:24:16.033 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 04:24:16.050 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 04:24:16.076 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 04:24:16.368 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 04:24:16.428 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 04:24:16.449 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 04:24:16.928 +03:00 [INF] Creating key {fe1208af-f7c3-44b3-87bc-64c6618b7f47} with creation date 2025-08-05 01:24:16Z, activation date 2025-08-07 21:48:06Z, and expiration date 2025-11-03 01:24:16Z.
2025-08-05 04:24:16.944 +03:00 [INF] Writing data to file 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys\key-fe1208af-f7c3-44b3-87bc-64c6618b7f47.xml'.
2025-08-05 04:24:17.111 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 04:24:17.214 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 04:24:17.234 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 04:24:17.236 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 04:24:17.238 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 04:24:17.240 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 04:24:17.257 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 04:24:17.260 +03:00 [INF] Hosting environment: Development
2025-08-05 04:24:17.263 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 04:24:17.302 +03:00 [INF] Server mrrobot:10748:75c0f51a successfully announced in 17.9607 ms
2025-08-05 04:24:17.311 +03:00 [INF] Server mrrobot:10748:75c0f51a is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 04:24:17.319 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 04:24:17.511 +03:00 [INF] Server mrrobot:10748:75c0f51a all the dispatchers started
2025-08-05 04:24:19.049 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 04:24:19.641 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 592.9365ms
2025-08-05 04:24:19.688 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 04:24:19.690 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 04:24:19.695 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 04:24:19.703 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 14.7487ms
2025-08-05 04:24:19.720 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 29.9242ms
2025-08-05 04:24:19.900 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 205.073ms
2025-08-05 04:24:19.990 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 04:24:20.210 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 220.4726ms
2025-08-05 04:24:27.538 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`Description`, `c`.`DisplayOrder`, `c`.`ImageId`, `c`.`IsActive`, `c`.`ModifiedAt`, `c`.`Name`
FROM `Categories` AS `c`
WHERE `c`.`DeletedAt` IS NOT NULL
2025-08-05 15:12:16.292 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 15:12:18.196 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:12:18.216 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:12:18.281 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 15:12:18.309 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 15:12:18.360 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 15:12:18.837 +03:00 [INF] Executed DbCommand (93ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:12:18.928 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:12:18.999 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:12:19.803 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 15:12:19.911 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 15:12:19.975 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 15:12:19.980 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 15:12:19.983 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 15:12:19.984 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 15:12:20.026 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 15:12:20.039 +03:00 [INF] Hosting environment: Development
2025-08-05 15:12:20.044 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 15:12:20.061 +03:00 [INF] Server mrrobot:4572:729caeeb successfully announced in 23.6411 ms
2025-08-05 15:12:20.116 +03:00 [INF] Server mrrobot:4572:729caeeb is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 15:12:20.136 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 15:12:20.281 +03:00 [INF] Server mrrobot:4572:729caeeb all the dispatchers started
2025-08-05 15:12:25.382 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:12:25.788 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 405.1737ms
2025-08-05 15:12:25.819 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:12:25.819 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:12:25.860 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:12:25.881 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 61.3185ms
2025-08-05 15:12:25.908 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 89.1737ms
2025-08-05 15:12:26.034 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 173.8151ms
2025-08-05 15:12:26.202 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:12:26.582 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 380.4979ms
2025-08-05 15:12:28.240 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:12:28.571 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 331.0539ms
2025-08-05 15:12:28.801 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/favicon.ico - null null
2025-08-05 15:12:28.811 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 15:12:28.909 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:12:28.922 +03:00 [INF] No cached response available for this request.
2025-08-05 15:12:28.929 +03:00 [INF] The response could not be cached for this request.
2025-08-05 15:12:28.932 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/favicon.ico - 404 0 null 131.1322ms
2025-08-05 15:12:28.942 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5069/favicon.ico, Response status code: 404
2025-08-05 15:15:41.643 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 15:15:43.465 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:15:43.498 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:15:43.524 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 15:15:43.546 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 15:15:43.580 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 15:15:44.055 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:15:44.124 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:15:44.233 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:15:45.377 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 15:15:45.498 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 15:15:45.525 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 15:15:45.532 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 15:15:45.541 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 15:15:45.634 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 15:15:45.665 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 15:15:45.740 +03:00 [INF] Hosting environment: Development
2025-08-05 15:15:45.752 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 15:15:45.754 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:15:45.809 +03:00 [INF] Server mrrobot:3148:fa73a68a successfully announced in 138.1751 ms
2025-08-05 15:15:45.818 +03:00 [INF] Server mrrobot:3148:fa73a68a is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 15:15:45.946 +03:00 [INF] Server mrrobot:3148:fa73a68a all the dispatchers started
2025-08-05 15:15:46.050 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 293.2196ms
2025-08-05 15:15:46.112 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:15:46.125 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:15:46.137 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:15:46.143 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 17.681ms
2025-08-05 15:15:46.148 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 11.3653ms
2025-08-05 15:15:46.213 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 100.4981ms
2025-08-05 15:15:46.491 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:15:46.760 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 268.7459ms
2025-08-05 15:19:37.782 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:19:37.838 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 56.3534ms
2025-08-05 15:19:37.870 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:19:37.870 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:19:37.875 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:19:37.889 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 19.5393ms
2025-08-05 15:19:37.894 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 24.547ms
2025-08-05 15:19:37.912 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 36.9089ms
2025-08-05 15:19:38.228 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:19:38.521 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 292.6991ms
2025-08-05 15:19:43.899 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:19:44.081 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 182.0498ms
2025-08-05 15:20:45.838 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 15:22:30.411 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:22:30.433 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 21.7358ms
2025-08-05 15:22:31.279 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:22:31.284 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 5.7145ms
2025-08-05 15:22:31.302 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:22:31.316 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:22:31.319 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 17.0527ms
2025-08-05 15:22:31.328 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.3609ms
2025-08-05 15:22:40.885 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 15:22:42.961 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:22:43.037 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:22:43.082 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 15:22:43.103 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 15:22:43.142 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 15:22:43.597 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:22:43.676 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:22:43.701 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:22:44.353 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 15:22:44.473 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 15:22:44.680 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 15:22:44.682 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 15:22:44.684 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 15:22:44.685 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 15:22:44.699 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 15:22:44.705 +03:00 [INF] Hosting environment: Development
2025-08-05 15:22:44.710 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 15:22:44.720 +03:00 [INF] Server mrrobot:12748:a6bd78f3 successfully announced in 15.8994 ms
2025-08-05 15:22:44.730 +03:00 [INF] Server mrrobot:12748:a6bd78f3 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 15:22:44.943 +03:00 [INF] Server mrrobot:12748:a6bd78f3 all the dispatchers started
2025-08-05 15:22:46.054 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:22:46.254 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 200.9325ms
2025-08-05 15:22:46.811 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:22:46.818 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 7.3458ms
2025-08-05 15:22:46.894 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:22:46.935 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 40.307ms
2025-08-05 15:22:47.147 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:22:47.153 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.0202ms
2025-08-05 15:22:50.223 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:22:50.624 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 400.7936ms
2025-08-05 15:23:05.264 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:23:05.710 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 446.7617ms
2025-08-05 15:25:19.719 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/subcategories - multipart/form-data; boundary=--------------------------024246649966918147470733 474
2025-08-05 15:25:19.728 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 15:25:22.979 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-08-05 15:25:22.995 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-08-05 15:25:23.001 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:25:23.035 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-05 15:25:23.052 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-05 15:25:23.108 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/subcategories - 401 0 null 3388.7448ms
2025-08-05 15:25:34.906 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/subcategories/search?key=string&isActive=true&includeDeleted=true&page=1&pageSize=10 - null null
2025-08-05 15:25:34.978 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-08-05 15:25:34.995 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-08-05 15:25:35.000 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:25:35.016 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:25:35.073 +03:00 [INF] Route matched with {action = "Search", controller = "SubCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto]]]] Search(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.SubCategoryController (E-Commerce).
2025-08-05 15:25:35.596 +03:00 [INF] Executing Search with key=string, isActive=True, includeDeleted=False, page=1, pageSize=10
2025-08-05 15:25:35.602 +03:00 [INF] Executing FilterAsync with filters
2025-08-05 15:25:35.607 +03:00 [INF] Getting cache for key: subcategory_filtered_True_False_p1_ps10_string
2025-08-05 15:25:35.623 +03:00 [WRN] Cache miss for key: subcategory_filtered_True_False_p1_ps10_string
2025-08-05 15:25:35.632 +03:00 [INF] Execute GetAll for entity SubCategory
2025-08-05 15:25:36.040 +03:00 [INF] Executed DbCommand (195ms) [Parameters=[@__Format_1='?' (Size = 4000), @__Format_1_1='?' (Size = 50), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`IsActive`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`Description`, `t0`.`Id`, `t0`.`Url`
FROM (
    SELECT `s`.`Id`, `s`.`Name`, `s`.`IsActive`, `s`.`CreatedAt`, `s`.`ModifiedAt`, `s`.`DeletedAt`, `s`.`Description`
    FROM `SubCategories` AS `s`
    WHERE (((`s`.`Name` LIKE @__Format_1) OR (`s`.`Description` LIKE @__Format_1_1)) AND `s`.`IsActive`) AND `s`.`DeletedAt` IS NULL
    ORDER BY `s`.`Id`
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`SubCategoryId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`SubCategoryId`
ORDER BY `t`.`Id`
2025-08-05 15:25:36.100 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:25:36.147 +03:00 [INF] Executed action E_Commerce.Controllers.SubCategoryController.Search (E-Commerce) in 1061.8294ms
2025-08-05 15:25:36.150 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:25:36.156 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/subcategories/search?key=string&isActive=true&includeDeleted=true&page=1&pageSize=10 - 404 285 application/json; charset=utf-8 1250.2715ms
2025-08-05 15:26:26.263 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/login - application/json 70
2025-08-05 15:26:26.281 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-08-05 15:26:26.287 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-08-05 15:26:26.290 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:26:26.294 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-05 15:26:26.306 +03:00 [INF] Route matched with {action = "LoginAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.TokenDtos.TokensDto]]] LoginAsync(E_Commerce.DtoModels.AccountDtos.LoginDTo) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-08-05 15:26:26.481 +03:00 [INF] In LoginAsync Method 
2025-08-05 15:26:26.494 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:26:26.664 +03:00 [INF] 🔐 Generating Access Token for User ID: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 15:26:26.722 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-08-05 15:26:26.782 +03:00 [INF] ✅ Access Token generated successfully for User ID: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 15:26:26.785 +03:00 [INF] 🔑 Generating Refresh Token for User ID: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 15:26:26.793 +03:00 [INF] RefreshToken Generated
2025-08-05 15:26:26.800 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.TokenDtos.TokensDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 15:26:26.811 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce) in 500.5617ms
2025-08-05 15:26:26.816 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-05 15:26:26.819 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/login - 200 1403 application/json; charset=utf-8 555.1493ms
2025-08-05 15:26:55.443 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/subcategories/search?key=string&isActive=true&includeDeleted=true&page=1&pageSize=10 - null null
2025-08-05 15:26:55.474 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-08-05 15:26:55.483 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-08-05 15:26:55.487 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:26:55.489 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:26:55.492 +03:00 [INF] Route matched with {action = "Search", controller = "SubCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto]]]] Search(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.SubCategoryController (E-Commerce).
2025-08-05 15:26:55.501 +03:00 [INF] Executing Search with key=string, isActive=True, includeDeleted=False, page=1, pageSize=10
2025-08-05 15:26:55.504 +03:00 [INF] Executing FilterAsync with filters
2025-08-05 15:26:55.506 +03:00 [INF] Getting cache for key: subcategory_filtered_True_False_p1_ps10_string
2025-08-05 15:26:55.509 +03:00 [WRN] Cache miss for key: subcategory_filtered_True_False_p1_ps10_string
2025-08-05 15:26:55.511 +03:00 [INF] Execute GetAll for entity SubCategory
2025-08-05 15:26:55.569 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__Format_1='?' (Size = 4000), @__Format_1_1='?' (Size = 50), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`IsActive`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`Description`, `t0`.`Id`, `t0`.`Url`
FROM (
    SELECT `s`.`Id`, `s`.`Name`, `s`.`IsActive`, `s`.`CreatedAt`, `s`.`ModifiedAt`, `s`.`DeletedAt`, `s`.`Description`
    FROM `SubCategories` AS `s`
    WHERE (((`s`.`Name` LIKE @__Format_1) OR (`s`.`Description` LIKE @__Format_1_1)) AND `s`.`IsActive`) AND `s`.`DeletedAt` IS NULL
    ORDER BY `s`.`Id`
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`SubCategoryId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`SubCategoryId`
ORDER BY `t`.`Id`
2025-08-05 15:26:55.574 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:26:55.582 +03:00 [INF] Executed action E_Commerce.Controllers.SubCategoryController.Search (E-Commerce) in 84.3855ms
2025-08-05 15:26:55.585 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:26:55.588 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/subcategories/search?key=string&isActive=true&includeDeleted=true&page=1&pageSize=10 - 404 285 application/json; charset=utf-8 144.7641ms
2025-08-05 15:27:02.603 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/subcategories/search?key=string&page=1&pageSize=10 - null null
2025-08-05 15:27:02.610 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-08-05 15:27:02.616 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-08-05 15:27:02.619 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:27:02.621 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:27:02.625 +03:00 [INF] Route matched with {action = "Search", controller = "SubCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto]]]] Search(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.SubCategoryController (E-Commerce).
2025-08-05 15:27:02.651 +03:00 [INF] Executing Search with key=string, isActive=True, includeDeleted=False, page=1, pageSize=10
2025-08-05 15:27:02.653 +03:00 [INF] Executing FilterAsync with filters
2025-08-05 15:27:02.655 +03:00 [INF] Getting cache for key: subcategory_filtered_True_False_p1_ps10_string
2025-08-05 15:27:02.659 +03:00 [WRN] Cache miss for key: subcategory_filtered_True_False_p1_ps10_string
2025-08-05 15:27:02.661 +03:00 [INF] Execute GetAll for entity SubCategory
2025-08-05 15:27:02.706 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__Format_1='?' (Size = 4000), @__Format_1_1='?' (Size = 50), @__p_3='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`IsActive`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`Description`, `t0`.`Id`, `t0`.`Url`
FROM (
    SELECT `s`.`Id`, `s`.`Name`, `s`.`IsActive`, `s`.`CreatedAt`, `s`.`ModifiedAt`, `s`.`DeletedAt`, `s`.`Description`
    FROM `SubCategories` AS `s`
    WHERE (((`s`.`Name` LIKE @__Format_1) OR (`s`.`Description` LIKE @__Format_1_1)) AND `s`.`IsActive`) AND `s`.`DeletedAt` IS NULL
    ORDER BY `s`.`Id`
    LIMIT @__p_3 OFFSET @__p_2
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`SubCategoryId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`SubCategoryId`
ORDER BY `t`.`Id`
2025-08-05 15:27:02.715 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:27:02.718 +03:00 [INF] Executed action E_Commerce.Controllers.SubCategoryController.Search (E-Commerce) in 87.7996ms
2025-08-05 15:27:02.720 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:27:02.723 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/subcategories/search?key=string&page=1&pageSize=10 - 404 285 application/json; charset=utf-8 119.6279ms
2025-08-05 15:27:24.643 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/subcategories/search?page=1&pageSize=10 - null null
2025-08-05 15:27:24.648 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-08-05 15:27:24.653 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-08-05 15:27:24.655 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:27:24.659 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:27:24.661 +03:00 [INF] Route matched with {action = "Search", controller = "SubCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto]]]] Search(System.String, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean], Int32, Int32) on controller E_Commerce.Controllers.SubCategoryController (E-Commerce).
2025-08-05 15:27:24.669 +03:00 [INF] Executing Search with key=, isActive=True, includeDeleted=False, page=1, pageSize=10
2025-08-05 15:27:24.671 +03:00 [INF] Executing FilterAsync with filters
2025-08-05 15:27:24.673 +03:00 [INF] Getting cache for key: subcategory_filtered_True_False_p1_ps10_
2025-08-05 15:27:24.676 +03:00 [WRN] Cache miss for key: subcategory_filtered_True_False_p1_ps10_
2025-08-05 15:27:24.679 +03:00 [INF] Execute GetAll for entity SubCategory
2025-08-05 15:27:24.740 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`IsActive`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`Description`, `t0`.`Id`, `t0`.`Url`
FROM (
    SELECT `s`.`Id`, `s`.`Name`, `s`.`IsActive`, `s`.`CreatedAt`, `s`.`ModifiedAt`, `s`.`DeletedAt`, `s`.`Description`
    FROM `SubCategories` AS `s`
    WHERE `s`.`IsActive` AND (`s`.`DeletedAt` IS NULL)
    ORDER BY `s`.`Id`
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`SubCategoryId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`SubCategoryId`
ORDER BY `t`.`Id`
2025-08-05 15:27:24.893 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:27:24.901 +03:00 [INF] Executed action E_Commerce.Controllers.SubCategoryController.Search (E-Commerce) in 236.3954ms
2025-08-05 15:27:24.904 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.SubCategoryController.Search (E-Commerce)'
2025-08-05 15:27:24.908 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/subcategories/search?page=1&pageSize=10 - 200 518 application/json; charset=utf-8 264.9472ms
2025-08-05 15:27:25.429 +03:00 [INF] Setting cache for key: subcategory_filtered_True_False_p1_ps10_
2025-08-05 15:27:25.475 +03:00 [INF] Cache set successfully for key: subcategory_filtered_True_False_p1_ps10_ with tags: [subcategorydata]
2025-08-05 15:27:44.811 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 15:28:20.684 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/subcategories - multipart/form-data; boundary=--------------------------598291096014097607000975 402
2025-08-05 15:28:20.687 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-08-05 15:28:20.693 +03:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-08-05 15:28:20.700 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:28:20.704 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-05 15:28:20.707 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-05 15:28:20.714 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/subcategories - 401 0 null 30.4052ms
2025-08-05 15:28:49.163 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/subcategories - multipart/form-data; boundary=--------------------------768457053340529893931186 402
2025-08-05 15:28:49.221 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:28:49.261 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:28:49.273 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.SubCategoryController.Create (E-Commerce)'
2025-08-05 15:28:49.284 +03:00 [INF] Route matched with {action = "Create", controller = "SubCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto]]] Create(E_Commerce.DtoModels.SubCategorydto.CreateSubCategoryDto) on controller E_Commerce.Controllers.SubCategoryController (E-Commerce).
2025-08-05 15:28:49.314 +03:00 [INF] Executing Create
2025-08-05 15:28:49.321 +03:00 [INF] Execute CreateAsync
2025-08-05 15:28:49.337 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Categories` AS `c`
    WHERE (`c`.`Id` = @__id_0) AND `c`.`DeletedAt` IS NULL)
2025-08-05 15:28:49.351 +03:00 [INF] Executing IsExsistByNameAsync for name: sdffas
2025-08-05 15:28:49.358 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__name_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `SubCategories` AS `s`
    WHERE `s`.`Name` = @__name_0)
2025-08-05 15:28:49.368 +03:00 [INF] Category with name: sdffas does not exist
2025-08-05 15:28:49.394 +03:00 [INF] Executing CreateAsync for entity SubCategory
2025-08-05 15:28:49.495 +03:00 [INF] SubCategory added successfully (pending save)
2025-08-05 15:28:49.648 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (Size = 50), @p4='?' (DbType = Int32), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `SubCategories` (`CategoryId`, `CreatedAt`, `DeletedAt`, `Description`, `ImageId`, `IsActive`, `ModifiedAt`, `Name`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT `Id`
FROM `SubCategories`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 15:28:49.703 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 15:28:49.707 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 15:28:49.744 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 15:28:49.790 +03:00 [INF] Successfully mapped subcategory to DTO
2025-08-05 15:28:49.797 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.SubCategorydto.SubCategoryDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 15:28:49.807 +03:00 [INF] Executed action E_Commerce.Controllers.SubCategoryController.Create (E-Commerce) in 516.9674ms
2025-08-05 15:28:49.810 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.SubCategoryController.Create (E-Commerce)'
2025-08-05 15:28:49.817 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/subcategories - 201 348 application/json; charset=utf-8 653.5096ms
2025-08-05 15:28:55.440 +03:00 [INF] Removing cache by tags: [subcategorydata, categorywithdata, subcategory]
2025-08-05 15:28:55.483 +03:00 [INF] Removed 3 cache entries for tags: [subcategorydata, categorywithdata, subcategory]
2025-08-05 15:30:10.132 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/register - application/json 205
2025-08-05 15:30:10.143 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:30:10.149 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:30:10.155 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.RegisterAsync (E-Commerce)'
2025-08-05 15:30:10.164 +03:00 [INF] Route matched with {action = "RegisterAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.AccountDtos.RegisterResponse]]] RegisterAsync(E_Commerce.DtoModels.AccountDtos.RegisterDto) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-08-05 15:30:10.190 +03:00 [INF] In RegisterAsync Method 
2025-08-05 15:30:10.197 +03:00 [INF] Executing RegisterAsync for email: og4381146@gmail.com
2025-08-05 15:30:10.216 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:30:10.382 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-08-05 15:30:10.392 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:30:10.475 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 13), @p7='?' (Size = 256), @p8='?' (DbType = Boolean), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (Size = 4000), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET AUTOCOMMIT = 1;
INSERT INTO `AspNetUsers` (`Id`, `AccessFailedCount`, `Age`, `ConcurrencyStamp`, `CreateAt`, `DeletedAt`, `Discriminator`, `Email`, `EmailConfirmed`, `ImageId`, `LastVisit`, `LockoutEnabled`, `LockoutEnd`, `Name`, `NormalizedEmail`, `NormalizedUserName`, `PasswordHash`, `PhoneNumber`, `PhoneNumberConfirmed`, `ProfilePicture`, `SecurityStamp`, `TwoFactorEnabled`, `UserName`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-08-05 15:30:10.504 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-08-05 15:30:10.531 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255), @__p_1='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`UserId`, `a`.`RoleId`
FROM `AspNetUserRoles` AS `a`
WHERE (`a`.`UserId` = @__p_0) AND (`a`.`RoleId` = @__p_1)
LIMIT 1
2025-08-05 15:30:10.543 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedRoleName_0
LIMIT 2
2025-08-05 15:30:10.572 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedUserName` = @__normalizedUserName_0)
LIMIT 1
2025-08-05 15:30:10.578 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:30:10.622 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (Size = 255), @p23='?' (Size = 255), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p24='?' (Size = 4000), @p5='?' (DbType = DateTime), @p6='?' (DbType = DateTime), @p7='?' (Size = 256), @p8='?' (DbType = Boolean), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 4000), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (Size = 4000), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserRoles` (`RoleId`, `UserId`)
VALUES (@p0, @p1);
UPDATE `AspNetUsers` SET `AccessFailedCount` = @p2, `Age` = @p3, `ConcurrencyStamp` = @p4, `CreateAt` = @p5, `DeletedAt` = @p6, `Email` = @p7, `EmailConfirmed` = @p8, `ImageId` = @p9, `LastVisit` = @p10, `LockoutEnabled` = @p11, `LockoutEnd` = @p12, `Name` = @p13, `NormalizedEmail` = @p14, `NormalizedUserName` = @p15, `PasswordHash` = @p16, `PhoneNumber` = @p17, `PhoneNumberConfirmed` = @p18, `ProfilePicture` = @p19, `SecurityStamp` = @p20, `TwoFactorEnabled` = @p21, `UserName` = @p22
WHERE `Id` = @p23 AND `ConcurrencyStamp` = @p24;
SELECT ROW_COUNT();
2025-08-05 15:30:10.634 +03:00 [INF] User registered successfully.
2025-08-05 15:30:10.703 +03:00 [INF] Executing CreatedResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.AccountDtos.RegisterResponse, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 15:30:10.712 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.RegisterAsync (E-Commerce) in 541.5762ms
2025-08-05 15:30:10.714 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.RegisterAsync (E-Commerce)'
2025-08-05 15:30:10.717 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/register - 201 723 application/json; charset=utf-8 585.2073ms
2025-08-05 15:30:18.051 +03:00 [INF] Welcome email sent successfully to og4381146@gmail.com
2025-08-05 15:30:18.738 +03:00 [INF] Validation email sent successfully to og4381146@gmail.com
2025-08-05 15:30:42.096 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/login - application/json 66
2025-08-05 15:30:42.102 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:30:42.108 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:30:42.115 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-05 15:30:42.117 +03:00 [INF] Route matched with {action = "LoginAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.TokenDtos.TokensDto]]] LoginAsync(E_Commerce.DtoModels.AccountDtos.LoginDTo) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-08-05 15:30:42.153 +03:00 [INF] In LoginAsync Method 
2025-08-05 15:30:42.157 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:30:42.272 +03:00 [INF] 🔐 Generating Access Token for User ID: 0a387eaa-bb75-4ab3-a8b4-24f00c4066b2
2025-08-05 15:30:42.276 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-08-05 15:30:42.280 +03:00 [INF] ✅ Access Token generated successfully for User ID: 0a387eaa-bb75-4ab3-a8b4-24f00c4066b2
2025-08-05 15:30:42.283 +03:00 [INF] 🔑 Generating Refresh Token for User ID: 0a387eaa-bb75-4ab3-a8b4-24f00c4066b2
2025-08-05 15:30:42.286 +03:00 [INF] RefreshToken Generated
2025-08-05 15:30:42.288 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.TokenDtos.TokensDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 15:30:42.291 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce) in 159.8305ms
2025-08-05 15:30:42.294 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-05 15:30:42.296 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/login - 200 1402 application/json; charset=utf-8 199.4313ms
2025-08-05 15:31:07.630 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/subcategories - multipart/form-data; boundary=--------------------------585617580285667731448184 402
2025-08-05 15:31:07.639 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:31:07.645 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:31:07.655 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-05 15:31:07.667 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-05 15:31:07.673 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/subcategories - 403 0 null 42.7032ms
2025-08-05 15:31:49.902 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/subcategories/1?isActive=true&isDeleted=true - null null
2025-08-05 15:31:49.908 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:31:49.915 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:31:49.922 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.SubCategoryController.GetById (E-Commerce)'
2025-08-05 15:31:49.931 +03:00 [INF] Route matched with {action = "GetById", controller = "SubCategory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.SubCategorydto.SubCategoryDtoWithData]]] GetById(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.SubCategoryController (E-Commerce).
2025-08-05 15:31:49.944 +03:00 [INF] Executing GetById for id: 1
2025-08-05 15:31:49.952 +03:00 [INF] Execute: GetSubCategoryByIdAsync in services for id: 1, isActive: True, isDeleted: False
2025-08-05 15:31:49.958 +03:00 [INF] Getting cache for key: subcategorydataid:1_active:True_deleted:False
2025-08-05 15:31:49.961 +03:00 [WRN] Cache miss for key: subcategorydataid:1_active:True_deleted:False
2025-08-05 15:31:49.964 +03:00 [INF] Executing privateGetSubCategoryByIdAsync for id: 1
2025-08-05 15:31:49.965 +03:00 [INF] Execute GetAll for entity SubCategory
2025-08-05 15:31:50.091 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-05 15:31:50.213 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`IsActive`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`Description`, `t0`.`Id`, `t0`.`IsMain`, `t0`.`Url`, `t1`.`Id`, `t1`.`Name`, `t1`.`Description`, `t1`.`Quantity`, `t1`.`Gender`, `t1`.`SubCategoryId`, `t1`.`Price`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`DeletedAt`, `t1`.`c`, `t1`.`fitType`, `t1`.`Id0`, `t1`.`Id1`, `t1`.`Url`, `t1`.`c0`, `t1`.`c1`, `t1`.`c2`, `t1`.`IsActive`
FROM (
    SELECT `s`.`Id`, `s`.`Name`, `s`.`IsActive`, `s`.`CreatedAt`, `s`.`ModifiedAt`, `s`.`DeletedAt`, `s`.`Description`
    FROM `SubCategories` AS `s`
    WHERE ((`s`.`Id` = @__id_0) AND `s`.`IsActive`) AND `s`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`IsMain`, `i`.`Url`, `i`.`SubCategoryId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`SubCategoryId`
LEFT JOIN (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`SubCategoryId`, `p`.`Price`, `p`.`CreatedAt`, `p`.`ModifiedAt`, `p`.`DeletedAt`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`fitType`, `d`.`Id` AS `Id0`, `t2`.`Id` AS `Id1`, `t2`.`Url`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP())) AND `d`.`IsActive` THEN `d`.`EndDate`
        ELSE NULL
    END AS `c0`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `c1`, CASE
        WHEN (`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `c2`, `p`.`IsActive`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN (
        SELECT `i0`.`Id`, `i0`.`Url`, `i0`.`ProductId`
        FROM `Images` AS `i0`
        WHERE `i0`.`DeletedAt` IS NULL
    ) AS `t2` ON `p`.`Id` = `t2`.`ProductId`
    WHERE `p`.`IsActive` AND (`p`.`DeletedAt` IS NULL)
) AS `t1` ON `t`.`Id` = `t1`.`SubCategoryId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t1`.`Id`, `t1`.`Id0`
2025-08-05 15:31:50.367 +03:00 [INF] Category with id: 1 exists
2025-08-05 15:31:50.413 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.SubCategorydto.SubCategoryDtoWithData, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 15:31:50.429 +03:00 [INF] Executed action E_Commerce.Controllers.SubCategoryController.GetById (E-Commerce) in 488.9274ms
2025-08-05 15:31:50.431 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.SubCategoryController.GetById (E-Commerce)'
2025-08-05 15:31:50.433 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/subcategories/1?isActive=true&isDeleted=true - 200 1610 application/json; charset=utf-8 531.9263ms
2025-08-05 15:31:55.700 +03:00 [INF] Setting cache for key: subcategorydataid:1_active:True_deleted:False
2025-08-05 15:31:55.737 +03:00 [INF] Cache set successfully for key: subcategorydataid:1_active:True_deleted:False with tags: [subcategorydata]
2025-08-05 15:33:15.043 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5069/api/subcategories/1 - null null
2025-08-05 15:33:15.057 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:33:15.070 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:33:15.080 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-05 15:33:15.085 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-05 15:33:15.093 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5069/api/subcategories/1 - 403 0 null 50.0329ms
2025-08-05 15:33:33.359 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 15:33:33.370 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:33:33.377 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:33:33.386 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:33:33.395 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 15:33:33.439 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 15:33:33.444 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 15:33:33.449 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 15:33:33.515 +03:00 [ERR] Error in GetBestSellersAsync
System.InvalidOperationException: The LINQ expression 'i => i.DeletedAt == null' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberAssignment(MemberAssignment memberAssignment)
   at System.Linq.Expressions.ExpressionVisitor.VisitMemberBinding(MemberBinding node)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberInit(MemberInitExpression memberInitExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Translate(SelectExpression selectExpression, Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateSelect(ShapedQueryExpression source, LambdaExpression selector)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellersAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly) in D:\project_fashion\E-Commerce-API-main\Services\ProductServices\ProductSearchService.cs:line 202
2025-08-05 15:33:33.606 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:33:33.613 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 209.6206ms
2025-08-05 15:33:33.619 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:33:33.622 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 500 220 application/json; charset=utf-8 263.6017ms
2025-08-05 15:36:34.901 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:36:34.933 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 32.6421ms
2025-08-05 15:36:35.071 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:36:35.077 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:36:35.078 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:36:35.338 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 266.8798ms
2025-08-05 15:36:35.351 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 273.5547ms
2025-08-05 15:36:35.390 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 312.4797ms
2025-08-05 15:36:35.553 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:36:35.904 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 351.7025ms
2025-08-05 15:38:37.630 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 15:38:40.191 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:38:40.219 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:38:40.273 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 15:38:40.309 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 15:38:40.356 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 15:38:40.899 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:38:41.025 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:38:41.054 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:38:42.748 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 15:38:42.898 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 15:38:42.934 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 15:38:42.936 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 15:38:42.940 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 15:38:42.945 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 15:38:42.964 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 15:38:42.969 +03:00 [INF] Hosting environment: Development
2025-08-05 15:38:42.971 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 15:38:42.991 +03:00 [INF] Server mrrobot:2380:b79d9a71 successfully announced in 13.9249 ms
2025-08-05 15:38:42.996 +03:00 [INF] Server mrrobot:2380:b79d9a71 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 15:38:43.178 +03:00 [INF] Server mrrobot:2380:b79d9a71 all the dispatchers started
2025-08-05 15:38:43.181 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:38:43.558 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 310.82ms
2025-08-05 15:38:43.563 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:38:43.654 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:38:43.661 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:38:43.672 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 109.285ms
2025-08-05 15:38:43.689 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 27.9052ms
2025-08-05 15:38:43.725 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 70.6667ms
2025-08-05 15:38:43.793 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:38:44.088 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 295.5019ms
2025-08-05 15:39:11.413 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 15:39:11.428 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 15:39:11.596 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:39:11.671 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:39:11.695 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:39:11.732 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 15:39:12.204 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 15:39:12.218 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 15:39:12.221 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 15:39:12.339 +03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-08-05 15:39:12.344 +03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-08-05 15:39:12.393 +03:00 [ERR] Error in GetBestSellersAsync
System.InvalidOperationException: The LINQ expression 'i => i.DeletedAt == null' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateProjection(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberAssignment(MemberAssignment memberAssignment)
   at System.Linq.Expressions.ExpressionVisitor.VisitMemberBinding(MemberBinding node)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberInit(MemberInitExpression memberInitExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Translate(SelectExpression selectExpression, Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateSelect(ShapedQueryExpression source, LambdaExpression selector)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellersAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly) in D:\project_fashion\E-Commerce-API-main\Services\ProductServices\ProductSearchService.cs:line 203
2025-08-05 15:39:12.562 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:39:12.596 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 853.8045ms
2025-08-05 15:39:12.601 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:39:12.608 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 500 220 application/json; charset=utf-8 1195.1695ms
2025-08-05 15:39:30.252 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:39:30.449 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 196.7205ms
2025-08-05 15:39:30.521 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:39:30.521 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:39:30.580 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:39:30.584 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 63.0863ms
2025-08-05 15:39:30.692 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 170.4401ms
2025-08-05 15:39:30.743 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 162.4968ms
2025-08-05 15:39:30.958 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:39:31.210 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 257.2419ms
2025-08-05 15:41:41.034 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/newarrivals?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 15:41:41.049 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:41:41.061 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:41:41.073 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetNewArrivals (E-Commerce)'
2025-08-05 15:41:41.086 +03:00 [INF] Route matched with {action = "GetNewArrivals", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetNewArrivals(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 15:41:41.121 +03:00 [INF] Getting cache for key: newarrivals_1_10_True_False
2025-08-05 15:41:41.126 +03:00 [WRN] Cache miss for key: newarrivals_1_10_True_False
2025-08-05 15:41:41.133 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 15:41:41.263 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__thirtyDaysAgo_0='?' (DbType = DateTime), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`fitType`, `t`.`IsActive`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`)
    ELSE `t`.`Price`
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `d`.`Id`, `t0`.`Id`, `t0`.`Url`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE ((`p`.`CreatedAt` >= @__thirtyDaysAgo_0) AND `p`.`IsActive`) AND `p`.`DeletedAt` IS NULL
    ORDER BY `p`.`CreatedAt` DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
ORDER BY `t`.`CreatedAt` DESC, `t`.`Id`, `d`.`Id`
2025-08-05 15:41:41.359 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:41:41.375 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetNewArrivals (E-Commerce) in 280.8133ms
2025-08-05 15:41:41.380 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetNewArrivals (E-Commerce)'
2025-08-05 15:41:41.384 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/newarrivals?page=1&pageSize=10&isActive=true&includeDeleted=true - 200 588 application/json; charset=utf-8 350.1008ms
2025-08-05 15:41:43.413 +03:00 [INF] Setting cache for key: newarrivals_1_10_True_False
2025-08-05 15:41:43.506 +03:00 [INF] Cache set successfully for key: newarrivals_1_10_True_False with tags: [product_search]
2025-08-05 15:43:43.011 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 15:48:18.327 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:48:18.460 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 132.5287ms
2025-08-05 15:48:28.392 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 15:48:30.765 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:48:30.780 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:48:30.821 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 15:48:30.857 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 15:48:30.890 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 15:48:31.362 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:48:31.475 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:48:31.506 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:48:32.139 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 15:48:32.224 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 15:48:32.251 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 15:48:32.252 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 15:48:32.253 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 15:48:32.255 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 15:48:32.279 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 15:48:32.299 +03:00 [INF] Hosting environment: Development
2025-08-05 15:48:32.304 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 15:48:32.315 +03:00 [INF] Server mrrobot:22180:769f735e successfully announced in 11.8528 ms
2025-08-05 15:48:32.324 +03:00 [INF] Server mrrobot:22180:769f735e is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 15:48:32.793 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:48:32.829 +03:00 [INF] Server mrrobot:22180:769f735e all the dispatchers started
2025-08-05 15:48:33.156 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 362.9893ms
2025-08-05 15:48:33.309 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:48:33.310 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:48:33.364 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 56.3969ms
2025-08-05 15:48:33.365 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:48:33.394 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 83.8617ms
2025-08-05 15:48:33.494 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 129.0829ms
2025-08-05 15:48:34.042 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:48:34.396 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 354.1981ms
2025-08-05 15:48:39.043 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 15:48:39.310 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 15:48:39.677 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:48:39.798 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:48:39.882 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:48:39.930 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 15:48:40.622 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 15:48:40.636 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 15:48:40.640 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 15:48:40.795 +03:00 [ERR] Error in GetBestSellersAsync
System.InvalidOperationException: The LINQ expression 'DbSet<OrderItem>()
    .Join(
        inner: DbSet<Order>(), 
        outerKeySelector: o => EF.Property<int?>(o, "OrderId"), 
        innerKeySelector: o0 => EF.Property<int?>(o0, "Id"), 
        resultSelector: (o, i) => new TransparentIdentifier<OrderItem, Order>(
            Outer = o, 
            Inner = i
        ))
    .Where(o => (int)o.Inner.Status != 5)
    .Join(
        inner: DbSet<Product>(), 
        outerKeySelector: o => EF.Property<int?>(o.Outer, "ProductId"), 
        innerKeySelector: p => EF.Property<int?>(p, "Id"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<OrderItem, Order>, Product>(
            Outer = o, 
            Inner = i
        ))
    .GroupBy(o => new { 
        ProductId = o.Outer.Outer.ProductId, 
        Product = o.Inner
     })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellersAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly) in D:\project_fashion\E-Commerce-API-main\Services\ProductServices\ProductSearchService.cs:line 203
2025-08-05 15:48:40.991 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:48:41.040 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 1093.8885ms
2025-08-05 15:48:41.046 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:48:41.097 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 500 220 application/json; charset=utf-8 2054.2313ms
2025-08-05 15:51:43.793 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 15:51:47.242 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:51:47.269 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:51:47.325 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 15:51:47.366 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 15:51:47.431 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 15:51:49.091 +03:00 [INF] Executed DbCommand (110ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:51:49.498 +03:00 [INF] Executed DbCommand (128ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:51:50.166 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:51:53.134 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 15:51:53.903 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 15:51:54.082 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 15:51:54.098 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 15:51:54.102 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 15:51:54.104 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 15:51:54.152 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 15:51:54.260 +03:00 [INF] Server mrrobot:18800:abfa550d successfully announced in 92.3918 ms
2025-08-05 15:51:54.270 +03:00 [INF] Hosting environment: Development
2025-08-05 15:51:54.320 +03:00 [INF] Server mrrobot:18800:abfa550d is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 15:51:54.325 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 15:51:54.639 +03:00 [INF] Server mrrobot:18800:abfa550d all the dispatchers started
2025-08-05 15:51:58.465 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:51:58.465 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 15:51:58.653 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 15:51:59.661 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 1197.8713ms
2025-08-05 15:51:59.664 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:52:00.169 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:52:00.248 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:52:00.454 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 15:52:01.686 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 15:52:01.716 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 15:52:01.721 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 15:52:01.888 +03:00 [ERR] Error in GetBestSellersAsync
System.InvalidOperationException: Cannot apply the 'Include' operation with argument 'p => p.Images'. Either the source is not a queryable of a known entity type or 'Include' has been applied after 'Select' method which projects a different entity type through navigation. Consider applying 'Include' before 'Select' method call.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellersAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly) in D:\project_fashion\E-Commerce-API-main\Services\ProductServices\ProductSearchService.cs:line 203
2025-08-05 15:52:02.378 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:52:02.659 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 2145.821ms
2025-08-05 15:52:02.685 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:52:02.713 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 500 220 application/json; charset=utf-8 4259.0722ms
2025-08-05 15:52:09.568 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:52:09.583 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 15.1268ms
2025-08-05 15:52:09.600 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:52:09.617 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:52:09.627 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.936ms
2025-08-05 15:52:09.694 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 93.1899ms
2025-08-05 15:52:10.423 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:52:10.818 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 395.211ms
2025-08-05 15:52:17.973 +03:00 [WRN] Stopping the server due to DomainUnload or ProcessExit event...
2025-08-05 15:52:17.978 +03:00 [INF] Server mrrobot:18800:abfa550d caught stopping signal...
2025-08-05 15:52:17.982 +03:00 [INF] Server mrrobot:18800:abfa550d caught stopped signal...
2025-08-05 15:52:17.987 +03:00 [INF] Server mrrobot:18800:abfa550d All dispatchers stopped
2025-08-05 15:52:17.988 +03:00 [WRN] Server mrrobot:18800:abfa550d caught shutdown signal...
2025-08-05 15:52:17.999 +03:00 [INF] Server mrrobot:18800:abfa550d successfully reported itself as stopped in 6.4715 ms
2025-08-05 15:52:18.001 +03:00 [INF] Server mrrobot:18800:abfa550d has been stopped in total 19.0404 ms
2025-08-05 15:59:13.282 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 15:59:16.175 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:59:16.200 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 15:59:16.249 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 15:59:16.290 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 15:59:16.326 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 15:59:16.730 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:59:16.834 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 15:59:16.889 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 15:59:17.565 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 15:59:17.683 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 15:59:17.714 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 15:59:17.717 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 15:59:17.719 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 15:59:17.727 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 15:59:17.754 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 15:59:17.793 +03:00 [INF] Server mrrobot:16980:cfeedd3d successfully announced in 29.079 ms
2025-08-05 15:59:17.793 +03:00 [INF] Hosting environment: Development
2025-08-05 15:59:17.811 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 15:59:17.810 +03:00 [INF] Server mrrobot:16980:cfeedd3d is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 15:59:17.841 +03:00 [INF] 2 servers were removed due to timeout
2025-08-05 15:59:18.111 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 15:59:18.147 +03:00 [INF] Server mrrobot:16980:cfeedd3d all the dispatchers started
2025-08-05 15:59:18.794 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 681.6892ms
2025-08-05 15:59:18.956 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 15:59:18.966 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 15:59:18.978 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 21.2314ms
2025-08-05 15:59:19.027 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 15:59:19.047 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 20.159ms
2025-08-05 15:59:19.431 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 464.7741ms
2025-08-05 15:59:22.342 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 15:59:23.193 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 851.6685ms
2025-08-05 15:59:23.293 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 15:59:23.323 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 15:59:24.091 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 15:59:24.324 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 15:59:24.397 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:59:24.624 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 15:59:26.492 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 15:59:26.561 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 15:59:26.578 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 15:59:26.596 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 15:59:27.481 +03:00 [ERR] Error in GetBestSellersAsync
System.InvalidOperationException: The LINQ expression 'i => i.DeletedAt == null' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateProjection(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberAssignment(MemberAssignment memberAssignment)
   at System.Linq.Expressions.ExpressionVisitor.VisitMemberBinding(MemberBinding node)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberInit(MemberInitExpression memberInitExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Translate(SelectExpression selectExpression, Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateSelect(ShapedQueryExpression source, LambdaExpression selector)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellersAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly) in D:\project_fashion\E-Commerce-API-main\Services\ProductServices\ProductSearchService.cs:line 217
2025-08-05 15:59:29.196 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 15:59:29.297 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 4648.7236ms
2025-08-05 15:59:29.349 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 15:59:29.380 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 500 220 application/json; charset=utf-8 6086.5186ms
2025-08-05 15:59:34.826 +03:00 [WRN] Stopping the server due to DomainUnload or ProcessExit event...
2025-08-05 15:59:35.004 +03:00 [INF] Server mrrobot:16980:cfeedd3d caught stopping signal...
2025-08-05 15:59:35.011 +03:00 [INF] Server mrrobot:16980:cfeedd3d caught stopped signal...
2025-08-05 15:59:35.017 +03:00 [WRN] Server mrrobot:16980:cfeedd3d caught shutdown signal...
2025-08-05 15:59:35.023 +03:00 [WRN] Server mrrobot:16980:cfeedd3d stopped non-gracefully due to ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler. Outstanding work on those dispatchers could be aborted, and there can be delays in background processing. This server instance will be incorrectly shown as active for a while. To avoid non-graceful shutdowns, investigate what prevents from stopping gracefully and add CancellationToken support for those methods.
2025-08-05 15:59:35.054 +03:00 [INF] Server mrrobot:16980:cfeedd3d successfully reported itself as stopped in 19.0729 ms
2025-08-05 15:59:35.059 +03:00 [INF] Server mrrobot:16980:cfeedd3d has been stopped in total 48.334 ms
2025-08-05 16:00:18.346 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 16:00:20.690 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:00:20.706 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:00:20.752 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:00:20.777 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 16:00:20.842 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 16:00:21.289 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:00:21.373 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:00:21.400 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 16:00:22.081 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 16:00:22.283 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 16:00:22.401 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 16:00:22.413 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 16:00:22.415 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 16:00:22.417 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 16:00:22.541 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 16:00:22.589 +03:00 [INF] Hosting environment: Development
2025-08-05 16:00:22.603 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 16:00:22.604 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:00:22.630 +03:00 [INF] Server mrrobot:8576:6dc731af successfully announced in 56.9449 ms
2025-08-05 16:00:22.745 +03:00 [INF] Server mrrobot:8576:6dc731af is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 16:00:23.213 +03:00 [INF] Server mrrobot:8576:6dc731af all the dispatchers started
2025-08-05 16:00:23.420 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 819.2618ms
2025-08-05 16:00:23.694 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:00:23.700 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:00:23.712 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:00:23.722 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 27.7005ms
2025-08-05 16:00:23.793 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 80.2259ms
2025-08-05 16:00:23.913 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 213.6162ms
2025-08-05 16:00:24.583 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:00:25.340 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 756.977ms
2025-08-05 16:00:29.284 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 16:00:29.362 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 16:00:29.930 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:00:30.140 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:00:30.185 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:00:30.295 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 16:00:31.414 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 16:00:31.432 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 16:00:31.458 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 16:00:32.031 +03:00 [ERR] Error in GetBestSellersAsync
System.InvalidOperationException: The LINQ expression 'i => new ImageDto{ 
    Id = i.Id, 
    Url = i.Url 
}
' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitLambda[T](Expression`1 lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateProjection(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberAssignment(MemberAssignment memberAssignment)
   at System.Linq.Expressions.ExpressionVisitor.VisitMemberBinding(MemberBinding node)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitMemberInit(MemberInitExpression memberInitExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Translate(SelectExpression selectExpression, Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateSelect(ShapedQueryExpression source, LambdaExpression selector)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellersAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly) in D:\project_fashion\E-Commerce-API-main\Services\ProductServices\ProductSearchService.cs:line 203
2025-08-05 16:00:32.346 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 16:00:32.421 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 2103.0721ms
2025-08-05 16:00:32.481 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:00:32.504 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 500 220 application/json; charset=utf-8 3219.9439ms
2025-08-05 16:01:29.547 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:01:29.618 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 70.7629ms
2025-08-05 16:01:29.744 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:01:29.763 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 19.3815ms
2025-08-05 16:01:29.817 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:01:29.821 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:01:29.870 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 49.0724ms
2025-08-05 16:01:29.896 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 79.0738ms
2025-08-05 16:01:30.770 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:01:32.010 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 1239.7406ms
2025-08-05 16:01:34.266 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 16:01:34.314 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:01:34.387 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:01:34.404 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:01:34.471 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 16:01:34.575 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 16:01:34.584 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 16:01:34.599 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 16:01:34.663 +03:00 [ERR] Error in GetBestSellersAsync
System.InvalidOperationException: Cannot apply the 'Include' operation with argument 'p => p.Images'. Either the source is not a queryable of a known entity type or 'Include' has been applied after 'Select' method which projects a different entity type through navigation. Consider applying 'Include' before 'Select' method call.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellersAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly)
2025-08-05 16:01:34.790 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 16:01:34.846 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 343.5631ms
2025-08-05 16:01:34.998 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:01:35.001 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 500 220 application/json; charset=utf-8 735.1613ms
2025-08-05 16:01:59.580 +03:00 [WRN] Stopping the server due to DomainUnload or ProcessExit event...
2025-08-05 16:01:59.921 +03:00 [INF] Server mrrobot:8576:6dc731af caught stopping signal...
2025-08-05 16:01:59.952 +03:00 [INF] Server mrrobot:8576:6dc731af caught stopped signal...
2025-08-05 16:01:59.969 +03:00 [INF] Server mrrobot:8576:6dc731af All dispatchers stopped
2025-08-05 16:01:59.977 +03:00 [WRN] Server mrrobot:8576:6dc731af caught shutdown signal...
2025-08-05 16:02:00.003 +03:00 [INF] Server mrrobot:8576:6dc731af successfully reported itself as stopped in 14.551 ms
2025-08-05 16:02:00.005 +03:00 [INF] Server mrrobot:8576:6dc731af has been stopped in total 52.4638 ms
2025-08-05 16:03:32.606 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 16:03:36.392 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:03:36.424 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:03:36.490 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:03:36.535 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 16:03:36.595 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 16:03:37.212 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:03:37.349 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:03:37.410 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 16:03:38.332 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 16:03:38.516 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 16:03:38.689 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 16:03:38.697 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 16:03:38.702 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 16:03:38.707 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 16:03:38.768 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 16:03:38.864 +03:00 [INF] Hosting environment: Development
2025-08-05 16:03:38.867 +03:00 [INF] Server mrrobot:20324:60fb9a73 successfully announced in 69.179 ms
2025-08-05 16:03:38.875 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 16:03:38.893 +03:00 [INF] Server mrrobot:20324:60fb9a73 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 16:03:39.437 +03:00 [INF] Server mrrobot:20324:60fb9a73 all the dispatchers started
2025-08-05 16:03:39.970 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:03:42.122 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 2155.1752ms
2025-08-05 16:03:44.883 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:03:44.904 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 23.1399ms
2025-08-05 16:03:44.937 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:03:44.942 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:03:44.989 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 51.2896ms
2025-08-05 16:03:45.115 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 173.1825ms
2025-08-05 16:03:46.196 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:03:46.851 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 654.2629ms
2025-08-05 16:04:11.128 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 16:04:11.285 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 16:04:11.721 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:04:11.902 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:04:11.934 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:04:12.034 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 16:04:13.502 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 16:04:13.523 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 16:04:13.577 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 16:04:13.589 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 16:04:14.366 +03:00 [INF] Executed DbCommand (229ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`fitType`, `t0`.`IsActive`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `t0`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t0`.`Price`)
    ELSE `t0`.`Price`
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t0`.`ProductId`, `d`.`Id`, `i`.`Id`, `i`.`Url`
FROM (
    SELECT `t`.`ProductId`, `t`.`TotalQuantity`, `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM (
        SELECT `o`.`ProductId`, COALESCE(SUM(`o`.`Quantity`), 0) AS `TotalQuantity`
        FROM `OrderItem` AS `o`
        INNER JOIN `Orders` AS `o0` ON `o`.`OrderId` = `o0`.`Id`
        WHERE `o0`.`Status` <> 5
        GROUP BY `o`.`ProductId`
    ) AS `t`
    INNER JOIN `Products` AS `p` ON `t`.`ProductId` = `p`.`Id`
    WHERE `p`.`IsActive` AND (`p`.`DeletedAt` IS NULL)
    ORDER BY `t`.`TotalQuantity` DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS `t0`
LEFT JOIN `Discount` AS `d` ON `t0`.`DiscountId` = `d`.`Id`
LEFT JOIN `Images` AS `i` ON `t0`.`Id` = `i`.`ProductId`
ORDER BY `t0`.`TotalQuantity` DESC, `t0`.`ProductId`, `t0`.`Id`, `d`.`Id`
2025-08-05 16:04:14.450 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 16:04:14.656 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__8__locals1_isActive_0='?' (DbType = Boolean), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`fitType`, `t`.`IsActive`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`)
    ELSE `t`.`Price`
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `d`.`Id`, `i`.`Id`, `i`.`Url`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, UUID() AS `c`
    FROM `Products` AS `p`
    WHERE `p`.`IsActive` = @__8__locals1_isActive_0
    ORDER BY UUID()
    LIMIT @__p_1
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`ProductId`
ORDER BY `t`.`c`, `t`.`Id`, `d`.`Id`
2025-08-05 16:04:14.908 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 16:04:15.099 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 3041.8358ms
2025-08-05 16:04:15.105 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:04:15.170 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 200 623 application/json; charset=utf-8 4041.365ms
2025-08-05 16:04:32.018 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - null null
2025-08-05 16:04:32.042 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:04:32.072 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:04:32.092 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:04:32.102 +03:00 [INF] Route matched with {action = "GetBestSellers", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.DtoModels.ProductDtos.ProductDto]]]] GetBestSellers(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 16:04:32.136 +03:00 [INF] Getting cache for key: bestsellers_1_10_True_False
2025-08-05 16:04:32.149 +03:00 [WRN] Cache miss for key: bestsellers_1_10_True_False
2025-08-05 16:04:32.170 +03:00 [INF] Execute GetAll for entity OrderItem
2025-08-05 16:04:32.175 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 16:04:32.342 +03:00 [INF] Executed DbCommand (105ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t0`.`Id`, `t0`.`Name`, `t0`.`Description`, `t0`.`Quantity`, `t0`.`Gender`, `t0`.`SubCategoryId`, `t0`.`Price`, `t0`.`CreatedAt`, `t0`.`ModifiedAt`, `t0`.`DeletedAt`, `t0`.`fitType`, `t0`.`IsActive`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `t0`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t0`.`Price`)
    ELSE `t0`.`Price`
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `t0`.`ProductId`, `d`.`Id`, `i`.`Id`, `i`.`Url`
FROM (
    SELECT `t`.`ProductId`, `t`.`TotalQuantity`, `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM (
        SELECT `o`.`ProductId`, COALESCE(SUM(`o`.`Quantity`), 0) AS `TotalQuantity`
        FROM `OrderItem` AS `o`
        INNER JOIN `Orders` AS `o0` ON `o`.`OrderId` = `o0`.`Id`
        WHERE `o0`.`Status` <> 5
        GROUP BY `o`.`ProductId`
    ) AS `t`
    INNER JOIN `Products` AS `p` ON `t`.`ProductId` = `p`.`Id`
    WHERE `p`.`IsActive` AND (`p`.`DeletedAt` IS NULL)
    ORDER BY `t`.`TotalQuantity` DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS `t0`
LEFT JOIN `Discount` AS `d` ON `t0`.`DiscountId` = `d`.`Id`
LEFT JOIN `Images` AS `i` ON `t0`.`Id` = `i`.`ProductId`
ORDER BY `t0`.`TotalQuantity` DESC, `t0`.`ProductId`, `t0`.`Id`, `d`.`Id`
2025-08-05 16:04:32.388 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 16:04:32.487 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__8__locals1_isActive_0='?' (DbType = Boolean), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`SubCategoryId`, `t`.`Price`, `t`.`CreatedAt`, `t`.`ModifiedAt`, `t`.`DeletedAt`, `t`.`fitType`, `t`.`IsActive`, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `t`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `t`.`Price`)
    ELSE `t`.`Price`
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`EndDate`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
    ELSE NULL
END, CASE
    WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
    ELSE 0.0
END, `d`.`Id`, `i`.`Id`, `i`.`Url`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, UUID() AS `c`
    FROM `Products` AS `p`
    WHERE `p`.`IsActive` = @__8__locals1_isActive_0
    ORDER BY UUID()
    LIMIT @__p_1
) AS `t`
LEFT JOIN `Discount` AS `d` ON `t`.`DiscountId` = `d`.`Id`
LEFT JOIN `Images` AS `i` ON `t`.`Id` = `i`.`ProductId`
ORDER BY `t`.`c`, `t`.`Id`, `d`.`Id`
2025-08-05 16:04:32.540 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.DtoModels.ProductDtos.ProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 16:04:32.549 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce) in 442.4232ms
2025-08-05 16:04:32.571 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellers (E-Commerce)'
2025-08-05 16:04:32.640 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/bestsellers?page=1&pageSize=10&isActive=true&includeDeleted=true - 200 623 application/json; charset=utf-8 622.0543ms
2025-08-05 16:42:52.673 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 16:42:54.742 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:42:54.761 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:42:54.789 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:42:54.811 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 16:42:54.845 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 16:42:55.315 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:42:55.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:42:55.430 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 16:42:56.361 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 16:42:56.446 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 16:42:56.482 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 16:42:56.484 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 16:42:56.486 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 16:42:56.487 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 16:42:56.506 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 16:42:56.510 +03:00 [INF] Hosting environment: Development
2025-08-05 16:42:56.512 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 16:42:56.546 +03:00 [INF] Server mrrobot:1092:aa808151 successfully announced in 18.0985 ms
2025-08-05 16:42:56.555 +03:00 [INF] Server mrrobot:1092:aa808151 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 16:42:56.563 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 16:42:56.673 +03:00 [INF] Server mrrobot:1092:aa808151 all the dispatchers started
2025-08-05 16:42:57.643 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:42:58.018 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 374.2596ms
2025-08-05 16:42:58.050 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:42:58.050 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:42:58.105 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 55.3012ms
2025-08-05 16:42:58.139 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 89.3116ms
2025-08-05 16:42:58.146 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:42:58.231 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 85.2103ms
2025-08-05 16:42:58.292 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:42:58.654 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 362.7456ms
2025-08-05 16:44:30.525 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - null null
2025-08-05 16:44:30.538 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 16:44:32.278 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:44:32.293 +03:00 [INF] No cached response available for this request.
2025-08-05 16:44:32.308 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The AuthorizationPolicy named: 'Admin' was not found.
   at Microsoft.AspNetCore.Authorization.AuthorizationPolicy.CombineAsync(IAuthorizationPolicyProvider policyProvider, IEnumerable`1 authorizeData, IEnumerable`1 policies)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at SecurityStampMiddleware.Invoke(HttpContext context) in D:\project_fashion\E-Commerce-API-main\MiddleWares\SecurityStampMiddleware.cs:line 75
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context) in D:\project_fashion\E-Commerce-API-main\Middleware\UserAuthenticationMiddleware.cs:line 24
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-08-05 16:44:32.355 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - 500 null text/plain; charset=utf-8 1829.4348ms
2025-08-05 16:45:04.411 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 16:45:05.917 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:45:05.934 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:45:05.965 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:45:05.991 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 16:45:06.045 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 16:45:06.424 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:45:06.496 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:45:06.525 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 16:45:07.057 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 16:45:07.147 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 16:45:07.166 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 16:45:07.167 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 16:45:07.168 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 16:45:07.170 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 16:45:07.183 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 16:45:07.184 +03:00 [INF] Hosting environment: Development
2025-08-05 16:45:07.185 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 16:45:07.203 +03:00 [INF] Server mrrobot:15648:69cabd8d successfully announced in 14.8905 ms
2025-08-05 16:45:07.217 +03:00 [INF] Server mrrobot:15648:69cabd8d is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 16:45:07.368 +03:00 [INF] Server mrrobot:15648:69cabd8d all the dispatchers started
2025-08-05 16:45:07.631 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:45:07.798 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 166.3706ms
2025-08-05 16:45:07.828 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:45:07.829 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:45:07.829 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:45:07.842 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 13.1898ms
2025-08-05 16:45:07.848 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 19.2028ms
2025-08-05 16:45:07.917 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 87.6351ms
2025-08-05 16:45:07.984 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:45:08.216 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 232.3047ms
2025-08-05 16:45:18.178 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - null null
2025-08-05 16:45:18.185 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 16:45:18.282 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:45:18.293 +03:00 [INF] No cached response available for this request.
2025-08-05 16:45:18.299 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The AuthorizationPolicy named: 'Admin' was not found.
   at Microsoft.AspNetCore.Authorization.AuthorizationPolicy.CombineAsync(IAuthorizationPolicyProvider policyProvider, IEnumerable`1 authorizeData, IEnumerable`1 policies)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at SecurityStampMiddleware.Invoke(HttpContext context) in D:\project_fashion\E-Commerce-API-main\MiddleWares\SecurityStampMiddleware.cs:line 75
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context) in D:\project_fashion\E-Commerce-API-main\Middleware\UserAuthenticationMiddleware.cs:line 24
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-08-05 16:45:18.342 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - 500 null text/plain; charset=utf-8 164.0112ms
2025-08-05 16:45:45.579 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:45:45.589 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 9.6559ms
2025-08-05 16:45:45.665 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:45:45.674 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:45:45.705 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:45:45.708 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 43.7732ms
2025-08-05 16:45:45.729 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 55.3118ms
2025-08-05 16:45:45.748 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.1431ms
2025-08-05 16:45:45.879 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:45:46.127 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 247.549ms
2025-08-05 16:45:52.936 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - null null
2025-08-05 16:45:52.943 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:45:52.945 +03:00 [INF] No cached response available for this request.
2025-08-05 16:45:52.964 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-05 16:45:52.976 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-05 16:45:52.979 +03:00 [INF] The response could not be cached for this request.
2025-08-05 16:45:52.980 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - 401 0 null 44.2562ms
2025-08-05 16:46:19.129 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - null null
2025-08-05 16:46:19.374 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:46:19.431 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:46:19.442 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-05 16:46:19.447 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-05 16:46:19.450 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - 403 0 null 321.0166ms
2025-08-05 16:47:19.403 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Account/login - application/json 70
2025-08-05 16:47:19.412 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:47:19.502 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:47:19.511 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-05 16:47:19.547 +03:00 [INF] Route matched with {action = "LoginAsync", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.TokenDtos.TokensDto]]] LoginAsync(E_Commerce.DtoModels.AccountDtos.LoginDTo) on controller E_Commerce.Controllers.AccountController (E-Commerce).
2025-08-05 16:47:19.860 +03:00 [INF] In LoginAsync Method 
2025-08-05 16:47:19.868 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 16:47:19.984 +03:00 [INF] 🔐 Generating Access Token for User ID: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 16:47:20.059 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a0`.`Name`
FROM `AspNetUserRoles` AS `a`
INNER JOIN `AspNetRoles` AS `a0` ON `a`.`RoleId` = `a0`.`Id`
WHERE `a`.`UserId` = @__userId_0
2025-08-05 16:47:20.082 +03:00 [INF] ✅ Access Token generated successfully for User ID: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 16:47:20.087 +03:00 [INF] 🔑 Generating Refresh Token for User ID: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 16:47:20.097 +03:00 [INF] RefreshToken Generated
2025-08-05 16:47:20.133 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.TokenDtos.TokensDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 16:47:20.168 +03:00 [INF] Executed action E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce) in 613.4638ms
2025-08-05 16:47:20.172 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.AccountController.LoginAsync (E-Commerce)'
2025-08-05 16:47:20.186 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Account/login - 200 1403 application/json; charset=utf-8 783.2918ms
2025-08-05 16:47:43.234 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - null null
2025-08-05 16:47:43.239 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:47:43.247 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:47:43.253 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce)'
2025-08-05 16:47:43.272 +03:00 [INF] Route matched with {action = "GetBestSellingProducts", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.Services.ProductServices.BestSellingProductDto]]]] GetBestSellingProducts(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 16:47:43.307 +03:00 [INF] Getting cache for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10
2025-08-05 16:47:43.312 +03:00 [WRN] Cache miss for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10
2025-08-05 16:47:43.314 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 16:47:43.441 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-05 16:47:43.486 +03:00 [ERR] Failed executing DbCommand (29ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `t0`.`Id`, `t0`.`Color`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`IsActive`, `t0`.`Length`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Id0`, `t0`.`CreatedAt0`, `t0`.`DeletedAt0`, `t0`.`ModifiedAt0`, `t0`.`OrderId`, `t0`.`OrderedAt`, `t0`.`ProductId0`, `t0`.`ProductVariantId`, `t0`.`Quantity0`, `t0`.`TotalPrice`, `t0`.`UnitPrice`, `i0`.`Id`, `i0`.`AltText`, `i0`.`CategoryId`, `i0`.`CollectionId`, `i0`.`CreatedAt`, `i0`.`CustomerId`, `i0`.`DeletedAt`, `i0`.`FileSize`, `i0`.`FileType`, `i0`.`Folder`, `i0`.`Height`, `i0`.`IsMain`, `i0`.`ModifiedAt`, `i0`.`ProductId`, `i0`.`SubCategoryId`, `i0`.`Title`, `i0`.`UploadDate`, `i0`.`Url`, `i0`.`Width`, `t`.`c`, `t`.`c0`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, COALESCE((
        SELECT COALESCE(SUM(`o3`.`Quantity`), 0)
        FROM `ProductVariants` AS `p2`
        INNER JOIN `OrderItem` AS `o3` ON `p2`.`Id` = `o3`.`ProductVariantId`
        INNER JOIN `Orders` AS `o4` ON `o3`.`OrderId` = `o4`.`Id`
        WHERE (`p`.`Id` = `p2`.`ProductId`) AND (`o4`.`Status` = 1)), 0) AS `c`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, COALESCE((
        SELECT COALESCE(SUM(`o1`.`Quantity`), 0)
        FROM `ProductVariants` AS `p1`
        INNER JOIN `OrderItem` AS `o1` ON `p1`.`Id` = `o1`.`ProductVariantId`
        INNER JOIN `Orders` AS `o2` ON `o1`.`OrderId` = `o2`.`Id`
        WHERE (`p`.`Id` = `p1`.`ProductId`) AND (`o2`.`Status` = 1)), 0) AS `c1`
    FROM `Products` AS `p`
    WHERE COALESCE((
        SELECT COALESCE(SUM(`o`.`Quantity`), 0)
        FROM `ProductVariants` AS `p0`
        INNER JOIN `OrderItem` AS `o` ON `p0`.`Id` = `o`.`ProductVariantId`
        INNER JOIN `Orders` AS `o0` ON `o`.`OrderId` = `o0`.`Id`
        WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`o0`.`Status` = 1)), 0) > 0
    ORDER BY COALESCE((
        SELECT COALESCE(SUM(`o1`.`Quantity`), 0)
        FROM `ProductVariants` AS `p1`
        INNER JOIN `OrderItem` AS `o1` ON `p1`.`Id` = `o1`.`ProductVariantId`
        INNER JOIN `Orders` AS `o2` ON `o1`.`OrderId` = `o2`.`Id`
        WHERE (`p`.`Id` = `p1`.`ProductId`) AND (`o2`.`Status` = 1)), 0) DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN (
    SELECT `p3`.`Id`, `p3`.`Color`, `p3`.`CreatedAt`, `p3`.`DeletedAt`, `p3`.`IsActive`, `p3`.`Length`, `p3`.`ModifiedAt`, `p3`.`ProductId`, `p3`.`Quantity`, `p3`.`Size`, `p3`.`Waist`, `o5`.`Id` AS `Id0`, `o5`.`CreatedAt` AS `CreatedAt0`, `o5`.`DeletedAt` AS `DeletedAt0`, `o5`.`ModifiedAt` AS `ModifiedAt0`, `o5`.`OrderId`, `o5`.`OrderedAt`, `o5`.`ProductId` AS `ProductId0`, `o5`.`ProductVariantId`, `o5`.`Quantity` AS `Quantity0`, `o5`.`TotalPrice`, `o5`.`UnitPrice`
    FROM `ProductVariants` AS `p3`
    LEFT JOIN `OrderItem` AS `o5` ON `p3`.`Id` = `o5`.`ProductVariantId`
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN `Images` AS `i0` ON `t`.`Id` = `i0`.`ProductId`
ORDER BY `t`.`c1` DESC, `t`.`Id`, `t0`.`Id`, `t0`.`Id0`
2025-08-05 16:47:43.517 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
MySqlConnector.MySqlException (0x80004005): Unknown column 'i0.CustomerId' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
MySqlConnector.MySqlException (0x80004005): Unknown column 'i0.CustomerId' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-08-05 16:47:43.533 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce) in 257.9571ms
2025-08-05 16:47:43.536 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce)'
2025-08-05 16:47:43.538 +03:00 [ERR] An unhandled exception has occurred while executing the request.
MySqlConnector.MySqlException (0x80004005): Unknown column 'i0.CustomerId' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at E_Commerce.Services.ProductServices.ProductSearchService.GetBestSellerProductsWithCountAsync(Nullable`1 isDeleted, Nullable`1 isActive, Int32 page, Int32 pagesize)
   at E_Commerce.Services.ProductServices.ProductsServices.GetBestSellersProductsWithCountAsync(Int32 page, Int32 pageSize, Nullable`1 isActive, Nullable`1 deletedOnly)
   at E_Commerce.Controllers.ProductController.GetBestSellingProducts(Int32 page, Int32 pageSize, Nullable`1 isDeleted, Nullable`1 isActive)
   at lambda_method297(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.ResponseCaching.ResponseCachingMiddleware.Invoke(HttpContext httpContext)
   at SecurityStampMiddleware.Invoke(HttpContext context)
   at E_Commerce.Middleware.UserAuthenticationMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.RateLimiting.RateLimitingMiddleware.InvokeInternal(HttpContext context, EnableRateLimitingAttribute enableRateLimitingAttribute)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-08-05 16:47:43.564 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - 500 null text/plain; charset=utf-8 330.0027ms
2025-08-05 16:48:59.148 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 16:49:01.845 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:49:01.862 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:49:01.908 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:49:01.929 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 16:49:01.965 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 16:49:02.435 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:49:02.522 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:49:02.549 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 16:49:03.552 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 16:49:03.797 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 16:49:04.278 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 16:49:04.282 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 16:49:04.287 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 16:49:04.290 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 16:49:04.394 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 16:49:04.399 +03:00 [INF] Hosting environment: Development
2025-08-05 16:49:04.438 +03:00 [INF] Server mrrobot:23860:4f585900 successfully announced in 42.1933 ms
2025-08-05 16:49:04.439 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 16:49:04.458 +03:00 [INF] Server mrrobot:23860:4f585900 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 16:49:05.774 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:49:06.098 +03:00 [INF] Server mrrobot:23860:4f585900 all the dispatchers started
2025-08-05 16:49:06.757 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 1236.4852ms
2025-08-05 16:49:06.813 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:49:06.814 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:49:06.814 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:49:06.824 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.9998ms
2025-08-05 16:49:06.837 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 23.303ms
2025-08-05 16:49:06.938 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 123.6338ms
2025-08-05 16:49:07.005 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:49:07.311 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 305.8235ms
2025-08-05 16:49:12.263 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - null null
2025-08-05 16:49:12.280 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 16:49:12.692 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:49:12.747 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:49:12.790 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce)'
2025-08-05 16:49:12.835 +03:00 [INF] Route matched with {action = "GetBestSellingProducts", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.Services.ProductServices.BestSellingProductDto]]]] GetBestSellingProducts(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 16:49:13.429 +03:00 [INF] Getting cache for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10
2025-08-05 16:49:13.440 +03:00 [WRN] Cache miss for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10
2025-08-05 16:49:13.445 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 16:49:13.781 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-05 16:49:13.835 +03:00 [ERR] Failed executing DbCommand (14ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `t0`.`Id`, `t0`.`Color`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`IsActive`, `t0`.`Length`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Id0`, `t0`.`CreatedAt0`, `t0`.`DeletedAt0`, `t0`.`ModifiedAt0`, `t0`.`OrderId`, `t0`.`OrderedAt`, `t0`.`ProductId0`, `t0`.`ProductVariantId`, `t0`.`Quantity0`, `t0`.`TotalPrice`, `t0`.`UnitPrice`, `i0`.`Id`, `i0`.`AltText`, `i0`.`CategoryId`, `i0`.`CollectionId`, `i0`.`CreatedAt`, `i0`.`CustomerId`, `i0`.`DeletedAt`, `i0`.`FileSize`, `i0`.`FileType`, `i0`.`Folder`, `i0`.`Height`, `i0`.`IsMain`, `i0`.`ModifiedAt`, `i0`.`ProductId`, `i0`.`SubCategoryId`, `i0`.`Title`, `i0`.`UploadDate`, `i0`.`Url`, `i0`.`Width`, `t`.`c`, `t`.`c0`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, COALESCE((
        SELECT COALESCE(SUM(`o3`.`Quantity`), 0)
        FROM `ProductVariants` AS `p2`
        INNER JOIN `OrderItem` AS `o3` ON `p2`.`Id` = `o3`.`ProductVariantId`
        INNER JOIN `Orders` AS `o4` ON `o3`.`OrderId` = `o4`.`Id`
        WHERE (`p`.`Id` = `p2`.`ProductId`) AND (`o4`.`Status` = 1)), 0) AS `c`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, COALESCE((
        SELECT COALESCE(SUM(`o1`.`Quantity`), 0)
        FROM `ProductVariants` AS `p1`
        INNER JOIN `OrderItem` AS `o1` ON `p1`.`Id` = `o1`.`ProductVariantId`
        INNER JOIN `Orders` AS `o2` ON `o1`.`OrderId` = `o2`.`Id`
        WHERE (`p`.`Id` = `p1`.`ProductId`) AND (`o2`.`Status` = 1)), 0) AS `c1`
    FROM `Products` AS `p`
    WHERE COALESCE((
        SELECT COALESCE(SUM(`o`.`Quantity`), 0)
        FROM `ProductVariants` AS `p0`
        INNER JOIN `OrderItem` AS `o` ON `p0`.`Id` = `o`.`ProductVariantId`
        INNER JOIN `Orders` AS `o0` ON `o`.`OrderId` = `o0`.`Id`
        WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`o0`.`Status` = 1)), 0) > 0
    ORDER BY COALESCE((
        SELECT COALESCE(SUM(`o1`.`Quantity`), 0)
        FROM `ProductVariants` AS `p1`
        INNER JOIN `OrderItem` AS `o1` ON `p1`.`Id` = `o1`.`ProductVariantId`
        INNER JOIN `Orders` AS `o2` ON `o1`.`OrderId` = `o2`.`Id`
        WHERE (`p`.`Id` = `p1`.`ProductId`) AND (`o2`.`Status` = 1)), 0) DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN (
    SELECT `p3`.`Id`, `p3`.`Color`, `p3`.`CreatedAt`, `p3`.`DeletedAt`, `p3`.`IsActive`, `p3`.`Length`, `p3`.`ModifiedAt`, `p3`.`ProductId`, `p3`.`Quantity`, `p3`.`Size`, `p3`.`Waist`, `o5`.`Id` AS `Id0`, `o5`.`CreatedAt` AS `CreatedAt0`, `o5`.`DeletedAt` AS `DeletedAt0`, `o5`.`ModifiedAt` AS `ModifiedAt0`, `o5`.`OrderId`, `o5`.`OrderedAt`, `o5`.`ProductId` AS `ProductId0`, `o5`.`ProductVariantId`, `o5`.`Quantity` AS `Quantity0`, `o5`.`TotalPrice`, `o5`.`UnitPrice`
    FROM `ProductVariants` AS `p3`
    LEFT JOIN `OrderItem` AS `o5` ON `p3`.`Id` = `o5`.`ProductVariantId`
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN `Images` AS `i0` ON `t`.`Id` = `i0`.`ProductId`
ORDER BY `t`.`c1` DESC, `t`.`Id`, `t0`.`Id`, `t0`.`Id0`
2025-08-05 16:49:13.916 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'E_Commerce.Context.AppDbContext'.
MySqlConnector.MySqlException (0x80004005): Unknown column 'i0.CustomerId' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
MySqlConnector.MySqlException (0x80004005): Unknown column 'i0.CustomerId' in 'field list'
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.InitAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, IDictionary`2 cachedProcedures, IMySqlCommand command, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 483
   at MySqlConnector.Core.CommandExecutor.ExecuteReaderAsync(CommandListPosition commandListPosition, ICommandPayloadCreator payloadCreator, CommandBehavior behavior, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/CommandExecutor.cs:line 56
   at MySqlConnector.MySqlCommand.ExecuteReaderAsync(CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 357
   at MySqlConnector.MySqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlCommand.cs:line 350
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-08-05 16:49:24.407 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce) in 11561.4269ms
2025-08-05 16:49:24.413 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce)'
2025-08-05 16:50:33.272 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:50:33.345 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:50:33.375 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:50:33.407 +03:00 [INF] Applying migration '20250805135002_last-update'.
2025-08-05 16:50:33.854 +03:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Orders` RENAME COLUMN `Addressid` TO `CustomerAddressId`;
2025-08-05 16:52:05.268 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:52:05.338 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:52:05.359 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:52:05.377 +03:00 [INF] Applying migration '20250805135002_last-update'.
2025-08-05 16:52:05.555 +03:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Orders` RENAME COLUMN `Addressid` TO `CustomerAddressId`;
2025-08-05 16:53:44.593 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:53:44.667 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:53:44.691 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:53:44.710 +03:00 [INF] Applying migration '20250805135002_last-update'.
2025-08-05 16:53:44.999 +03:00 [INF] Executed DbCommand (97ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE Orders CHANGE Addressid CustomerAddressId INT;
2025-08-05 16:53:45.105 +03:00 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Payments` MODIFY COLUMN `Status` int NOT NULL;
2025-08-05 16:53:45.114 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Payments` ADD `TransactionId` varchar(100) CHARACTER SET utf8mb4 NULL;
2025-08-05 16:53:45.124 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Images` ADD `CustomerId` longtext CHARACTER SET utf8mb4 NOT NULL;
2025-08-05 16:53:45.194 +03:00 [INF] Executed DbCommand (70ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `adminOperationsLogs` MODIFY COLUMN `ItemId` longtext CHARACTER SET utf8mb4 NOT NULL;
2025-08-05 16:53:45.227 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX `IX_Orders_CustomerAddressId` ON `Orders` (`CustomerAddressId`);
2025-08-05 16:53:45.327 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE `Orders` ADD CONSTRAINT `FK_Orders_CustomerAddresses_CustomerAddressId` FOREIGN KEY (`CustomerAddressId`) REFERENCES `CustomerAddresses` (`Id`) ON DELETE CASCADE;
2025-08-05 16:53:45.330 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `__EFMigrationsHistory` (`MigrationId`, `ProductVersion`)
VALUES ('20250805135002_last-update', '8.0.13');
2025-08-05 16:53:54.922 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 16:53:56.388 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:53:56.405 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 16:53:56.427 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 16:53:56.455 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 16:53:56.481 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 16:53:56.838 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:53:56.908 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 16:53:56.933 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 16:53:57.516 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 16:53:57.596 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 16:53:57.612 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 16:53:57.613 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 16:53:57.619 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 16:53:57.623 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 16:53:57.635 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 16:53:57.637 +03:00 [INF] Hosting environment: Development
2025-08-05 16:53:57.641 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 16:53:57.657 +03:00 [INF] Server mrrobot:23904:a134f450 successfully announced in 16.1332 ms
2025-08-05 16:53:57.661 +03:00 [INF] Server mrrobot:23904:a134f450 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 16:53:57.678 +03:00 [INF] 2 servers were removed due to timeout
2025-08-05 16:53:57.757 +03:00 [INF] Server mrrobot:23904:a134f450 all the dispatchers started
2025-08-05 16:53:58.147 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:53:58.655 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 508.1701ms
2025-08-05 16:53:58.803 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:53:58.803 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:53:58.814 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.5277ms
2025-08-05 16:53:58.848 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:53:58.823 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 19.4629ms
2025-08-05 16:53:58.909 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 61.6581ms
2025-08-05 16:53:59.006 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:53:59.278 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 272.5089ms
2025-08-05 16:54:09.017 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - null null
2025-08-05 16:54:09.027 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 16:54:09.174 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:54:09.227 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:54:09.248 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce)'
2025-08-05 16:54:09.275 +03:00 [INF] Route matched with {action = "GetBestSellingProducts", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Collections.Generic.List`1[E_Commerce.Services.ProductServices.BestSellingProductDto]]]] GetBestSellingProducts(Int32, Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 16:54:09.659 +03:00 [INF] Getting cache for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10
2025-08-05 16:54:09.667 +03:00 [WRN] Cache miss for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10
2025-08-05 16:54:09.669 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 16:54:09.876 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-05 16:54:09.945 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `t0`.`Id`, `t0`.`Color`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`IsActive`, `t0`.`Length`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Id0`, `t0`.`CreatedAt0`, `t0`.`DeletedAt0`, `t0`.`ModifiedAt0`, `t0`.`OrderId`, `t0`.`OrderedAt`, `t0`.`ProductId0`, `t0`.`ProductVariantId`, `t0`.`Quantity0`, `t0`.`TotalPrice`, `t0`.`UnitPrice`, `i0`.`Id`, `i0`.`AltText`, `i0`.`CategoryId`, `i0`.`CollectionId`, `i0`.`CreatedAt`, `i0`.`CustomerId`, `i0`.`DeletedAt`, `i0`.`FileSize`, `i0`.`FileType`, `i0`.`Folder`, `i0`.`Height`, `i0`.`IsMain`, `i0`.`ModifiedAt`, `i0`.`ProductId`, `i0`.`SubCategoryId`, `i0`.`Title`, `i0`.`UploadDate`, `i0`.`Url`, `i0`.`Width`, `t`.`c`, `t`.`c0`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, COALESCE((
        SELECT COALESCE(SUM(`o3`.`Quantity`), 0)
        FROM `ProductVariants` AS `p2`
        INNER JOIN `OrderItem` AS `o3` ON `p2`.`Id` = `o3`.`ProductVariantId`
        INNER JOIN `Orders` AS `o4` ON `o3`.`OrderId` = `o4`.`Id`
        WHERE (`p`.`Id` = `p2`.`ProductId`) AND (`o4`.`Status` = 1)), 0) AS `c`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `c0`, COALESCE((
        SELECT COALESCE(SUM(`o1`.`Quantity`), 0)
        FROM `ProductVariants` AS `p1`
        INNER JOIN `OrderItem` AS `o1` ON `p1`.`Id` = `o1`.`ProductVariantId`
        INNER JOIN `Orders` AS `o2` ON `o1`.`OrderId` = `o2`.`Id`
        WHERE (`p`.`Id` = `p1`.`ProductId`) AND (`o2`.`Status` = 1)), 0) AS `c1`
    FROM `Products` AS `p`
    WHERE COALESCE((
        SELECT COALESCE(SUM(`o`.`Quantity`), 0)
        FROM `ProductVariants` AS `p0`
        INNER JOIN `OrderItem` AS `o` ON `p0`.`Id` = `o`.`ProductVariantId`
        INNER JOIN `Orders` AS `o0` ON `o`.`OrderId` = `o0`.`Id`
        WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`o0`.`Status` = 1)), 0) > 0
    ORDER BY COALESCE((
        SELECT COALESCE(SUM(`o1`.`Quantity`), 0)
        FROM `ProductVariants` AS `p1`
        INNER JOIN `OrderItem` AS `o1` ON `p1`.`Id` = `o1`.`ProductVariantId`
        INNER JOIN `Orders` AS `o2` ON `o1`.`OrderId` = `o2`.`Id`
        WHERE (`p`.`Id` = `p1`.`ProductId`) AND (`o2`.`Status` = 1)), 0) DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS `t`
LEFT JOIN (
    SELECT `p3`.`Id`, `p3`.`Color`, `p3`.`CreatedAt`, `p3`.`DeletedAt`, `p3`.`IsActive`, `p3`.`Length`, `p3`.`ModifiedAt`, `p3`.`ProductId`, `p3`.`Quantity`, `p3`.`Size`, `p3`.`Waist`, `o5`.`Id` AS `Id0`, `o5`.`CreatedAt` AS `CreatedAt0`, `o5`.`DeletedAt` AS `DeletedAt0`, `o5`.`ModifiedAt` AS `ModifiedAt0`, `o5`.`OrderId`, `o5`.`OrderedAt`, `o5`.`ProductId` AS `ProductId0`, `o5`.`ProductVariantId`, `o5`.`Quantity` AS `Quantity0`, `o5`.`TotalPrice`, `o5`.`UnitPrice`
    FROM `ProductVariants` AS `p3`
    LEFT JOIN `OrderItem` AS `o5` ON `p3`.`Id` = `o5`.`ProductVariantId`
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN `Images` AS `i0` ON `t`.`Id` = `i0`.`ProductId`
ORDER BY `t`.`c1` DESC, `t`.`Id`, `t0`.`Id`, `t0`.`Id0`
2025-08-05 16:54:10.050 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[E_Commerce.Services.ProductServices.BestSellingProductDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 16:54:10.080 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce) in 796.4169ms
2025-08-05 16:54:10.083 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetBestSellingProducts (E-Commerce)'
2025-08-05 16:54:10.089 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/best-selling?page=1&pageSize=10 - 200 120 application/json; charset=utf-8 1072.3313ms
2025-08-05 16:54:17.895 +03:00 [INF] Setting cache for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10
2025-08-05 16:54:17.934 +03:00 [INF] Cache set successfully for key: BestSellerProducts:isDeleted=_isActive=_page=1_pagesize_10 with tags: [product_search]
2025-08-05 16:54:51.357 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 16:54:51.369 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 16:54:51.379 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 16:54:51.391 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 16:54:51.400 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 16:54:51.418 +03:00 [INF] Executing GetCart
2025-08-05 16:54:51.427 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 16:54:51.432 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 16:54:51.435 +03:00 [WRN] Cache miss for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 16:54:51.455 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-05 16:54:51.463 +03:00 [INF] Execute GetAll for entity Cart
2025-08-05 16:54:51.614 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-08-05 16:54:51.634 +03:00 [INF] Setting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 16:54:51.668 +03:00 [INF] Cache set successfully for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32 with tags: [cart]
2025-08-05 16:54:51.674 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 16:54:51.694 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 284.7525ms
2025-08-05 16:54:51.698 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 16:54:51.705 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 937 application/json; charset=utf-8 347.9945ms
2025-08-05 16:58:29.319 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:58:29.367 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 48.0469ms
2025-08-05 16:58:29.412 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:58:29.419 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 7.3165ms
2025-08-05 16:58:29.428 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:58:29.433 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:58:29.438 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.2495ms
2025-08-05 16:58:29.454 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.3521ms
2025-08-05 16:58:31.455 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:58:31.691 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 236.3792ms
2025-08-05 16:58:57.719 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 16:59:18.700 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 16:59:18.749 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 49.7764ms
2025-08-05 16:59:18.834 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 16:59:18.837 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 3.7655ms
2025-08-05 16:59:18.838 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 16:59:18.847 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 16:59:18.855 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.7419ms
2025-08-05 16:59:18.858 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 19.1101ms
2025-08-05 16:59:19.151 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 16:59:19.348 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 196.4505ms
2025-08-05 17:01:59.480 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5069/api/Cart/items/1/1 - application/json 22
2025-08-05 17:01:59.490 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:01:59.497 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:01:59.506 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-08-05 17:01:59.513 +03:00 [INF] Route matched with {action = "UpdateCartItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCartItem(Int32, E_Commerce.DtoModels.CartDtos.UpdateCartItemDto, Int32) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:01:59.549 +03:00 [INF] Executing UpdateCartItem for product ID: 1, variant ID: 0
2025-08-05 17:01:59.562 +03:00 [INF] Updating cart item for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1, variant: 0
2025-08-05 17:01:59.588 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:01:59.676 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:01:59.749 +03:00 [WRN] Cart item not found for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1, variant: 0
2025-08-05 17:01:59.779 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:01:59.792 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce) in 273.2056ms
2025-08-05 17:01:59.797 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-08-05 17:01:59.799 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5069/api/Cart/items/1/1 - 404 201 application/json; charset=utf-8 319.7169ms
2025-08-05 17:02:27.559 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:02:27.938 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:02:27.943 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:02:27.948 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:02:28.090 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:02:28.127 +03:00 [INF] Executing GetCart
2025-08-05 17:02:28.128 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:02:28.129 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:02:28.136 +03:00 [INF] Cache hit for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:02:28.154 +03:00 [INF] Cache hit for cart user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:02:28.156 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:02:28.158 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 64.9243ms
2025-08-05 17:02:28.160 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:02:28.162 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 935 application/json; charset=utf-8 603.7028ms
2025-08-05 17:02:57.426 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/1?isActive=true&includeDeleted=true - null null
2025-08-05 17:02:57.433 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:02:57.437 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:02:57.443 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:02:57.452 +03:00 [INF] Route matched with {action = "GetProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProduct(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:02:57.471 +03:00 [INF] Executing GetProduct for ID: 1
2025-08-05 17:02:57.481 +03:00 [INF] Retrieving product by id: 1, isActive: True, deletedOnly: True
2025-08-05 17:02:57.485 +03:00 [INF] Getting cache for key: product_detail:1:isActive=True:deletedOnly=True
2025-08-05 17:02:57.489 +03:00 [WRN] Cache miss for key: product_detail:1:isActive=True:deletedOnly=True
2025-08-05 17:02:57.492 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:02:57.524 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-05 17:02:57.541 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__8__locals1_id_0='?' (DbType = Int32), @__8__locals1_isActive_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`IsActive`, `t`.`Price`, `t`.`c`, `t`.`fitType`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`IsActive`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`DeletedAt`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`IsActive`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`fitType`, `p`.`SubCategoryId`, ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE ((`p`.`Id` = @__8__locals1_id_0) AND `p`.`DeletedAt` IS NOT NULL) AND (`p`.`IsActive` = @__8__locals1_isActive_1)
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`IsActive`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE (`p0`.`DeletedAt` IS NULL AND `p0`.`IsActive`) AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-08-05 17:02:57.550 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:02:57.559 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProduct (E-Commerce) in 99.5293ms
2025-08-05 17:02:57.563 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:02:57.565 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/1?isActive=true&includeDeleted=true - 404 196 application/json; charset=utf-8 138.4349ms
2025-08-05 17:03:01.662 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/1?isActive=true - null null
2025-08-05 17:03:01.670 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:03:01.677 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:03:01.683 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:03:01.685 +03:00 [INF] Route matched with {action = "GetProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProduct(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:03:01.701 +03:00 [INF] Executing GetProduct for ID: 1
2025-08-05 17:03:01.704 +03:00 [INF] Retrieving product by id: 1, isActive: True, deletedOnly: 
2025-08-05 17:03:01.708 +03:00 [INF] Getting cache for key: product_detail:1:isActive=True:deletedOnly=
2025-08-05 17:03:01.711 +03:00 [WRN] Cache miss for key: product_detail:1:isActive=True:deletedOnly=
2025-08-05 17:03:01.713 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:03:01.727 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-05 17:03:01.748 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__8__locals1_id_0='?' (DbType = Int32), @__8__locals1_isActive_1='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`IsActive`, `t`.`Price`, `t`.`c`, `t`.`fitType`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`IsActive`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`DeletedAt`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`IsActive`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`fitType`, `p`.`SubCategoryId`, ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE (`p`.`Id` = @__8__locals1_id_0) AND (`p`.`IsActive` = @__8__locals1_isActive_1)
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`IsActive`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE (`p0`.`DeletedAt` IS NULL AND `p0`.`IsActive`) AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-08-05 17:03:01.754 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:03:01.757 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProduct (E-Commerce) in 68.7582ms
2025-08-05 17:03:01.759 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:03:01.761 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/1?isActive=true - 404 196 application/json; charset=utf-8 99.1356ms
2025-08-05 17:05:11.354 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:05:11.369 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 15.9535ms
2025-08-05 17:05:11.403 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:05:11.425 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 22.5892ms
2025-08-05 17:05:11.435 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:05:11.437 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:05:11.444 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.0001ms
2025-08-05 17:05:11.444 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 9.3531ms
2025-08-05 17:05:11.718 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:05:11.900 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 182.7483ms
2025-08-05 17:05:19.128 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5069/api/Cart/clear - null null
2025-08-05 17:05:19.138 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:05:19.143 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:05:19.148 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-08-05 17:05:19.153 +03:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ClearCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:05:19.162 +03:00 [INF] Executing ClearCart
2025-08-05 17:05:19.168 +03:00 [INF] Clearing cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:05:19.181 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:05:19.243 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:05:19.256 +03:00 [INF] Clearing cart: 1
2025-08-05 17:05:19.267 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE `c`.`CartId` = @__cartId_0
2025-08-05 17:05:19.281 +03:00 [INF] Cart 1 cleared successfully
2025-08-05 17:05:19.285 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:05:19.301 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:05:19.357 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:05:19.503 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:05:19.558 +03:00 [INF] Removing cache by tag: cart
2025-08-05 17:05:19.572 +03:00 [INF] Removed 1 cache entries for tag: cart
2025-08-05 17:05:19.579 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:05:19.581 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.ClearCart (E-Commerce) in 423.5934ms
2025-08-05 17:05:19.583 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.ClearCart (E-Commerce)'
2025-08-05 17:05:19.585 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5069/api/Cart/clear - 200 128 application/json; charset=utf-8 456.3698ms
2025-08-05 17:05:23.850 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:05:23.866 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:05:23.872 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:05:23.875 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:05:23.884 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:05:23.888 +03:00 [INF] Executing GetCart
2025-08-05 17:05:23.890 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:05:23.891 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:05:23.896 +03:00 [WRN] Cache miss for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:05:23.899 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-05 17:05:23.903 +03:00 [INF] Execute GetAll for entity Cart
2025-08-05 17:05:23.966 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-08-05 17:05:23.984 +03:00 [INF] Setting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:05:23.993 +03:00 [INF] Cache set successfully for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32 with tags: [cart]
2025-08-05 17:05:23.995 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:05:23.998 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 110.7649ms
2025-08-05 17:05:24.000 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:05:24.002 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 335 application/json; charset=utf-8 151.7967ms
2025-08-05 17:05:49.568 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5069/api/Cart/items/1/1 - application/json 19
2025-08-05 17:05:49.577 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:05:49.582 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:05:49.586 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-08-05 17:05:49.591 +03:00 [INF] Route matched with {action = "UpdateCartItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCartItem(Int32, E_Commerce.DtoModels.CartDtos.UpdateCartItemDto, Int32) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:05:49.599 +03:00 [INF] Executing UpdateCartItem for product ID: 1, variant ID: 0
2025-08-05 17:05:49.601 +03:00 [INF] Updating cart item for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1, variant: 0
2025-08-05 17:05:49.607 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:05:49.652 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:05:49.660 +03:00 [WRN] Cart item not found for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1, variant: 0
2025-08-05 17:05:49.663 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:05:49.665 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce) in 69.6065ms
2025-08-05 17:05:49.667 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-08-05 17:05:49.669 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5069/api/Cart/items/1/1 - 404 201 application/json; charset=utf-8 101.5147ms
2025-08-05 17:06:05.680 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:06:05.686 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:06:05.697 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:06:05.701 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:06:05.714 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:06:05.738 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:06:05.753 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:06:05.780 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND NOT (`p`.`IsActive`)
LIMIT 1
2025-08-05 17:06:05.787 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:06:05.790 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 70.5088ms
2025-08-05 17:06:05.793 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:06:05.797 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 400 215 application/json; charset=utf-8 116.5031ms
2025-08-05 17:07:42.110 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:07:44.603 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:07:44.625 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:07:44.657 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:07:44.682 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:07:44.731 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:07:45.269 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:07:45.367 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:07:45.401 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:07:46.585 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:07:46.763 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:07:46.971 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:07:46.996 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:07:47.353 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:07:47.468 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:07:47.672 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:07:48.007 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:07:48.013 +03:00 [INF] Hosting environment: Development
2025-08-05 17:07:48.017 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:07:48.070 +03:00 [INF] Server mrrobot:16920:c30d4519 successfully announced in 57.1847 ms
2025-08-05 17:07:48.097 +03:00 [INF] Server mrrobot:16920:c30d4519 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:07:49.350 +03:00 [INF] Server mrrobot:16920:c30d4519 all the dispatchers started
2025-08-05 17:07:49.597 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:07:49.597 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:07:49.603 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 2196.1347ms
2025-08-05 17:07:49.700 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 106.0548ms
2025-08-05 17:07:49.870 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 275.8357ms
2025-08-05 17:07:49.885 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:07:50.001 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 116.7749ms
2025-08-05 17:07:50.190 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:07:50.857 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 667.3079ms
2025-08-05 17:08:00.197 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:08:00.205 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:08:00.520 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:08:00.598 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:08:00.661 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:08:00.705 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:08:01.198 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:08:01.326 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:08:38.715 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND NOT (`p`.`IsActive`)
LIMIT 1
2025-08-05 17:08:50.540 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:08:50.599 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 49874.4203ms
2025-08-05 17:08:50.608 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:08:50.624 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 400 215 application/json; charset=utf-8 50426.3494ms
2025-08-05 17:09:04.565 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/1 - null null
2025-08-05 17:09:04.575 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:09:04.585 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:09:04.590 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:09:04.606 +03:00 [INF] Route matched with {action = "GetProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProduct(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:09:04.626 +03:00 [INF] Executing GetProduct for ID: 1
2025-08-05 17:09:04.636 +03:00 [INF] Retrieving product by id: 1, isActive: , deletedOnly: 
2025-08-05 17:09:04.640 +03:00 [INF] Getting cache for key: product_detail:1:isActive=:deletedOnly=
2025-08-05 17:09:04.650 +03:00 [WRN] Cache miss for key: product_detail:1:isActive=:deletedOnly=
2025-08-05 17:09:04.653 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:09:04.772 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-05 17:09:04.815 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__8__locals1_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`Name`, `t`.`Description`, `t`.`Quantity`, `t`.`Gender`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`IsActive`, `t`.`Price`, `t`.`c`, `t`.`fitType`, `t`.`SubCategoryId`, `t`.`c0`, `t`.`Id0`, `t`.`DiscountPercent`, `t`.`IsActive0`, `t`.`StartDate`, `t`.`EndDate`, `t`.`Name0`, `t`.`Description0`, `t0`.`Id`, `t0`.`Url`, `t1`.`Id`, `t1`.`IsActive`, `t1`.`CreatedAt`, `t1`.`ModifiedAt`, `t1`.`DeletedAt`, `t1`.`Color`, `t1`.`Size`, `t1`.`Waist`, `t1`.`Length`, `t1`.`Quantity`, `t1`.`ProductId`
FROM (
    SELECT `p`.`Id`, `p`.`Name`, `p`.`Description`, `p`.`Quantity`, `p`.`Gender`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`ModifiedAt`, `p`.`IsActive`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN ROUND(`p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`))
        ELSE `p`.`Price`
    END AS `c`, `p`.`fitType`, `p`.`SubCategoryId`, ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) AS `c0`, `d`.`Id` AS `Id0`, `d`.`DiscountPercent`, `d`.`IsActive` AS `IsActive0`, `d`.`StartDate`, `d`.`EndDate`, `d`.`Name` AS `Name0`, `d`.`Description` AS `Description0`
    FROM `Products` AS `p`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    WHERE `p`.`Id` = @__8__locals1_id_0
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `i`.`Id`, `i`.`Url`, `i`.`ProductId`
    FROM `Images` AS `i`
    WHERE `i`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`ProductId`
LEFT JOIN (
    SELECT `p0`.`Id`, `p0`.`IsActive`, `p0`.`CreatedAt`, `p0`.`ModifiedAt`, `p0`.`DeletedAt`, `p0`.`Color`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity`, `p0`.`ProductId`
    FROM `ProductVariants` AS `p0`
    WHERE (`p0`.`DeletedAt` IS NULL AND `p0`.`IsActive`) AND (`p0`.`Quantity` <> 0)
) AS `t1` ON `t`.`Id` = `t1`.`ProductId`
ORDER BY `t`.`Id`, `t`.`Id0`, `t0`.`Id`
2025-08-05 17:09:04.838 +03:00 [INF] Product found: product 1 (ID: 1)
2025-08-05 17:09:04.990 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:09:05.007 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProduct (E-Commerce) in 388.2161ms
2025-08-05 17:09:05.009 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:09:05.013 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/1 - 200 1004 application/json; charset=utf-8 448.5615ms
2025-08-05 17:09:10.662 +03:00 [INF] Setting cache for key: product_detail:1:isActive=:deletedOnly=
2025-08-05 17:09:10.724 +03:00 [INF] Cache set successfully for key: product_detail:1:isActive=:deletedOnly= with tags: [productwithvariantdata]
2025-08-05 17:10:08.961 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/1 - null null
2025-08-05 17:10:08.972 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:10:08.978 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:10:08.985 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:10:08.988 +03:00 [INF] Route matched with {action = "GetProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProduct(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:10:09.040 +03:00 [INF] Executing GetProduct for ID: 1
2025-08-05 17:10:09.042 +03:00 [INF] Retrieving product by id: 1, isActive: , deletedOnly: 
2025-08-05 17:10:09.044 +03:00 [INF] Getting cache for key: product_detail:1:isActive=:deletedOnly=
2025-08-05 17:10:09.050 +03:00 [INF] Cache hit for key: product_detail:1:isActive=:deletedOnly=
2025-08-05 17:10:09.068 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:10:09.072 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProduct (E-Commerce) in 80.4807ms
2025-08-05 17:10:09.074 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:10:09.076 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/1 - 200 1002 application/json; charset=utf-8 115.3899ms
2025-08-05 17:10:14.807 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:10:14.814 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:10:14.818 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:10:14.825 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:10:14.829 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:10:14.849 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:10:14.866 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:10:51.160 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND NOT (`p`.`IsActive`)
LIMIT 1
2025-08-05 17:11:22.226 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:11:22.259 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 67425.0353ms
2025-08-05 17:11:22.261 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:11:22.267 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 400 215 application/json; charset=utf-8 67460.9609ms
2025-08-05 17:11:58.369 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:11:58.710 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 348.8095ms
2025-08-05 17:11:58.859 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:11:58.795 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:11:58.807 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:11:58.872 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:11:58.876 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 17.1959ms
2025-08-05 17:11:58.892 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:11:58.940 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 68.8766ms
2025-08-05 17:11:58.962 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 167.2194ms
2025-08-05 17:11:58.997 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:11:59.192 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:11:59.238 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:11:59.252 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:11:59.280 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:11:59.293 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:12:04.909 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND NOT (`p`.`IsActive`)
LIMIT 1
2025-08-05 17:12:14.546 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:12:14.571 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 15307.482ms
2025-08-05 17:12:14.572 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:12:14.653 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 400 215 application/json; charset=utf-8 15845.7872ms
2025-08-05 17:12:14.787 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 15595.9068ms
2025-08-05 17:12:48.230 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 17:13:39.638 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:13:41.279 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:13:41.302 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:13:41.331 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:13:41.349 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:13:41.376 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:13:41.732 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:13:41.798 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:13:41.828 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:13:42.356 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:13:42.443 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:13:42.787 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:13:42.979 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:13:42.992 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:13:42.993 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:13:42.994 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:13:43.033 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:13:43.039 +03:00 [INF] Hosting environment: Development
2025-08-05 17:13:43.040 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:13:43.046 +03:00 [INF] Server mrrobot:13412:5dadfe61 successfully announced in 12.1822 ms
2025-08-05 17:13:43.050 +03:00 [INF] Server mrrobot:13412:5dadfe61 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:13:43.193 +03:00 [INF] Server mrrobot:13412:5dadfe61 all the dispatchers started
2025-08-05 17:13:43.220 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 435.6628ms
2025-08-05 17:13:43.253 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:13:43.270 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:13:43.314 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:13:43.321 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 67.4311ms
2025-08-05 17:13:43.332 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 17.8332ms
2025-08-05 17:13:43.378 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 107.8974ms
2025-08-05 17:13:43.461 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:13:43.794 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 332.2324ms
2025-08-05 17:14:41.787 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:14:41.800 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 13.1844ms
2025-08-05 17:14:41.842 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:14:41.848 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:14:41.883 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:14:41.887 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 44.3842ms
2025-08-05 17:14:41.911 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 27.6745ms
2025-08-05 17:14:41.925 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.5421ms
2025-08-05 17:14:41.985 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:14:42.178 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 192.8631ms
2025-08-05 17:14:44.569 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:14:44.594 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:14:44.947 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:14:45.033 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:14:45.064 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:14:45.116 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:14:45.668 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:14:45.786 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, `p`.`DeletedAt` IS NOT NULL AS `isdeleted`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:14:45.809 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND NOT (`p`.`IsActive`)
LIMIT 1
2025-08-05 17:14:45.836 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:14:45.884 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 747.0117ms
2025-08-05 17:14:45.888 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:14:45.897 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 400 215 application/json; charset=utf-8 1328.0218ms
2025-08-05 17:15:02.371 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Products/1 - null null
2025-08-05 17:15:02.383 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:15:02.391 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:15:02.396 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:15:02.408 +03:00 [INF] Route matched with {action = "GetProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.ProductDtos.ProductDetailDto]]] GetProduct(Int32, System.Nullable`1[System.Boolean], System.Nullable`1[System.Boolean]) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:15:02.425 +03:00 [INF] Executing GetProduct for ID: 1
2025-08-05 17:15:02.431 +03:00 [INF] Retrieving product by id: 1, isActive: , deletedOnly: 
2025-08-05 17:15:02.434 +03:00 [INF] Getting cache for key: product_detail:1:isActive=:deletedOnly=
2025-08-05 17:15:02.444 +03:00 [INF] Cache hit for key: product_detail:1:isActive=:deletedOnly=
2025-08-05 17:15:02.514 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.ProductDtos.ProductDetailDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:15:02.547 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.GetProduct (E-Commerce) in 134.8645ms
2025-08-05 17:15:02.549 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.GetProduct (E-Commerce)'
2025-08-05 17:15:02.551 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Products/1 - 200 1002 application/json; charset=utf-8 180.3163ms
2025-08-05 17:16:00.526 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:16:01.897 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:16:01.935 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:16:01.958 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:16:01.976 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:16:02.008 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:16:02.514 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:16:02.600 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:16:02.626 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:16:03.148 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:16:03.237 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:16:03.319 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:16:03.567 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:16:03.586 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:16:03.597 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:16:03.598 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:16:03.619 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:16:03.626 +03:00 [INF] Hosting environment: Development
2025-08-05 17:16:03.636 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:16:03.636 +03:00 [INF] Server mrrobot:21328:6d0a91d6 successfully announced in 17.7641 ms
2025-08-05 17:16:03.650 +03:00 [INF] Server mrrobot:21328:6d0a91d6 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:16:03.745 +03:00 [INF] Server mrrobot:21328:6d0a91d6 all the dispatchers started
2025-08-05 17:16:03.781 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 462.2585ms
2025-08-05 17:16:03.799 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:16:03.799 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:16:03.820 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:16:03.828 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 29.0113ms
2025-08-05 17:16:03.844 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 24.4417ms
2025-08-05 17:16:03.880 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 80.2755ms
2025-08-05 17:16:03.965 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:16:04.159 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 193.3846ms
2025-08-05 17:16:06.707 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:16:06.715 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:16:06.844 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:16:06.896 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:16:06.915 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:16:06.944 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:16:07.289 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:16:07.374 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, `p`.`DeletedAt` IS NOT NULL AS `isdeleted`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:16:07.393 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:16:07.424 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 469.8039ms
2025-08-05 17:16:07.444 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:16:07.451 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 400 199 application/json; charset=utf-8 743.402ms
2025-08-05 17:16:22.967 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:16:22.989 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 21.139ms
2025-08-05 17:16:23.067 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:16:23.079 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:16:23.098 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:16:23.126 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 58.8359ms
2025-08-05 17:16:23.189 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 109.5796ms
2025-08-05 17:16:23.359 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 260.3079ms
2025-08-05 17:16:23.516 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:16:24.094 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 577.9403ms
2025-08-05 17:16:39.380 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/restore - null 0
2025-08-05 17:16:39.391 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:16:39.402 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:16:39.409 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.RestoreProductAsync (E-Commerce)'
2025-08-05 17:16:39.417 +03:00 [INF] Route matched with {action = "RestoreProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] RestoreProductAsync(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:16:39.451 +03:00 [INF] Restoring product: 1
2025-08-05 17:16:39.502 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE (`p`.`Id` = @__productId_0) AND `p`.`DeletedAt` IS NOT NULL
LIMIT 1
2025-08-05 17:16:39.627 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:16:39.633 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:16:39.751 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:16:40.023 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `DeletedAt` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:16:40.085 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:16:40.090 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.RestoreProductAsync (E-Commerce) in 668.3635ms
2025-08-05 17:16:40.094 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.RestoreProductAsync (E-Commerce)'
2025-08-05 17:16:40.098 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/restore - 200 132 application/json; charset=utf-8 718.203ms
2025-08-05 17:16:43.948 +03:00 [INF] Removing cache by tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:16:43.977 +03:00 [INF] Removed 4 cache entries for tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:16:45.252 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:16:45.264 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:16:45.272 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:16:45.281 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:16:45.290 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:16:45.330 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:16:45.336 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, `p`.`DeletedAt` IS NOT NULL AS `isdeleted`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:16:45.354 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND NOT (`p`.`IsActive`)
LIMIT 1
2025-08-05 17:16:45.362 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:16:45.365 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:16:45.368 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:16:45.381 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `IsActive` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:16:45.415 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:16:45.419 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 123.562ms
2025-08-05 17:16:45.422 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:16:45.425 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 200 133 application/json; charset=utf-8 173.7465ms
2025-08-05 17:16:53.879 +03:00 [INF] Removing cache by tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:16:53.886 +03:00 [WRN] No cache entries found for tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:16:58.198 +03:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5069/api/Cart/items/1/1 - application/json 19
2025-08-05 17:16:58.203 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:16:58.208 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:16:58.213 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-08-05 17:16:58.220 +03:00 [INF] Route matched with {action = "UpdateCartItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] UpdateCartItem(Int32, E_Commerce.DtoModels.CartDtos.UpdateCartItemDto, Int32) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:16:58.261 +03:00 [INF] Executing UpdateCartItem for product ID: 1, variant ID: 0
2025-08-05 17:16:58.272 +03:00 [INF] Updating cart item for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1, variant: 0
2025-08-05 17:16:58.278 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:16:58.398 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:16:58.422 +03:00 [WRN] Cart item not found for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1, variant: 0
2025-08-05 17:16:58.430 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:16:58.433 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce) in 209.9329ms
2025-08-05 17:16:58.443 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.UpdateCartItem (E-Commerce)'
2025-08-05 17:16:58.444 +03:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5069/api/Cart/items/1/1 - 404 201 application/json; charset=utf-8 246.7668ms
2025-08-05 17:17:20.171 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Cart/items - application/json 63
2025-08-05 17:17:20.182 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:17:20.186 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:17:20.191 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-08-05 17:17:20.197 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:17:20.207 +03:00 [INF] Executing AddItemToCart for product ID: 1
2025-08-05 17:17:20.216 +03:00 [INF] Adding item to cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1
2025-08-05 17:17:20.239 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-08-05 17:17:20.244 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:17:20.264 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-08-05 17:17:20.306 +03:00 [INF] Executing GetByIdAsync for entity ProductVariant with ID: 1
2025-08-05 17:17:20.315 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-08-05 17:17:20.344 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:17:20.398 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:17:20.409 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-08-05 17:17:20.455 +03:00 [INF] CartItem added successfully (pending save)
2025-08-05 17:17:20.457 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:17:20.460 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:17:20.465 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:17:20.540 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `UnitPrice`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:17:20.550 +03:00 [INF] Removing cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:17:20.553 +03:00 [INF] Cache removed successfully for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:17:20.554 +03:00 [INF] Item added to cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1
2025-08-05 17:17:20.556 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:17:20.558 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 357.8076ms
2025-08-05 17:17:20.560 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-08-05 17:17:20.562 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Cart/items - 200 134 application/json; charset=utf-8 391.5774ms
2025-08-05 17:17:24.423 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:17:24.429 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:17:24.439 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:17:24.445 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:17:24.461 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:17:24.468 +03:00 [INF] Executing GetCart
2025-08-05 17:17:24.475 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:17:24.479 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:17:24.485 +03:00 [WRN] Cache miss for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:17:24.492 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-05 17:17:24.496 +03:00 [INF] Execute GetAll for entity Cart
2025-08-05 17:17:24.613 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`ModifiedAt`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-08-05 17:17:24.627 +03:00 [INF] Setting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:17:24.671 +03:00 [INF] Cache set successfully for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32 with tags: [cart]
2025-08-05 17:17:24.676 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:17:24.692 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 227.6803ms
2025-08-05 17:17:24.700 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:17:24.702 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 935 application/json; charset=utf-8 279.278ms
2025-08-05 17:17:47.288 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/deactivate - null 0
2025-08-05 17:17:47.295 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:17:47.304 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:17:47.309 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.DeActiveProduct (E-Commerce)'
2025-08-05 17:17:47.316 +03:00 [INF] Route matched with {action = "DeActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:17:47.330 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:17:47.341 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`, `p`.`SubCategoryId`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:17:47.349 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:17:47.353 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.DeActiveProduct (E-Commerce) in 31.0096ms
2025-08-05 17:17:47.356 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.DeActiveProduct (E-Commerce)'
2025-08-05 17:17:47.359 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/deactivate - 400 291 application/json; charset=utf-8 71.2093ms
2025-08-05 17:18:44.096 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/Variants/1/deactivate - null 0
2025-08-05 17:18:44.104 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:18:44.109 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:18:44.114 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductVariantController.DeactivateVariant (E-Commerce)'
2025-08-05 17:18:44.120 +03:00 [INF] Route matched with {action = "DeactivateVariant", controller = "ProductVariant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeactivateVariant(Int32, Int32) on controller E_Commerce.Controllers.ProductVariantController (E-Commerce).
2025-08-05 17:18:44.131 +03:00 [INF] Deactivating variant: 1
2025-08-05 17:18:44.134 +03:00 [INF] Execute GetAll for entity ProductVariant
2025-08-05 17:18:44.142 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Quantity` > 0 AS `hasquntity`, `p`.`DeletedAt` IS NOT NULL AS `isdeleted`, `p`.`Size` IS NOT NULL AS `hassize`, ((`p`.`Length` <> 0) OR `p`.`Length` IS NULL) AND ((`p`.`Waist` <> 0) OR `p`.`Waist` IS NULL) AS `haslengthandwaist`, `p`.`ProductId` AS `productid`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-08-05 17:18:44.147 +03:00 [INF] Attempting to deactivate variant 1
2025-08-05 17:18:44.153 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-08-05 17:18:44.158 +03:00 [INF] Successfully deactivated variant 1
2025-08-05 17:18:44.173 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:18:44.173 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-08-05 17:18:44.174 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:18:44.180 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:18:44.183 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `ProductVariants` SET `IsActive` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:18:44.213 +03:00 [INF] Execute GetAll for entity ProductVariant
2025-08-05 17:18:44.223 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE (`p`.`ProductId` = @__productId_0) AND `p`.`DeletedAt` IS NULL
2025-08-05 17:18:44.230 +03:00 [INF] Executing GetByIdAsync for entity Product with ID: 1
2025-08-05 17:18:44.240 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-08-05 17:18:44.251 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:18:44.253 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`, `p`.`SubCategoryId`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:18:44.257 +03:00 [INF] Removing cache by tags: [productwithvariantdata, product_search, variantdata]
2025-08-05 17:18:44.262 +03:00 [WRN] No cache entries found for tags: [productwithvariantdata, product_search, variantdata]
2025-08-05 17:18:44.265 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-08-05 17:18:44.270 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:18:44.271 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:18:44.273 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:18:44.276 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Int32), @p3='?' (Size = 255), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = DateTime), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `IsActive` = @p0, `Quantity` = @p1
WHERE `Id` = @p2;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:18:44.325 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'E_Commerce.Context.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`fashion_site`.`adminoperationslogs`, CONSTRAINT `FK_adminOperationsLogs_AspNetUsers_AdminId` FOREIGN KEY (`AdminId`) REFERENCES `aspnetusers` (`Id`))
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.NextResultAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 90
   at MySqlConnector.MySqlDataReader.NextResultAsync(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 49
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`fashion_site`.`adminoperationslogs`, CONSTRAINT `FK_adminOperationsLogs_AspNetUsers_AdminId` FOREIGN KEY (`AdminId`) REFERENCES `aspnetusers` (`Id`))
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.NextResultAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 90
   at MySqlConnector.MySqlDataReader.NextResultAsync(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 49
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-05 17:18:44.339 +03:00 [ERR] Error while deactivating product 1
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> MySqlConnector.MySqlException (0x80004005): Cannot add or update a child row: a foreign key constraint fails (`fashion_site`.`adminoperationslogs`, CONSTRAINT `FK_adminOperationsLogs_AspNetUsers_AdminId` FOREIGN KEY (`AdminId`) REFERENCES `aspnetusers` (`Id`))
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 894
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in /_/src/MySqlConnector/Core/ResultSet.cs:line 37
   at MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 130
   at MySqlConnector.MySqlDataReader.NextResultAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 90
   at MySqlConnector.MySqlDataReader.NextResultAsync(CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlDataReader.cs:line 49
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at UnitOfWork.CommitAsync()
   at E_Commerce.Services.ProductServices.ProductCatalogService.DeactivateProductAsync(Int32 productId, String userId)
2025-08-05 17:18:44.352 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:18:44.354 +03:00 [INF] Executed action E_Commerce.Controllers.ProductVariantController.DeactivateVariant (E-Commerce) in 229.553ms
2025-08-05 17:18:44.356 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductVariantController.DeactivateVariant (E-Commerce)'
2025-08-05 17:18:44.358 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/Variants/1/deactivate - 200 122 application/json; charset=utf-8 262.3819ms
2025-08-05 17:18:51.355 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/deactivate - null 0
2025-08-05 17:18:51.362 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:18:51.369 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:18:51.375 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.DeActiveProduct (E-Commerce)'
2025-08-05 17:18:51.376 +03:00 [INF] Route matched with {action = "DeActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] DeActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:18:51.382 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:18:51.386 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`, `p`.`SubCategoryId`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:18:51.391 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-08-05 17:18:51.395 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:18:51.397 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:18:51.399 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:18:51.409 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `IsActive` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:18:51.502 +03:00 [INF] Product 1 deactivated. Triggered background jobs for collection and subcategory checks.
2025-08-05 17:18:51.504 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:18:51.506 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.DeActiveProduct (E-Commerce) in 125.6918ms
2025-08-05 17:18:51.508 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.DeActiveProduct (E-Commerce)'
2025-08-05 17:18:51.512 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/deactivate - 200 135 application/json; charset=utf-8 156.6753ms
2025-08-05 17:18:54.005 +03:00 [INF] Removing cache by tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:18:54.013 +03:00 [INF] Removing item from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1
2025-08-05 17:18:54.014 +03:00 [INF] Checking if subcategory 1 needs to be deactivated.
2025-08-05 17:18:54.016 +03:00 [INF] Removed 1 cache entries for tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:18:54.021 +03:00 [INF] Execute GetAll for entity SubCategory
2025-08-05 17:18:54.018 +03:00 [INF] Execute GetAll for entity Collection
2025-08-05 17:18:54.018 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:18:54.038 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__subCategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `SubCategories` AS `s`
    WHERE (`s`.`Id` = @__subCategoryId_0) AND EXISTS (
        SELECT 1
        FROM `Products` AS `p`
        WHERE (`s`.`Id` = `p`.`SubCategoryId`) AND (`p`.`IsActive` AND (`p`.`DeletedAt` IS NULL))))
2025-08-05 17:18:54.049 +03:00 [INF] Subcategory 1 still has active products. No action taken.
2025-08-05 17:18:54.086 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`
FROM `Collections` AS `c`
WHERE (`c`.`DeletedAt` IS NULL AND EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p`
    WHERE (`c`.`Id` = `p`.`CollectionId`) AND (`p`.`ProductId` = @__productId_0))) AND NOT EXISTS (
    SELECT 1
    FROM `ProductCollections` AS `p0`
    INNER JOIN `Products` AS `p1` ON `p0`.`ProductId` = `p1`.`Id`
    WHERE (`c`.`Id` = `p0`.`CollectionId`) AND (((`p0`.`ProductId` <> @__productId_0) AND `p1`.`IsActive`) AND `p1`.`DeletedAt` IS NULL))
2025-08-05 17:18:54.091 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:18:54.102 +03:00 [INF] No collections meet deactivation criteria for productId: 1
2025-08-05 17:18:54.111 +03:00 [INF] Removing item from cart: 1, product: 1, variant: 
2025-08-05 17:18:54.121 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__cartId_0='?' (DbType = Int32), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AddedAt`, `c`.`CartId`, `c`.`CreatedAt`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`ProductId`, `c`.`ProductVariantId`, `c`.`Quantity`, `c`.`UnitPrice`
FROM `CartItems` AS `c`
WHERE (`c`.`CartId` = @__cartId_0) AND (`c`.`ProductId` = @__productId_1)
LIMIT 1
2025-08-05 17:18:54.130 +03:00 [INF] Cart item removed successfully
2025-08-05 17:18:54.132 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:18:54.133 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:18:54.135 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:18:54.148 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 255), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM `CartItems`
WHERE `Id` = @p0;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:18:54.164 +03:00 [INF] Removing cache by tag: cart
2025-08-05 17:18:54.167 +03:00 [WRN] No cache entries found for tag: cart
2025-08-05 17:18:54.168 +03:00 [INF] Item removed from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1
2025-08-05 17:19:07.371 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:19:07.378 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:19:07.390 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:19:07.395 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:19:07.397 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:19:07.401 +03:00 [INF] Executing GetCart
2025-08-05 17:19:07.403 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:19:07.405 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:19:07.407 +03:00 [WRN] Cache miss for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:19:07.411 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-05 17:19:07.413 +03:00 [INF] Execute GetAll for entity Cart
2025-08-05 17:19:07.476 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`ModifiedAt`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-08-05 17:19:07.488 +03:00 [INF] Setting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:19:07.491 +03:00 [INF] Cache set successfully for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32 with tags: [cart]
2025-08-05 17:19:07.493 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:19:07.496 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 96.1661ms
2025-08-05 17:19:07.502 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:19:07.504 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 335 application/json; charset=utf-8 133.0034ms
2025-08-05 17:21:03.682 +03:00 [INF] 2 servers were removed due to timeout
2025-08-05 17:27:21.642 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/Variants/1/activate - null 0
2025-08-05 17:27:21.650 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:27:21.663 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:27:21.670 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductVariantController.ActivateVariant (E-Commerce)'
2025-08-05 17:27:21.674 +03:00 [INF] Route matched with {action = "ActivateVariant", controller = "ProductVariant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActivateVariant(Int32, Int32) on controller E_Commerce.Controllers.ProductVariantController (E-Commerce).
2025-08-05 17:27:21.690 +03:00 [INF] Activating variant: 1
2025-08-05 17:27:21.696 +03:00 [INF] Checking if variant 1 exists and is not deleted
2025-08-05 17:27:21.697 +03:00 [INF] Execute GetAll for entity ProductVariant
2025-08-05 17:27:21.702 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Quantity` > 0 AS `hasquntity`, `p`.`DeletedAt` IS NOT NULL AS `isdeleted`, `p`.`Size` IS NOT NULL AS `hassize`, ((`p`.`Length` <> 0) OR `p`.`Length` IS NULL) AND ((`p`.`Waist` <> 0) OR `p`.`Waist` IS NULL) AS `haslengthandwaist`, `p`.`ProductId` AS `productid`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-08-05 17:27:21.715 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p`
    WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL)
2025-08-05 17:27:21.723 +03:00 [INF] Validating variant 1 has required properties for activation
2025-08-05 17:27:21.727 +03:00 [INF] Attempting to activate variant 1
2025-08-05 17:27:21.732 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE (`p`.`Id` = @__id_0) AND `p`.`DeletedAt` IS NULL
LIMIT 1
2025-08-05 17:27:21.738 +03:00 [INF] Successfully activated variant 1
2025-08-05 17:27:21.739 +03:00 [INF] Updating product 1 quantity after activating variant 1
2025-08-05 17:27:21.745 +03:00 [INF] Recording admin operation for activating variant 1 by user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:27:21.747 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:27:21.747 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CreatedAt`, `t`.`DeletedAt`, `t`.`Description`, `t`.`DiscountId`, `t`.`Gender`, `t`.`ImageId`, `t`.`IsActive`, `t`.`ModifiedAt`, `t`.`Name`, `t`.`Price`, `t`.`Quantity`, `t`.`SubCategoryId`, `t`.`fitType`, `p0`.`Id`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`IsActive`, `p0`.`Length`, `p0`.`ModifiedAt`, `p0`.`ProductId`, `p0`.`Quantity`, `p0`.`Size`, `p0`.`Waist`
FROM (
    SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
    FROM `Products` AS `p`
    WHERE (`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN `ProductVariants` AS `p0` ON `t`.`Id` = `p0`.`ProductId`
ORDER BY `t`.`Id`
2025-08-05 17:27:21.749 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:27:21.756 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:27:21.762 +03:00 [INF] Committing unit of work for activating variant 1
2025-08-05 17:27:21.766 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p3='?' (DbType = Int32), @p2='?' (DbType = Int32), @p4='?' (Size = 255), @p5='?' (DbType = DateTime), @p6='?' (DbType = DateTime), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = DateTime), @p10='?' (DbType = Int32), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `ProductVariants` SET `IsActive` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();

UPDATE `Products` SET `Quantity` = @p2
WHERE `Id` = @p3;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:27:21.771 +03:00 [INF] Committing transaction for activating variant 1
2025-08-05 17:27:21.774 +03:00 [INF] Removing product caches after activating variant 1
2025-08-05 17:27:21.792 +03:00 [INF] Successfully completed all operations for activating variant 1
2025-08-05 17:27:21.794 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:27:21.796 +03:00 [INF] Executed action E_Commerce.Controllers.ProductVariantController.ActivateVariant (E-Commerce) in 113.5523ms
2025-08-05 17:27:21.799 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductVariantController.ActivateVariant (E-Commerce)'
2025-08-05 17:27:21.800 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/Variants/1/activate - 200 120 application/json; charset=utf-8 158.8184ms
2025-08-05 17:27:24.737 +03:00 [INF] Removing cache by tags: [productwithvariantdata, product_search, variantdata]
2025-08-05 17:27:24.744 +03:00 [WRN] No cache entries found for tags: [productwithvariantdata, product_search, variantdata]
2025-08-05 17:27:27.055 +03:00 [INF] Request starting HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - null 0
2025-08-05 17:27:27.062 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:27:27.066 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:27:27.071 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:27:27.073 +03:00 [INF] Route matched with {action = "ActiveProduct", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] ActiveProduct(Int32) on controller E_Commerce.Controllers.ProductController (E-Commerce).
2025-08-05 17:27:27.080 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:27:27.093 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`IsActive`, `p`.`DeletedAt` IS NOT NULL AS `isdeleted`, EXISTS (
    SELECT 1
    FROM `Images` AS `i`
    WHERE (`p`.`Id` = `i`.`ProductId`) AND `i`.`DeletedAt` IS NULL) AS `HasImages`, EXISTS (
    SELECT 1
    FROM `ProductVariants` AS `p0`
    WHERE (`p`.`Id` = `p0`.`ProductId`) AND (`p0`.`IsActive` AND (`p0`.`DeletedAt` IS NULL))) AS `HasActiveVariants`
FROM `Products` AS `p`
WHERE `p`.`Id` = @__productId_0
LIMIT 1
2025-08-05 17:27:27.100 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productid_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`
FROM `Products` AS `p`
WHERE ((`p`.`Id` = @__productid_0) AND `p`.`DeletedAt` IS NULL) AND NOT (`p`.`IsActive`)
LIMIT 1
2025-08-05 17:27:27.105 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:27:27.107 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:27:27.108 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:27:27.112 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p2='?' (Size = 255), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE `Products` SET `IsActive` = @p0
WHERE `Id` = @p1;
SELECT ROW_COUNT();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:27:27.139 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:27:27.143 +03:00 [INF] Executed action E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce) in 65.7399ms
2025-08-05 17:27:27.145 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.ProductController.ActiveProduct (E-Commerce)'
2025-08-05 17:27:27.147 +03:00 [INF] Request finished HTTP/1.1 PATCH http://localhost:5069/api/Products/1/activate - 200 133 application/json; charset=utf-8 92.5682ms
2025-08-05 17:27:34.754 +03:00 [INF] Removing cache by tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:27:34.760 +03:00 [INF] Removed 1 cache entries for tags: [product_search, categorywithdata, productwithvariantdata, CollectionWithProduct, cart]
2025-08-05 17:27:38.683 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Cart/items - application/json 63
2025-08-05 17:27:38.689 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:27:38.692 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:27:38.697 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-08-05 17:27:38.699 +03:00 [INF] Route matched with {action = "AddItemToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[System.Boolean]]] AddItemToCart(E_Commerce.DtoModels.CartDtos.CreateCartItemDto) on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:27:38.706 +03:00 [INF] Executing AddItemToCart for product ID: 1
2025-08-05 17:27:38.707 +03:00 [INF] Adding item to cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1
2025-08-05 17:27:38.715 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`Id` = @__p_0)
LIMIT 1
2025-08-05 17:27:38.720 +03:00 [INF] Execute GetAll for entity Product
2025-08-05 17:27:38.731 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__itemDto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`Description`, `p`.`DiscountId`, `p`.`Gender`, `p`.`ImageId`, `p`.`IsActive`, `p`.`ModifiedAt`, `p`.`Name`, `p`.`Price`, `p`.`Quantity`, `p`.`SubCategoryId`, `p`.`fitType`, `d`.`Id`, `d`.`CategoryId`, `d`.`CreatedAt`, `d`.`DeletedAt`, `d`.`Description`, `d`.`DiscountPercent`, `d`.`EndDate`, `d`.`IsActive`, `d`.`ModifiedAt`, `d`.`Name`, `d`.`StartDate`
FROM `Products` AS `p`
LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
WHERE ((`p`.`Id` = @__itemDto_ProductId_0) AND `p`.`DeletedAt` IS NULL) AND `p`.`IsActive`
LIMIT 1
2025-08-05 17:27:38.735 +03:00 [INF] Executing GetByIdAsync for entity ProductVariant with ID: 1
2025-08-05 17:27:38.737 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `p`.`Id`, `p`.`Color`, `p`.`CreatedAt`, `p`.`DeletedAt`, `p`.`IsActive`, `p`.`Length`, `p`.`ModifiedAt`, `p`.`ProductId`, `p`.`Quantity`, `p`.`Size`, `p`.`Waist`
FROM `ProductVariants` AS `p`
WHERE `p`.`Id` = @__id_0
LIMIT 1
2025-08-05 17:27:38.741 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:27:38.776 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:27:38.780 +03:00 [INF] Executing CreateAsync for entity CartItem
2025-08-05 17:27:38.782 +03:00 [INF] CartItem added successfully (pending save)
2025-08-05 17:27:38.784 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:27:38.785 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:27:38.787 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:27:38.793 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (Size = 255), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = DateTime), @p15='?' (DbType = Int32), @p16='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CartItems` (`AddedAt`, `CartId`, `CreatedAt`, `DeletedAt`, `ModifiedAt`, `ProductId`, `ProductVariantId`, `Quantity`, `UnitPrice`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
SELECT `Id`
FROM `CartItems`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:27:38.799 +03:00 [INF] Removing cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:27:38.801 +03:00 [INF] Cache removed successfully for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:27:38.802 +03:00 [INF] Item added to cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32, product: 1
2025-08-05 17:27:38.804 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-05 17:27:38.806 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce) in 102.7344ms
2025-08-05 17:27:38.808 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.AddItemToCart (E-Commerce)'
2025-08-05 17:27:38.810 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Cart/items - 200 134 application/json; charset=utf-8 127.1894ms
2025-08-05 17:28:49.596 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - application/json 337
2025-08-05 17:28:49.604 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:28:49.611 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:28:49.616 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:28:49.631 +03:00 [INF] Route matched with {action = "CreateAddress", controller = "CustomerAddress"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto]]] CreateAddress(E_Commerce.DtoModels.CustomerAddressDtos.CreateCustomerAddressDto) on controller E_Commerce.Controllers.CustomerAddressController (E-Commerce).
2025-08-05 17:28:49.654 +03:00 [INF] Executing CreateAddress
2025-08-05 17:28:49.656 +03:00 [WRN] ModelState errors: Postal Code can only contain letters, numbers, spaces, and hyphens, Invalid phone number format
2025-08-05 17:28:49.658 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:28:49.666 +03:00 [INF] Executed action E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce) in 29.4428ms
2025-08-05 17:28:49.670 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:28:49.672 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - 400 277 application/json; charset=utf-8 75.5784ms
2025-08-05 17:29:08.858 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - application/json 250
2025-08-05 17:29:08.867 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:29:08.993 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:29:08.999 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:29:09.003 +03:00 [INF] Route matched with {action = "CreateAddress", controller = "CustomerAddress"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto]]] CreateAddress(E_Commerce.DtoModels.CustomerAddressDtos.CreateCustomerAddressDto) on controller E_Commerce.Controllers.CustomerAddressController (E-Commerce).
2025-08-05 17:29:09.010 +03:00 [INF] Executing CreateAddress
2025-08-05 17:29:09.012 +03:00 [WRN] ModelState errors: Last Name Required, Last Name must be between 2 and 50 characters, First Name Required, First Name must be between 2 and 50 characters, Invalid phone number format
2025-08-05 17:29:09.014 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:29:09.019 +03:00 [INF] Executed action E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce) in 10.4814ms
2025-08-05 17:29:09.022 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:29:09.025 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - 400 348 application/json; charset=utf-8 166.9647ms
2025-08-05 17:30:21.087 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:30:21.103 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 16.4494ms
2025-08-05 17:30:21.142 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:30:21.144 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:30:21.150 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:30:21.218 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 68.2325ms
2025-08-05 17:30:21.210 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 68.5477ms
2025-08-05 17:30:21.255 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 110.787ms
2025-08-05 17:30:21.365 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:30:21.612 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 246.8664ms
2025-08-05 17:30:34.123 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:30:34.130 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 7.0316ms
2025-08-05 17:30:34.184 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:30:34.187 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:30:34.188 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:30:34.211 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 26.5863ms
2025-08-05 17:30:34.217 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 30.4079ms
2025-08-05 17:30:34.229 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 41.1366ms
2025-08-05 17:30:34.365 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:30:34.513 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 148.0698ms
2025-08-05 17:30:38.511 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - application/json 250
2025-08-05 17:30:38.519 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:30:38.534 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:30:38.538 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:30:38.543 +03:00 [INF] Route matched with {action = "CreateAddress", controller = "CustomerAddress"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto]]] CreateAddress(E_Commerce.DtoModels.CustomerAddressDtos.CreateCustomerAddressDto) on controller E_Commerce.Controllers.CustomerAddressController (E-Commerce).
2025-08-05 17:30:38.560 +03:00 [INF] Executing CreateAddress
2025-08-05 17:30:38.561 +03:00 [WRN] ModelState errors: The addressDto field is required., Error setting value to 'AddressType' on 'E_Commerce.DtoModels.CustomerAddressDtos.CreateCustomerAddressDto'., Error setting value to 'ApartmentSuite' on 'E_Commerce.DtoModels.CustomerAddressDtos.CreateCustomerAddressDto'.
2025-08-05 17:30:38.563 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:30:38.568 +03:00 [INF] Executed action E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce) in 22.076ms
2025-08-05 17:30:38.573 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:30:38.575 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - 400 439 application/json; charset=utf-8 63.893ms
2025-08-05 17:33:36.328 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:33:37.956 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:33:37.976 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:33:38.005 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:33:38.021 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:33:38.055 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:33:38.414 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:33:38.491 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:33:38.530 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:33:39.096 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:33:39.193 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:33:39.288 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:33:39.360 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:33:39.362 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:33:39.363 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:33:39.442 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:33:39.473 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:33:39.496 +03:00 [INF] Server mrrobot:5484:8834e68e successfully announced in 43.6741 ms
2025-08-05 17:33:39.642 +03:00 [INF] Hosting environment: Development
2025-08-05 17:33:39.676 +03:00 [INF] Server mrrobot:5484:8834e68e is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:33:39.676 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:33:39.883 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 410.9366ms
2025-08-05 17:33:39.946 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:33:39.947 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:33:39.971 +03:00 [INF] Server mrrobot:5484:8834e68e all the dispatchers started
2025-08-05 17:33:39.991 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:33:39.995 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 48.5649ms
2025-08-05 17:33:40.013 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 22.3149ms
2025-08-05 17:33:40.062 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 115.0898ms
2025-08-05 17:33:40.128 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:33:40.367 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 239.5118ms
2025-08-05 17:34:02.431 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - application/json 250
2025-08-05 17:34:02.438 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:34:02.579 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:34:02.631 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:34:02.650 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:34:02.679 +03:00 [INF] Route matched with {action = "CreateAddress", controller = "CustomerAddress"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto]]] CreateAddress(E_Commerce.DtoModels.CustomerAddressDtos.CreateCustomerAddressDto) on controller E_Commerce.Controllers.CustomerAddressController (E-Commerce).
2025-08-05 17:34:03.042 +03:00 [INF] Executing CreateAddress
2025-08-05 17:34:03.048 +03:00 [WRN] ModelState errors: Invalid phone number format
2025-08-05 17:34:03.058 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:34:03.087 +03:00 [INF] Executed action E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce) in 395.185ms
2025-08-05 17:34:03.092 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:34:03.097 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - 400 208 application/json; charset=utf-8 665.9054ms
2025-08-05 17:34:13.883 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - application/json 257
2025-08-05 17:34:13.891 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:34:13.899 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:34:13.905 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:34:13.908 +03:00 [INF] Route matched with {action = "CreateAddress", controller = "CustomerAddress"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto]]] CreateAddress(E_Commerce.DtoModels.CustomerAddressDtos.CreateCustomerAddressDto) on controller E_Commerce.Controllers.CustomerAddressController (E-Commerce).
2025-08-05 17:34:13.916 +03:00 [INF] Executing CreateAddress
2025-08-05 17:34:13.928 +03:00 [INF] Creating new address for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:13.951 +03:00 [INF] Getting address count for customer: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:14.007 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__customerId_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM `CustomerAddresses` AS `c`
WHERE (`c`.`CustomerId` = @__customerId_0) AND `c`.`DeletedAt` IS NULL
2025-08-05 17:34:14.022 +03:00 [INF] Executing CreateAsync for entity CustomerAddress
2025-08-05 17:34:14.102 +03:00 [INF] CustomerAddress added successfully (pending save)
2025-08-05 17:34:14.106 +03:00 [INF] Removing default from other addresses for customer: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:14.120 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__customerId_0='?' (Size = 255), @__excludeAddressId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`AdditionalNotes`, `c`.`AddressType`, `c`.`City`, `c`.`Country`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`IsDefault`, `c`.`ModifiedAt`, `c`.`PhoneNumber`, `c`.`PostalCode`, `c`.`State`, `c`.`StreetAddress`
FROM `CustomerAddresses` AS `c`
WHERE (((`c`.`CustomerId` = @__customerId_0) AND (`c`.`Id` <> @__excludeAddressId_1)) AND `c`.`IsDefault`) AND `c`.`DeletedAt` IS NULL
2025-08-05 17:34:14.127 +03:00 [INF] Execute AddAdminOpreationAsync
2025-08-05 17:34:14.130 +03:00 [INF] Executing CreateAsync for entity AdminOperationsLog
2025-08-05 17:34:14.161 +03:00 [INF] AdminOperationsLog added successfully (pending save)
2025-08-05 17:34:14.309 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (Size = 20), @p2='?' (Size = 50), @p3='?' (Size = 50), @p4='?' (DbType = DateTime), @p5='?' (Size = 255), @p6='?' (DbType = DateTime), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime), @p9='?' (Size = 20), @p10='?' (Size = 20), @p11='?' (Size = 50), @p12='?' (Size = 200), @p13='?' (Size = 255), @p14='?' (DbType = DateTime), @p15='?' (DbType = DateTime), @p16='?' (Size = 4000), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime), @p19='?' (DbType = Int32), @p20='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `CustomerAddresses` (`AdditionalNotes`, `AddressType`, `City`, `Country`, `CreatedAt`, `CustomerId`, `DeletedAt`, `IsDefault`, `ModifiedAt`, `PhoneNumber`, `PostalCode`, `State`, `StreetAddress`)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
SELECT `Id`
FROM `CustomerAddresses`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();

INSERT INTO `adminOperationsLogs` (`AdminId`, `CreatedAt`, `DeletedAt`, `Description`, `ItemId`, `ModifiedAt`, `OperationType`, `Timestamp`)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT `Id`
FROM `adminOperationsLogs`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
2025-08-05 17:34:14.369 +03:00 [INF] Removing cache by tag: customer_address
2025-08-05 17:34:14.377 +03:00 [WRN] No cache entries found for tag: customer_address
2025-08-05 17:34:14.390 +03:00 [INF] Executing ObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CustomerAddressDtos.CustomerAddressDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:34:14.399 +03:00 [INF] Executed action E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce) in 487.6994ms
2025-08-05 17:34:14.403 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CustomerAddressController.CreateAddress (E-Commerce)'
2025-08-05 17:34:14.406 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/CustomerAddress - 201 572 application/json; charset=utf-8 523.6147ms
2025-08-05 17:34:36.182 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json 41
2025-08-05 17:34:36.191 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:34:36.196 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:34:36.207 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:34:36.215 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-05 17:34:36.234 +03:00 [INF] Executing CreateOrderFromCart
2025-08-05 17:34:36.242 +03:00 [INF] Creating order from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:36.256 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:36.390 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:34:36.442 +03:00 [WRN] Cart is empty for user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:36.451 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:34:36.463 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 243.7092ms
2025-08-05 17:34:36.466 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:34:36.469 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 188 application/json; charset=utf-8 286.4813ms
2025-08-05 17:34:53.879 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:34:53.885 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:34:53.889 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:34:53.896 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:34:53.901 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:34:53.918 +03:00 [INF] Executing GetCart
2025-08-05 17:34:53.926 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:53.932 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:53.939 +03:00 [WRN] Cache miss for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:53.949 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userid_0) AND `c`.`DeletedAt` IS NULL)
2025-08-05 17:34:53.956 +03:00 [INF] Execute GetAll for entity Cart
2025-08-05 17:34:54.085 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`UserId`, `t`.`c`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t0`.`Id`, `t0`.`ProductId`, `t0`.`Quantity`, `t0`.`AddedAt`, `t0`.`Id0`, `t0`.`Name`, `t0`.`Price`, `t0`.`FinalPrice`, `t0`.`DiscountName`, `t0`.`DiscountPrecentage`, `t0`.`MainImageUrl`, `t0`.`IsActive`, `t0`.`Color`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`Size`, `t0`.`Waist`, `t0`.`Length`, `t0`.`Quantity0`, `t0`.`UnitPrice`, `t0`.`Id1`, `t0`.`Id2`
FROM (
    SELECT `c`.`Id`, `c`.`UserId`, (
        SELECT COUNT(*)
        FROM `CartItems` AS `c0`
        WHERE `c`.`Id` = `c0`.`CartId`) AS `c`, `c`.`CheckoutDate`, `c`.`CreatedAt`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c1`.`Id`, `c1`.`ProductId`, `c1`.`Quantity`, `c1`.`AddedAt`, `p`.`Id` AS `Id0`, `p`.`Name`, `p`.`Price`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `p`.`Price` - ((`d`.`DiscountPercent` / 100.0) * `p`.`Price`)
        ELSE `p`.`Price`
    END AS `FinalPrice`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`Name`
        ELSE NULL
    END AS `DiscountName`, CASE
        WHEN ((`d`.`Id` IS NOT NULL AND `d`.`IsActive`) AND `d`.`DeletedAt` IS NULL) AND (`d`.`EndDate` > UTC_TIMESTAMP()) THEN `d`.`DiscountPercent`
        ELSE 0.0
    END AS `DiscountPrecentage`, (
        SELECT `i`.`Url`
        FROM `Images` AS `i`
        WHERE (`p`.`Id` = `i`.`ProductId`) AND (`i`.`IsMain` AND (`i`.`DeletedAt` IS NULL))
        LIMIT 1) AS `MainImageUrl`, `p`.`IsActive`, `p0`.`Color`, `p0`.`CreatedAt`, `p0`.`DeletedAt`, `p0`.`ModifiedAt`, `p0`.`Size`, `p0`.`Waist`, `p0`.`Length`, `p0`.`Quantity` AS `Quantity0`, `c1`.`UnitPrice`, `d`.`Id` AS `Id1`, `p0`.`Id` AS `Id2`, `c1`.`CartId`
    FROM `CartItems` AS `c1`
    INNER JOIN `Products` AS `p` ON `c1`.`ProductId` = `p`.`Id`
    LEFT JOIN `Discount` AS `d` ON `p`.`DiscountId` = `d`.`Id`
    LEFT JOIN `ProductVariants` AS `p0` ON `c1`.`ProductVariantId` = `p0`.`Id`
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`, `t0`.`Id`, `t0`.`Id0`, `t0`.`Id1`
2025-08-05 17:34:54.101 +03:00 [INF] Setting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:34:54.150 +03:00 [INF] Cache set successfully for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32 with tags: [cart]
2025-08-05 17:34:54.157 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:34:54.173 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 265.0246ms
2025-08-05 17:34:54.210 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:34:54.215 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 936 application/json; charset=utf-8 336.0379ms
2025-08-05 17:36:42.956 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:36:42.978 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 21.8103ms
2025-08-05 17:36:43.045 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:36:43.047 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:36:43.047 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:36:43.051 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.3336ms
2025-08-05 17:36:43.066 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 19.2859ms
2025-08-05 17:36:43.085 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.1059ms
2025-08-05 17:36:43.151 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:36:43.323 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 173.2482ms
2025-08-05 17:38:00.944 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:38:03.282 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:38:03.297 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:38:03.321 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:38:03.339 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:38:03.375 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:38:03.807 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:38:03.896 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:38:03.923 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:38:04.942 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:38:05.229 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:38:05.790 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:38:05.803 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:38:05.807 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:38:05.809 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:38:05.813 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:38:05.880 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:38:05.883 +03:00 [INF] Hosting environment: Development
2025-08-05 17:38:05.884 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:38:05.906 +03:00 [INF] Server mrrobot:24064:5207c4d7 successfully announced in 22.6149 ms
2025-08-05 17:38:05.968 +03:00 [INF] Server mrrobot:24064:5207c4d7 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:38:05.992 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 17:38:07.022 +03:00 [INF] Server mrrobot:24064:5207c4d7 all the dispatchers started
2025-08-05 17:38:07.301 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:38:07.319 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:38:07.340 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 1631.469ms
2025-08-05 17:38:07.434 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 137.0717ms
2025-08-05 17:38:07.441 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 122.5183ms
2025-08-05 17:38:07.448 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:38:07.799 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 351.1289ms
2025-08-05 17:38:07.951 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:38:08.309 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 357.6688ms
2025-08-05 17:38:10.798 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:38:10.809 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:38:11.142 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:38:11.237 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:38:11.278 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:38:11.311 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:38:11.769 +03:00 [INF] Executing GetCart
2025-08-05 17:38:11.775 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:38:11.779 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:38:11.788 +03:00 [INF] Cache hit for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:38:11.852 +03:00 [INF] Cache hit for cart user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:38:11.869 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:38:11.940 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 604.2074ms
2025-08-05 17:38:11.957 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:38:11.968 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 934 application/json; charset=utf-8 1169.8554ms
2025-08-05 17:38:18.802 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json 41
2025-08-05 17:38:18.817 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:38:18.836 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:38:18.847 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:38:18.875 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-05 17:38:18.991 +03:00 [INF] Executing CreateOrderFromCart
2025-08-05 17:38:18.999 +03:00 [INF] Creating order from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:38:28.405 +03:00 [INF] Retrieving cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:38:29.652 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`Id`, `t`.`CheckoutDate`, `t`.`CreatedAt`, `t`.`CustomerId`, `t`.`DeletedAt`, `t`.`ModifiedAt`, `t`.`UserId`, `t0`.`Id`, `t0`.`AddedAt`, `t0`.`CartId`, `t0`.`CreatedAt`, `t0`.`DeletedAt`, `t0`.`ModifiedAt`, `t0`.`ProductId`, `t0`.`ProductVariantId`, `t0`.`Quantity`, `t0`.`UnitPrice`
FROM (
    SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
    FROM `Cart` AS `c`
    WHERE (`c`.`UserId` = @__userId_0) AND `c`.`DeletedAt` IS NULL
    LIMIT 1
) AS `t`
LEFT JOIN (
    SELECT `c0`.`Id`, `c0`.`AddedAt`, `c0`.`CartId`, `c0`.`CreatedAt`, `c0`.`DeletedAt`, `c0`.`ModifiedAt`, `c0`.`ProductId`, `c0`.`ProductVariantId`, `c0`.`Quantity`, `c0`.`UnitPrice`
    FROM `CartItems` AS `c0`
    WHERE `c0`.`DeletedAt` IS NULL
) AS `t0` ON `t`.`Id` = `t0`.`CartId`
ORDER BY `t`.`Id`
2025-08-05 17:39:33.971 +03:00 [WRN] Cart is empty for user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:39:50.159 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:39:50.174 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 91286.5446ms
2025-08-05 17:39:50.179 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:39:50.185 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 188 application/json; charset=utf-8 91382.7499ms
2025-08-05 17:39:50.955 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:39:51.058 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 102.9836ms
2025-08-05 17:39:51.165 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:39:51.170 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:39:51.453 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:39:51.468 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 302.7494ms
2025-08-05 17:39:51.489 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 35.9955ms
2025-08-05 17:39:51.504 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 334.157ms
2025-08-05 17:39:51.567 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:39:52.156 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 589.0073ms
2025-08-05 17:42:44.118 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:42:44.131 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 12.841ms
2025-08-05 17:42:44.172 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:42:44.173 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:42:44.189 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:42:44.201 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 28.519ms
2025-08-05 17:42:44.216 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.8341ms
2025-08-05 17:42:44.220 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 31.3899ms
2025-08-05 17:42:44.261 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:42:44.671 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 409.8474ms
2025-08-05 17:43:06.705 +03:00 [INF] 1 servers were removed due to timeout
2025-08-05 17:44:35.420 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:44:37.071 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:44:37.084 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:44:37.110 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:44:37.131 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:44:37.165 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:44:37.534 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:44:37.600 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:44:37.642 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:44:38.173 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:44:38.258 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:44:38.282 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:44:38.284 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:44:38.287 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:44:38.288 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:44:38.376 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:44:38.935 +03:00 [INF] Server mrrobot:10096:03c3f666 successfully announced in 350.7827 ms
2025-08-05 17:44:38.875 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:44:39.280 +03:00 [INF] Hosting environment: Development
2025-08-05 17:44:39.283 +03:00 [INF] Server mrrobot:10096:03c3f666 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:44:39.286 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:44:39.511 +03:00 [INF] Server mrrobot:10096:03c3f666 all the dispatchers started
2025-08-05 17:44:39.530 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 659.6109ms
2025-08-05 17:44:39.566 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:44:39.594 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:44:39.613 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:44:39.619 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 52.0705ms
2025-08-05 17:44:39.733 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 139.2021ms
2025-08-05 17:44:39.780 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 166.5938ms
2025-08-05 17:44:39.847 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:44:40.142 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 294.6234ms
2025-08-05 17:46:05.855 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json 41
2025-08-05 17:46:05.864 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:46:06.032 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:46:06.227 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:46:06.935 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:46:06.964 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-05 17:46:07.387 +03:00 [INF] Executing CreateOrderFromCart
2025-08-05 17:46:07.396 +03:00 [INF] Creating order from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:46:07.431 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-08-05 17:46:07.445 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`, `c`.`UserId` = @__userid_0
FROM `Cart` AS `c`
LIMIT 1
2025-08-05 17:46:07.477 +03:00 [WRN] Cart is empty for user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:46:07.497 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:46:07.522 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 551.5717ms
2025-08-05 17:46:07.527 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:46:07.532 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 188 application/json; charset=utf-8 1677.1935ms
2025-08-05 17:46:44.064 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:46:46.160 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:46:46.176 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:46:46.219 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:46:46.241 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:46:46.276 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:46:46.796 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:46:46.875 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:46:46.901 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:46:47.776 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:46:47.888 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:46:48.008 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:46:48.009 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:46:48.011 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:46:48.012 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:46:48.052 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:46:48.072 +03:00 [INF] Hosting environment: Development
2025-08-05 17:46:48.073 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:46:48.087 +03:00 [INF] Server mrrobot:23716:43953db4 successfully announced in 14.2013 ms
2025-08-05 17:46:48.129 +03:00 [INF] Server mrrobot:23716:43953db4 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:46:49.159 +03:00 [INF] Server mrrobot:23716:43953db4 all the dispatchers started
2025-08-05 17:46:49.195 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:46:50.100 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:46:50.120 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:46:50.122 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 958.108ms
2025-08-05 17:46:50.144 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:46:50.315 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 214.3679ms
2025-08-05 17:46:50.317 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 197.4244ms
2025-08-05 17:46:50.423 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 278.5435ms
2025-08-05 17:46:50.496 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:46:50.781 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 284.2667ms
2025-08-05 17:46:56.646 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json 41
2025-08-05 17:46:56.658 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:46:56.944 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:46:57.000 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:46:57.048 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:46:57.096 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-05 17:46:57.642 +03:00 [INF] Executing CreateOrderFromCart
2025-08-05 17:46:57.648 +03:00 [INF] Creating order from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:47:02.124 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-08-05 17:47:02.136 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userid_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`, `c`.`UserId` = @__userid_0
FROM `Cart` AS `c`
LIMIT 1
2025-08-05 17:47:09.120 +03:00 [WRN] Cart is empty for user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:47:09.277 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:47:09.385 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 12270.1789ms
2025-08-05 17:47:09.518 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:47:09.533 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 188 application/json; charset=utf-8 12886.7962ms
2025-08-05 17:47:22.927 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:47:22.939 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:47:22.952 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:47:22.958 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:47:22.969 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:47:22.980 +03:00 [INF] Executing GetCart
2025-08-05 17:47:22.986 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:47:22.990 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:47:23.003 +03:00 [INF] Cache hit for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:47:23.057 +03:00 [INF] Cache hit for cart user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:47:23.061 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:47:23.084 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 111.5423ms
2025-08-05 17:47:23.087 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:47:23.090 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 934 application/json; charset=utf-8 162.4541ms
2025-08-05 17:49:47.215 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:49:47.250 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 35.6851ms
2025-08-05 17:49:47.313 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:49:47.315 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:49:47.326 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:49:47.337 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 21.9906ms
2025-08-05 17:49:47.343 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 17.6114ms
2025-08-05 17:49:47.370 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 57.56ms
2025-08-05 17:49:47.418 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:49:47.701 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 282.8072ms
2025-08-05 17:50:29.750 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:50:29.760 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 10.081ms
2025-08-05 17:50:29.817 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:50:29.818 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:50:29.822 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:50:29.823 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 6.0273ms
2025-08-05 17:50:29.833 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 11.3892ms
2025-08-05 17:50:29.846 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.4155ms
2025-08-05 17:50:30.633 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:50:30.833 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 199.9316ms
2025-08-05 17:50:45.725 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/api/Cart - null null
2025-08-05 17:50:45.735 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:50:45.742 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:50:45.749 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:50:45.756 +03:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.CartDtos.CartDto]]] GetCart() on controller E_Commerce.Controllers.CartController (E-Commerce).
2025-08-05 17:50:45.760 +03:00 [INF] Executing GetCart
2025-08-05 17:50:45.762 +03:00 [INF] Getting cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:50:45.763 +03:00 [INF] Getting cache for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:50:45.774 +03:00 [INF] Cache hit for key: cart_user_5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:50:45.793 +03:00 [INF] Cache hit for cart user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:50:45.795 +03:00 [INF] Executing OkObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.CartDtos.CartDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:50:45.800 +03:00 [INF] Executed action E_Commerce.Controllers.CartController.GetCart (E-Commerce) in 40.7834ms
2025-08-05 17:50:45.807 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.CartController.GetCart (E-Commerce)'
2025-08-05 17:50:45.809 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/api/Cart - 200 934 application/json; charset=utf-8 83.6812ms
2025-08-05 17:50:57.310 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json 41
2025-08-05 17:50:57.318 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:50:57.324 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:50:57.328 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:50:57.336 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-05 17:50:57.347 +03:00 [INF] Executing CreateOrderFromCart
2025-08-05 17:50:57.350 +03:00 [INF] Creating order from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:50:59.466 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`UserId` = @__userId_0
LIMIT 1
2025-08-05 17:50:59.474 +03:00 [WRN] Cart is empty for user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:50:59.480 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:50:59.485 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 2141.5941ms
2025-08-05 17:50:59.495 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:50:59.514 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 188 application/json; charset=utf-8 2203.897ms
2025-08-05 17:51:15.960 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:51:17.531 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:51:17.545 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:51:17.572 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:51:17.589 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:51:17.622 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:51:17.984 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:51:18.051 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:51:18.078 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:51:18.596 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:51:18.684 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:51:18.863 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:51:18.981 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:51:19.029 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:51:19.030 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:51:19.031 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:51:19.058 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:51:19.063 +03:00 [INF] Hosting environment: Development
2025-08-05 17:51:19.064 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:51:19.084 +03:00 [INF] Server mrrobot:4388:49cf1dea successfully announced in 21.8257 ms
2025-08-05 17:51:19.096 +03:00 [INF] Server mrrobot:4388:49cf1dea is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:51:19.115 +03:00 [INF] 2 servers were removed due to timeout
2025-08-05 17:51:19.276 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 413.7646ms
2025-08-05 17:51:19.305 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:51:19.370 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:51:19.498 +03:00 [INF] Server mrrobot:4388:49cf1dea all the dispatchers started
2025-08-05 17:51:19.527 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:51:19.533 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 227.7481ms
2025-08-05 17:51:19.557 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 30.3401ms
2025-08-05 17:51:19.638 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 268.1798ms
2025-08-05 17:51:19.715 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:51:20.037 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 322.3685ms
2025-08-05 17:51:27.475 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json 41
2025-08-05 17:51:27.481 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:51:27.631 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:51:27.695 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:51:27.713 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:51:27.741 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-05 17:51:28.154 +03:00 [INF] Executing CreateOrderFromCart
2025-08-05 17:51:28.161 +03:00 [INF] Creating order from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:51:28.213 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`UserId` = @__userId_0
LIMIT 1
2025-08-05 17:51:28.248 +03:00 [WRN] Cart is empty for user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:51:28.276 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:51:28.312 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 561.4552ms
2025-08-05 17:51:28.316 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:51:28.322 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 188 application/json; charset=utf-8 846.847ms
2025-08-05 17:51:46.766 +03:00 [INF] DB tables already exist. Exit install
2025-08-05 17:51:48.757 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:51:48.797 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='Fashion_Site' AND TABLE_NAME='__EFMigrationsHistory';
2025-08-05 17:51:48.836 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `MigrationId`, `ProductVersion`
FROM `__EFMigrationsHistory`
ORDER BY `MigrationId`;
2025-08-05 17:51:48.860 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-05 17:51:48.910 +03:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-05 17:51:49.349 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:51:49.437 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`ConcurrencyStamp`, `a`.`Name`, `a`.`NormalizedName`
FROM `AspNetRoles` AS `a`
WHERE `a`.`NormalizedName` = @__normalizedName_0
LIMIT 1
2025-08-05 17:51:49.459 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT `a`.`Id`, `a`.`AccessFailedCount`, `a`.`ConcurrencyStamp`, `a`.`Discriminator`, `a`.`Email`, `a`.`EmailConfirmed`, `a`.`LockoutEnabled`, `a`.`LockoutEnd`, `a`.`NormalizedEmail`, `a`.`NormalizedUserName`, `a`.`PasswordHash`, `a`.`PhoneNumber`, `a`.`PhoneNumberConfirmed`, `a`.`SecurityStamp`, `a`.`TwoFactorEnabled`, `a`.`UserName`, `a`.`Age`, `a`.`CreateAt`, `a`.`DeletedAt`, `a`.`ImageId`, `a`.`LastVisit`, `a`.`Name`, `a`.`ProfilePicture`
FROM `AspNetUsers` AS `a`
WHERE (`a`.`Discriminator` = 'Customer') AND (`a`.`NormalizedEmail` = @__normalizedEmail_0)
LIMIT 2
2025-08-05 17:51:50.324 +03:00 [INF] Now listening on: http://localhost:5069
2025-08-05 17:51:50.464 +03:00 [ERR] Index was outside the bounds of the array.
System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at Hangfire.MySql.MySqlStorage.<>c.<ToString>b__14_1(String[] x)
   at System.Linq.Enumerable.ArraySelectIterator`2.MoveNext()
   at System.Linq.Enumerable.ToDictionary[TSource,TKey,TElement](IEnumerable`1 source, Func`2 keySelector, Func`2 elementSelector, IEqualityComparer`1 comparer)
   at Hangfire.MySql.MySqlStorage.ToString()
2025-08-05 17:51:51.180 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:51:51.304 +03:00 [INF] Starting Hangfire Server using job storage: '<Connection string can not be parsed>'
2025-08-05 17:51:51.323 +03:00 [INF] Using the following options for SQL Server job storage:
2025-08-05 17:51:51.325 +03:00 [INF]     Queue poll interval: 00:00:10.
2025-08-05 17:51:51.351 +03:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-08-05 17:51:51.529 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-05 17:51:51.549 +03:00 [INF] Hosting environment: Development
2025-08-05 17:51:51.560 +03:00 [INF] Server mrrobot:20260:4e579847 successfully announced in 27.6295 ms
2025-08-05 17:51:51.560 +03:00 [INF] Content root path: D:\project_fashion\E-Commerce-API-main
2025-08-05 17:51:51.575 +03:00 [INF] Server mrrobot:20260:4e579847 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-08-05 17:51:52.662 +03:00 [INF] Server mrrobot:20260:4e579847 all the dispatchers started
2025-08-05 17:51:52.808 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:51:52.814 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:51:52.838 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 1714.2559ms
2025-08-05 17:51:52.895 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:51:52.886 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 72.0067ms
2025-08-05 17:51:52.910 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 14.5707ms
2025-08-05 17:51:52.988 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 180.8407ms
2025-08-05 17:51:53.057 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:51:53.647 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 590.2661ms
2025-08-05 17:52:40.704 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - application/json 41
2025-08-05 17:52:40.715 +03:00 [WRN] Failed to determine the https port for redirect.
2025-08-05 17:52:41.024 +03:00 [INF] Executing UserAuthenticationMiddleware
2025-08-05 17:52:41.094 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 255), @__tokenSecurityStamp_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM `AspNetUsers` AS `a`
    WHERE (`a`.`Discriminator` = 'Customer') AND ((`a`.`Id` = @__userId_0) AND (`a`.`SecurityStamp` = @__tokenSecurityStamp_1)))
2025-08-05 17:52:41.134 +03:00 [INF] Executing endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:52:41.173 +03:00 [INF] Route matched with {action = "CreateOrderFromCart", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[E_Commerce.DtoModels.Responses.ApiResponse`1[E_Commerce.DtoModels.OrderDtos.OrderDto]]] CreateOrderFromCart(E_Commerce.DtoModels.OrderDtos.CreateOrderDto) on controller E_Commerce.Controllers.OrderController (E-Commerce).
2025-08-05 17:52:41.697 +03:00 [INF] Executing CreateOrderFromCart
2025-08-05 17:52:41.702 +03:00 [INF] Creating order from cart for user: 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:52:44.506 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`Id`, `c`.`CheckoutDate`, `c`.`CreatedAt`, `c`.`CustomerId`, `c`.`DeletedAt`, `c`.`ModifiedAt`, `c`.`UserId`
FROM `Cart` AS `c`
WHERE `c`.`UserId` = @__userId_0
LIMIT 1
2025-08-05 17:53:01.199 +03:00 [WRN] Cart is empty for user 5159b4b3-dbf3-4369-b2c5-e2cff9cf0f32
2025-08-05 17:53:01.272 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'E_Commerce.DtoModels.Responses.ApiResponse`1[[E_Commerce.DtoModels.OrderDtos.OrderDto, E-Commerce, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-05 17:53:01.329 +03:00 [INF] Executed action E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce) in 20148.3799ms
2025-08-05 17:53:01.332 +03:00 [INF] Executed endpoint 'E_Commerce.Controllers.OrderController.CreateOrderFromCart (E-Commerce)'
2025-08-05 17:53:01.344 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5069/api/Order/create-from-cart - 400 188 application/json; charset=utf-8 20639.883ms
2025-08-05 17:54:04.895 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.html - null null
2025-08-05 17:54:04.932 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.html - 200 null text/html;charset=utf-8 36.6669ms
2025-08-05 17:54:05.000 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - null null
2025-08-05 17:54:05.028 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/index.js - null null
2025-08-05 17:54:05.040 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/_vs/browserLink - null null
2025-08-05 17:54:05.056 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 55.3543ms
2025-08-05 17:54:05.062 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/index.js - 200 null application/javascript;charset=utf-8 33.7281ms
2025-08-05 17:54:05.143 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/_vs/browserLink - 200 null text/javascript; charset=UTF-8 103.2556ms
2025-08-05 17:54:05.250 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - null null
2025-08-05 17:54:05.563 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5069/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 312.8103ms
